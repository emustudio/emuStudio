dist: xenial
language: java

jdk:
  - oraclejdk11
os:
  - linux
services:
  - xvfb

branches:
  only:
    - develop
env:
  global:
    - secure: CBze4MoSq9LKgG0ObeoFL94UICe/lAwBKQZdvUP6fIZLcihSzcsIO6n9+MAc6KesyMJQhUmKh8sIYID2bNyOX5L39KCch+SZ70yHuQN6UGxEER6eAdiTcXCb4K7Cxwq8j/QSPVGwA7I/TqIaUJw/IwhNnFYBRBAi7jEdCpXxekA=
    - secure: kSgfF/XsqM9mfAoi5dS9ANs73mgiCWcChJ5xpF9Mtjp/WGwUVn52l1nQhzNYAYfa0BZp6UGNTvVHfqLB0awv/BIiFc+jf7Cz8N7NfAK0ealzKN+0yg8N88urzwX9efd6S/xit1Gvp/IM2UqqJWEqVIWlvPTZcAJPreP3QBpxDLc=
    - secure: oLauAjLvkgKhboQMN6evL6qtCCZ9/5w/g0u+N0C/1O1g/+vTxlpFtMkawv5T2qOaqRe1aD2P5CkNaHudKgN6AsI5as9t3n33gYOOShZcGC0hXn8gXePIP2UJIUcfSga3UZkBDfxVKL+BvSUSRxVHKQrqbpCYnszDGyQer9DH3Pc=

install: true

script:
  - mvn -B -U clean test

after_success:
  - python add_server.py
  - if [ "$TRAVIS_BRANCH" == "develop" ]; then mvn deploy -Dmaven.test.skip=True; fi

after_script:
  - python restore_backups.py

notifications:
  email:
    on_success: change
    on_failure: always

cache:
  directories:
    - '$HOME/.m2/repository'
