






<!DOCTYPE html>
<html lang="en">
<head>

    <!-- Meta -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <title>Emulator of MITS Altair8800 &diams; emuStudio</title>
    <meta name="keywords" content="emulator,emulation,emustudio,programming emulator,debugging in emulator,computer emulation,altair emulation">

    <!-- RSS -->
    <link rel="alternate" type="application/rss+xml" title="emuStudio &diams; Computer emulation platform/framework" href="../../../feed.xml">
    <link rel="alternate" type="application/atom+xml" title="emuStudio &diams; Computer emulation platform/framework" href="../../../atom.xml">

    <!-- Favicons -->
    <link rel="shortcut icon" type="image/x-icon" href="../../../favicon.ico?">
    <meta name="application-name" content="emuStudio &diams; Computer emulation platform/framework">
    <meta name="msapplication-TileColor" content="#ffffff">

    <!-- Fonts -->
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto+Condensed:300,300italic,400,400italic,700,700italic|Oswald:300,400,700">

    <!-- Styles -->
    <link rel="stylesheet" href="../../../css/style.css">

    <link rel="stylesheet" href="../../../css/bootstrap-toc.min.css">
    <link rel="stylesheet" href="../../../fonts/font-awesome.min.css">


    <!-- Scripts -->

    <!--[if lt IE 9]>
        <script src="../../../js/html5shiv.min.js"></script>
        <script src="../../../js/respond.min.js"></script>
    [endif]-->

    <script src="../../../js/jquery-3.1.1.min.js"></script>
    <script src="../../../js/bootstrap.min.js"
            integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
            crossorigin="anonymous">
    </script>

    <script src="../../../js/bootstrap-toc.min.js"></script>


    <script async defer id="github-bjs" src="https://buttons.github.io/buttons.js"></script>
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-3492956-5', 'auto');
        ga('send', 'pageview');

    </script>
</head>


<body data-spy="scroll" data-target="#toc">


<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/emuStudio/"><i><img alt="&diams;" style="margin: -5px;margin-right:2px;" src="../../../img/logo-2.svg" width="30px" /></i>emuStudio</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
            <!--<form class="navbar-form navbar-left" role="search">-->
                <!--<div class="form-group">-->
                    <!--<input type="text" class="form-control" placeholder="Search website">-->
                <!--</div>-->
                <!--<button type="submit" class="btn btn-default">Submit</button>-->
            <!--</form>-->
            <ul class="nav navbar-nav navbar-right">
                
                <li>
                    <a href="/emuStudio/">Home</a>
                </li>
                
                <li>
                    <a href="/emuStudio/download">Download</a>
                </li>
                
                <li>
                    <a href="/emuStudio/docs">Docs</a>
                </li>
                
                <li>
                    <a href="/emuStudio/devel">Developer</a>
                </li>
                
                <li>
                    <a href="/emuStudio/roadmap">Roadmap</a>
                </li>
                
                <li>
                    <a href="/emuStudio/about">About</a>
                </li>
                
            </ul>
        </div>
    </div>
</nav>





<div class="title-group">
    <h1 class="special" data-toc-skip>
      <span>
          
            User documentation
          
      </span>
    </h1>
    
      Version 0.39
    
    
    <aside>
        
        
        <span>
            
            
                <a href="/emuStudio/docuser/brainduck/index/" role="button" class="btn btn-default">
                    brainduck
                </a>
            
        </span>
        
        
        
        <span>
            
            
                <a href="/emuStudio/docuser/main_module/index/" role="button" class="btn btn-default">
                    main module
                </a>
            
        </span>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <span>
            
            
                
                <a href="/emuStudio/docuser/mits_altair_8800/index/" role="button" class="btn btn-default active">
                    mits altair 8800
                </a>
            
        </span>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <span>
            
            
                <a href="/emuStudio/docuser/ram/index/" role="button" class="btn btn-default">
                    ram
                </a>
            
        </span>
        
        
        
        
        
        
        
        
        
        
        
        <span>
            
            
                <a href="/emuStudio/docuser/rasp/index/" role="button" class="btn btn-default">
                    rasp
                </a>
            
        </span>
        
        
        
        
        
        
        
        
        
        
        
        <span>
            
            
                <a href="/emuStudio/docuser/ssem/index/" role="button" class="btn btn-default">
                    ssem
                </a>
            
        </span>
        
        
    </aside>

    <script>
        $('#toc').on('affixed.bs.affix', function(){
            $(this).removeAttr('style');
        });
    </script>
    
</div>


<div class="container">
    <div class="row">
        <div id="sidebar" class="col-md-3 col-sm-3 col-lg-3">
            <nav id="toc" class="navbar" data-spy="affix" data-offset-top="230" data-toggle="toc"></nav>
        </div>
        <div class="col-md-9 col-sm-9 col-lg-9">
            
                <div class="sect1">
<h2 id="MITS_8800_INTRODUCTION">1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Computer MITS Altair 8800 was named after a planet in one of the first episodes of Star Trek series. Having Intel 8080
CPU inside, with 256 bytes of memory, no display and keyboard is this computer, when comparing to the present era,
absolutely ridiculous. His author, Ed Roberts, called the invention "personal computer", which is now very common term.
As Wikipedia states:</p>
</div>
<div class="quoteblock">
<blockquote>
The Altair is widely recognized as the spark that ignited the microcomputer revolution.
</blockquote>
<div class="attribution">
&#8212; Wikipedia<br>
<cite>Altair 8800</cite>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="https://vbmacher.github.io/emuStudio/docuser/mits_altair_8800/images//altair8800.png" alt="MITS Altair8800 with LSI ADM-3A terminal and floppy drive" width="100%">
</div>
</div>
<div class="paragraph">
<p>Altair 8800 is one of the oldest commercially available computers overall. Ed Roberts (founder and CEO of MITS
corporation) was selling these machines by mail directly from the factory.</p>
</div>
<div class="paragraph">
<p>Various enthusiasts understood the power of Altair and started to develop software and hardware for the computer. Those
people saw a freedom in Altair - some kind of a release from batch tasks ran on mainframe systems, maintained by elite.
The phenomenon of a computer which could be put on the kitchen table allowed to make enormous money by two smart
university students. In 1975, Paul Allen and Bill Gates wrote a trimmed version of BASIC programming language, called
Altair BASIC, which pushed them directly to foundation of Microsoft corporation.</p>
</div>
<div class="paragraph">
<p>Basic configuration of MITS Altair 8800 was:</p>
</div>
<table class="tableblock frame-all grid-all spread table table-striped table-condensed">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Processor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Intel 8080 or 8080a</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Speed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2 MHz</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RAM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">from 256 bytes to 64 kB</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ROM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional; usually EPROM Intel 1702 with 256 bytes. <sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnote_1" title="View footnote.">1</a>]</sup></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Storage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional; paper tapes, cassette tapes or 5.25" or 8" floppy disks (MITS 88-DISK)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extensions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">at first 16 slots, later 18 slots</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bus</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">famous <a href="https://en.wikipedia.org/wiki/S-100_bus">S-100</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Video</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">none</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">I/O</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional; parallel or serial board (MITS 88-SIO)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Original software</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://altairclone.com/downloads/manuals/Altair%20DOS%20User&#8217;s%20Manual.pdf">Altair DOS</a>,
                   <a href="http://www.classiccmp.org/dunfield/r/cpm22.pdf">CP/M</a>,
                   <a href="https://en.wikipedia.org/wiki/Altair_BASIC">Altair BASIC</a></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="ALTAIR_FOR_EMUSTUDIO">2. Altair8800 for emuStudio</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In emuStudio, there exist two variants of the computer. These variants varies only with the used CPU. There is available
either Intel 8080 emulator, or Zilog Z80 emulator. Lots of behavior and some devices was inspired by
<a href="http://simh.trailing-edge.com/">simh</a> emulator.</p>
</div>
<div class="paragraph">
<p>Abstract schema for emuStudio (Intel 8080):</p>
</div>
<div class="imageblock img-responsive">
<div class="content">
<img src="https://vbmacher.github.io/emuStudio/docuser/mits_altair_8800/images//altairscheme.png" alt="Abstract schema of MITS Altair8800 (with Intel 8080)">
</div>
</div>
<div class="paragraph">
<p>Abstract schema for emuStudio (Zilog Z80):</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://vbmacher.github.io/emuStudio/docuser/mits_altair_8800/images//altairz80.png" alt="Abstract schema of MITS Altair8800 (with Zilog Z80)">
</div>
</div>
<div class="paragraph">
<p>The following plug-ins are used in the schemas. Each plug-in is described in further sections.</p>
</div>
<table class="tableblock frame-all grid-all spread table table-striped table-condensed">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compiler</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/vbmacher/emuStudio/tree/branch-0_39/plugins/compilers/as-8080">as-8080</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compiler</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/vbmacher/emuStudio/tree/branch-0_39/plugins/compilers/as-z80">as-z80</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Operating memory (RAM)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/vbmacher/emuStudio/tree/branch-0_39/plugins/mem/standard-mem">standard-mem</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CPU</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/vbmacher/emuStudio/tree/branch-0_39/plugins/cpu/8080-cpu">8080-cpu</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Another CPU</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/vbmacher/emuStudio/tree/branch-0_39/plugins/cpu/z80-cpu">z80-cpu</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Device</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/vbmacher/emuStudio/tree/branch-0_39/plugins/devices/88-sio">88-sio</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Device</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/vbmacher/emuStudio/tree/branch-0_39/plugins/devices/88-disk">88-disk</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Device</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/vbmacher/emuStudio/tree/branch-0_39/plugins/devices/simhPseudo-z80">simhPseudo-z80</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Device</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/vbmacher/emuStudio/tree/branch-0_39/plugins/devices/adm3A-terminal">adm3A-terminal</a></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="AS-8080">3. Assembler <code>as-8080</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Assembler for Intel 8080 CPU in emuStudio is very similar to
<a href="http://altairclone.com/downloads/manuals/8080%20Programmers%20Manual.pdf">Intel assembler</a>, but has some little
differences. Features include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>full instructions support</p>
</li>
<li>
<p>macro support (unlimited nesting)</p>
</li>
<li>
<p>include other files support</p>
</li>
<li>
<p>data definition</p>
</li>
<li>
<p>relative addressing using labels</p>
</li>
<li>
<p>literals and expressions in various radixes (bin, dec, hex, oct)</p>
</li>
<li>
<p>output is in <a href="https://en.wikipedia.org/wiki/Intel_HEX">Intel HEX</a> format</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The features are very similar to those in <a href="#AS-Z80"><code>as-z80</code> assembler</a>.</p>
</div>
<div class="sect2">
<h3 id="installation-and-run">3.1. Installation and run</h3>
<div class="paragraph">
<p>The assembler is provided as part of emuStudio. It is not deployed as individual package. It can be found
in <code>compilers/</code> directory with name <code>as-8080.jar</code>.</p>
</div>
<div class="paragraph">
<p>The assembler can be run from command line, with command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>java -jar as-8080.jar [--output output_file.hex] [source_file.asm]</pre>
</div>
</div>
<div class="paragraph">
<p>To query for more information, run it with command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>java -jar as-8080.jar --help</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="lexical-symbols">3.2. Lexical symbols</h3>
<div class="paragraph">
<p>The assembler does not differentiate between upper and lower case (it is case-insensitive). The token/symbol types
are as follows:</p>
</div>
<table class="tableblock frame-topbot grid-all spread table table-striped table-condensed">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tfoot>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Comments</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">semi-colon (<code>;</code>) with text after it until the end of the line</p></td>
</tr>
</tfoot>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Keywords</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">instruction names; preprocessor directives (<code>org</code>, <code>equ</code>, <code>set</code>, <code>macro</code>, <code>endm</code>, <code>include</code>,
               <code>if</code>, <code>endif</code>); data definitions (<code>db</code>, <code>dw</code>, <code>ds</code>); CPU registers</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifiers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>([a-zA-Z_\?@])[a-zA-Z_\?@0-9]*</code> except keywords</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Labels</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constants</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">strings or integers</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Operators</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>=</code>, <code>mod</code>, <code>and</code>, <code>or</code>, <code>not</code>, <code>xor</code>, <code>shl</code>, <code>shr</code></p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="constants">3.2.1. Constants</h4>
<div class="paragraph">
<p>Numeric constants can be only integers, encoded with one of several number radixes. The possible formats are written
using regexes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>binary numbers: <code>[0-1]+[bB]</code></p>
</li>
<li>
<p>decimal numbers: <code>[0-9]+[dD]?</code></p>
</li>
<li>
<p>octal numbers: <code>[0-7]+[oOqQ]</code></p>
</li>
<li>
<p>hexadecimal numbers: <code>[0-9][0-9a-fA-F]*[hH]</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Characters or strings must be enclosed in single-quotes, e,g,: <code>MVI E, '*'</code></p>
</div>
</div>
<div class="sect3">
<h4 id="AS-8080-IDENTIFIERS">3.2.2. Identifiers</h4>
<div class="paragraph">
<p>Identifiers must fit to the following regex: <code>([a-zA-Z_\?@])[a-zA-Z_\?@0-9]*</code>. It means, that it has to start with
a letter a-z (or A-Z) or the at-sign (<code>@</code>). Then, it can be followed by letters, at-sign, or numbers.</p>
</div>
<div class="paragraph">
<p>However, they must not equal to any keyword.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="instructions-syntax">3.3. Instructions syntax</h3>
<div class="paragraph">
<p>The program is basically a sequence of instructions. The instructions are separated by a new line. The instruction
have optional and mandatory parts, e.g.:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>LABEL: CODE OPERANDS ; COMMENT</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread table table-striped table-condensed">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LABEL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifier of the memory position, followed by a colon (<code>:</code>).
                           It can be used as forward or backward reference in instructions
                           which expect memory address (or 16 bit number).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CODE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mandatory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Instruction name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>OPERANDS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">It depends</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If applicable, a comma-separated (<code>,</code>) operands of the instruction.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>COMMENT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">semi-colonm (<code>;</code>) followed by any text until the end of the line.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Fields <code>CODE</code> and <code>OPERANDS</code> must be separated by at least one space. For example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>HERE:   MVI C, 0  ; Put 0 into C register
        DB 3Ah    ; Data constant of size 1 byte
LOOP:   JMP LOOP  ; Infinite loop</pre>
</div>
</div>
<div class="paragraph">
<p>Labels are optional. Instructions and pseudo-instructions and register names are reserved for assembler and cannot
be used as labels. Also, there cannot be more definitions of the same label.</p>
</div>
<div class="paragraph">
<p>Operands must be separated with comma (<code>,</code>). There exist several operand types, which represent so-called "address modes".
Allowed address modes depend on the instruction. The possibilities are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Implicit addressing: instructions do not have operands. They are implicit.</p>
</li>
<li>
<p>Register addressing: operands are registers. 8-bit general-purpose register names are: <code>A</code>, <code>B</code>, <code>C</code>, <code>D</code>, <code>E</code>, <code>H</code>, <code>L</code>.
Stack pointer is defined as <code>SP</code>, and program status word (used by <code>push</code> / <code>pop</code> instructions) as <code>PSW</code>.
When register pairs should be used in 16-bit instructions, the same register names are used. For example, <code>DCX D</code> which
decrements pair <code>DE</code>.</p>
</li>
<li>
<p>Register indirect addressing:  for the memory value specified by address in <code>HL</code> pair is used special register
called <code>M</code>, for example: <code>MOV A, M</code>.</p>
</li>
<li>
<p>Immediate addressing: operand is the 8-bit constant. It can be also one character, enclosed in single-quotes.</p>
</li>
<li>
<p>Direct addressing: operand is either 8-bit or 16-bit constant, which is understood as the memory location (address).
For example: <code>SHLD 1234h</code>.</p>
</li>
<li>
<p>Modified page zero: operand is 3-bit value (0-7). It represents a "index", which is multiplied by constant 8, resulting
in final memory address. Used in <code>RST</code> instruction.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Immediate data or addresses can be defined in various ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Integer constant</p>
</li>
<li>
<p>Integer constant as a result of evaluation of some expression (e.g. <code>2 SHL 4</code>, or <code>2 + 2</code>)</p>
</li>
<li>
<p>Current address - denoted by special variable <code>$</code>. For example, instruction <code>JMP $+6</code> denotes a jump by 6-bytes further
from the current address.</p>
</li>
<li>
<p>Character constants, enclosed in single-quotes (e.g. <code>MVI A, '*'</code>)</p>
</li>
<li>
<p>Labels. For example: <code>JMP THERE</code> will jump to the label <code>THERE</code>.</p>
</li>
<li>
<p>Variables. For example:</p>
<div class="literalblock">
<div class="content">
<pre>VALUE SET 'A'
MVI A, VALUE</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="expressions">3.4. Expressions</h3>
<div class="paragraph">
<p>An expression is a combination of the data constants and operators. Expressions are evaluated in compile-time. Given
any two expressions, they must not be defined in circular way.</p>
</div>
<div class="paragraph">
<p>Expressions can be used anywhere a constant is expected.</p>
</div>
<div class="paragraph">
<p>There exist several operators, such as:</p>
</div>
<table class="tableblock frame-all grid-all spread table table-striped table-condensed">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>+</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Addition. Example: <code>DB 2 + 2</code>; evaluates to <code>DB 4</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Subtraction. Example: <code>DW $ - 2</code>; evaluates to the current compilation address minus 2.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Multiply.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer division.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>=</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Comparison for equality. Returns 1 if operands equal, 0 otherwise. Example: <code>DB 2 = 2</code>; evaluates to <code>DB 1</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mod</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Remainder after integer division. Example <code>DB 4 mod 3</code>; evaluates to <code>DB 1</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>and</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Logical and.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>or</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Logical or.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>xor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Logical xor.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>not</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Logical not.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>shl</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Shift left by 1 bit. Example: <code>DB 1 SHL 3</code>; evaluates to <code>DB 8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>shr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Shift right by 1 bit.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Operator priorities are as follows:</p>
</div>
<table class="tableblock frame-topbot grid-all spread table table-striped table-condensed">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Priority</th>
<th class="tableblock halign-left valign-top">Operator</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tfoot>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>or</code>, <code>xor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Binary</p></td>
</tr>
</tfoot>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>( )</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unary</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>*</code>, <code>/</code>, <code>mod</code>, <code>shl</code>, <code>shr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Binary</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>+</code>, <code>-</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unary and binary</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>=</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Binary</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>not</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unary</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>and</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Binary</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>All operators work with its arguments as if they were 16-bit. Their results are always 16-bit numbers. If there
is expected 8-bit number, the result is automatically "cut" using operation <code>result AND 0FFh</code>. This may be unwanted
behavior and might lead to bugs, but it is often useful so the programmer must ensure the correctness.</p>
</div>
</div>
<div class="sect2">
<h3 id="defining-data">3.5. Defining data</h3>
<div class="paragraph">
<p>Data can be defined using special pseudoinstructions. These accept constants. Negative integers are using
<a href="https://en.wikipedia.org/wiki/Two&#8217;s_complement">two&#8217;s complement</a>.</p>
</div>
<div class="paragraph">
<p>The following table describes all possible data definition pseudoinstructions:</p>
</div>
<table class="tableblock frame-all grid-all spread table table-striped table-condensed">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DB [expression]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Define byte. The <code>[expression]</code> must be of size 1 byte.
                       Using this pseudoinstruction, a string can be defined, enclosed in
                       single quotes. For example: <code>DB 'Hello, world!'</code> is equal to
                       <code>DB 'H'</code>, <code>DB 'e'</code>, etc. on separate lines.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DW [expression]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Define word. The <code>[expression]</code> must be max. of size 2 bytes.
                       Data are stored using <a href="https://en.wikipedia.org/wiki/Endianness#Little-endian">little endian</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DS [expression]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Define storage. The <code>[expression]</code> represents number of bytes which should
                       be "reserved". The reserved space will not be modified in memory.
                       It is similar to "skipping" particular number of bytes.</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="examples">3.5.1. Examples:</h4>
<div class="literalblock">
<div class="content">
<pre>HERE:  DB 0A3H          ; A3
W0RD1: DB 5*2, 2FH-0AH  ; 0A25
W0RD2: DB 5ABCH SHR 8   ; 5A
STR:   DB 'STRINGSpl'   ; 535452494E472031
MINUS: DB -03H          ; FD</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>ADD1: dw COMP          ; 1C3B  (assume COMP is 3B1CH)
ADD2: dw FILL          ; B43E (assume FILL is 3EB4H)
ADD3: dw 3C01H, 3CAEH  ; 013CAE3C</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="including-other-source-files">3.6. Including other source files</h3>
<div class="paragraph">
<p>It is both useful and good practice to write modular programs. According to the
<a href="https://en.wikipedia.org/wiki/Don&#8217;t_repeat_yourself">DRY</a> principle the repetitive parts of the program should be
refactored out into functions or modules. Functionally similar groups of these functions or modules can be put into
a library, reusable in other programs.</p>
</div>
<div class="paragraph">
<p>The pseudoinstruction <code>include</code> exists for the purpose of including already written source code into the current
program. The pseudoinstruction is defined as follows:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>INCLUDE '[filename]'</pre>
</div>
</div>
<div class="paragraph">
<p>where <code>[filename]</code> is a relative or absolute path to the file which will be included, enclosed in single-quotes.
The file can include other files, but there must not be defined circular includes (compiler will complain).</p>
</div>
<div class="paragraph">
<p>The current compilation address (denoted by <code>$</code> variable) after the include will be updated about the binary size
of the included file.</p>
</div>
<div class="paragraph">
<p>The namespace of the current program and the included file is <strong>shared</strong>. It means that labels or variables with the
same name in the current program and the included file are prohibited. Include file "sees" everything in the
current program as it was its part.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="paragraph">
<p>Let <code>a.asm</code> contains:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>mvi b, 80h</pre>
</div>
</div>
<div class="paragraph">
<p>Let <code>b.asm</code> contains:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>include 'a.asm'</pre>
</div>
</div>
<div class="paragraph">
<p>Then compiling <code>b.asm</code> will result in:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>06 80     ; mvi b, 80h</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="origin-address-code-org-code">3.7. Origin address (<code>ORG</code>)</h3>
<div class="paragraph">
<p>Syntax: <code>ORG [expression]</code></p>
</div>
<div class="paragraph">
<p>Sets the value to the <code>$</code> variable. It means that from now on, the following instructions will be
placed at the address given by the <code>[expression]</code>. Effectively, it is the same as using <code>DS</code> pseudo-instruction,
but instead of defining number of skipped bytes, we define concrete memory location (address).</p>
</div>
<div class="paragraph">
<p>The following two code snippets are equal:</p>
</div>
<table class="tableblock frame-topbot grid-all spread table table-condensed">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Address</th>
<th class="tableblock halign-left valign-top">Block 1</th>
<th class="tableblock halign-left valign-top">Block 2</th>
<th class="tableblock halign-left valign-top">Opcode</th>
</tr>
</thead>
<tfoot>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2C10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NEXT: XRA A</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NEXT: XRA A</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AF</code></p></td>
</tr>
</tfoot>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2C00</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MOV A,C</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MOV A,C</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>79</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2C01</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>JMP NEXT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>JMP NEXT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>C3 10 2C</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2C04</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DS 12</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ORG $+12</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="equate-code-equ-code">3.8. Equate (<code>EQU</code>)</h3>
<div class="paragraph">
<p>Syntax: <code>[identifier] EQU [expression]</code></p>
</div>
<div class="paragraph">
<p>Define a constant. The <code>[identifier]</code> is a mandatory name of the constant. Please see the <a href="#AS-8080-IDENTIFIERS">Identifiers</a>
section for more details.</p>
</div>
<div class="paragraph">
<p><code>[expression]</code> is the 16-bit expression.</p>
</div>
<div class="paragraph">
<p>The pseudo-instruction will define a constant - assign a name to given expression. The name of the constant then can
be used anywhere where the constant is expected and the compiler will replace it with the expression.</p>
</div>
<div class="paragraph">
<p>It is not possible to redefine a constant.</p>
</div>
</div>
<div class="sect2">
<h3 id="using-variables">3.9. Using variables</h3>
<div class="paragraph">
<p>Syntax: <code>[identifier] SET [expression]</code></p>
</div>
<div class="paragraph">
<p>Define or re-define a variable. The <code>[identifier]</code> is a mandatory name of the constant. Please see
the <a href="#AS-8080-IDENTIFIERS">Identifiers</a> section for more details.</p>
</div>
<div class="paragraph">
<p><code>[expression]</code> is the 16-bit expression.</p>
</div>
<div class="paragraph">
<p>The pseudo-instruction will define a variable - assign a name to given expression. Then, the name of the variable can
be used anywhere where the constant is expected.</p>
</div>
<div class="paragraph">
<p>It is possible to redefine a variable, which effectively means to reassign new expression to the same name and forgetting
the old one. The reassignment is aware of locality, i.e. before it the old value will be used, after it the new value
will be used.</p>
</div>
</div>
<div class="sect2">
<h3 id="conditional-assembly">3.10. Conditional assembly</h3>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>if [expression]
    i n s t r u c t i o n s
endif</pre>
</div>
</div>
<div class="paragraph">
<p>At first, the compiler evaluates the <code>[expression]</code>. If the result is 0, instructions between <code>if</code> and <code>endif</code> will be
ignored. Otherwise they will be included in the source code.</p>
</div>
</div>
<div class="sect2">
<h3 id="defining-and-using-macros">3.11. Defining and using macros</h3>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>[identifier] macro [operands]
    i n s t r u c t i o n s
endm</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>[identifier]</code> is a mandatory name of the macro. Please see the <a href="#AS-8080-IDENTIFIERS">Identifiers</a> section for more details.</p>
</div>
<div class="paragraph">
<p>The <code>[operands]</code> part is a list of identifiers, separated by commas (<code>,</code>). Inside the macro, operands act as constants.
If the macro does not use any operands, this part can be omitted.</p>
</div>
<div class="paragraph">
<p>The namespace of the operand identifiers is macro-local, ie. the operand names will not be visible
outside the macro. Also, the operand names can hide variables, labels or constants defined in the outer scope.</p>
</div>
<div class="paragraph">
<p>The macros can be understood as "templates" which will be expanded in the place where they are "called". The
call syntax is as follows:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>[macro name] [arguments]</pre>
</div>
</div>
<div class="paragraph">
<p>where <code>[macro name]</code> is the macro name as defined above. Then, <code>[arguments]</code> are comma-separated expressions, in the
order as the original operands are defined. The number of arguments must be the same as number of macro operands.</p>
</div>
<div class="paragraph">
<p>The macro can be defined anywhere in the program, even in some included file. Also, it does not matter in which place
is called - above or below the macro definition.</p>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>SHV MACRO
LOOP: RRC      ; Right rotate with carry
      ANI 7FH  ; Clear MSB of accumulator
      DCR D    ; Decrement rotation counter - register D
      JNZ LOOP ; Jump to next rotation
ENDM</pre>
</div>
</div>
<div class="paragraph">
<p>The macro <code>SHV</code> can be used as follows:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>LDA TEMP
MVI D,3  ; 3 rotations
SHV
STA TEMP</pre>
</div>
</div>
<div class="paragraph">
<p>Or another definition:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>SHV MACRO AMT
      MVI D,AMT   ; Number of rotations
LOOP: RRC
      ANI 7FH
      DCR D
      JNZ LOOP
ENDM</pre>
</div>
</div>
<div class="paragraph">
<p>And usage:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>LDA TEMP
SHV 5</pre>
</div>
</div>
<div class="paragraph">
<p>Which has the same effect as the previous example.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="AS-Z80">4. Assembler <code>as-z80</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The assembler syntax is inspired by <a href="#AS-8080"><code>as-8080</code> assembler</a>, and by instruction set described
<a href="http://www.z80.info/zip/z80cpu_um.pdf">here</a>. The assembler supports the following features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>full instructions support</p>
</li>
<li>
<p>macro support (unlimited nesting)</p>
</li>
<li>
<p>include other files support</p>
</li>
<li>
<p>conditional assembly</p>
</li>
<li>
<p>data definition</p>
</li>
<li>
<p>relative addressing using labels</p>
</li>
<li>
<p>literals and expressions in various radixes (bin, dec, hex, oct)</p>
</li>
<li>
<p>output is in <a href="https://en.wikipedia.org/wiki/Intel_HEX">Intel HEX</a> format</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="installation-and-run-2">4.1. Installation and run</h3>
<div class="paragraph">
<p>The assembler is provided as part of emuStudio. It is not deployed as individual package. It can be found
in <code>compilers/</code> directory with name <code>as-z80.jar</code>.</p>
</div>
<div class="paragraph">
<p>The assembler can be run from command line, with command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>java -jar as-z80.jar [--output output_file.hex] [source_file.asm]</pre>
</div>
</div>
<div class="paragraph">
<p>To query for more information, run it with command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>java -jar as-z80.jar --help</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="lexical-symbols-2">4.2. Lexical symbols</h3>
<div class="paragraph">
<p>The assembler does not differentiate between upper and lower case (it is case-insensitive). The token/symbol types
are as follows:</p>
</div>
<table class="tableblock frame-topbot grid-all spread table table-striped table-condensed">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tfoot>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Comments</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">semi-colon (<code>;</code>) with text after it until the end of the line</p></td>
</tr>
</tfoot>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Keywords</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">instruction names; preprocessor directives (<code>org</code>, <code>equ</code>, <code>var</code>, <code>macro</code>, <code>endm</code>, <code>include</code>,
               <code>if</code>, <code>endif</code>); data definitions (<code>db</code>, <code>dw</code>, <code>ds</code>); CPU registers</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifiers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>([a-zA-Z_\?@])[a-zA-Z_\?@0-9]*</code> except keywords</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Labels</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constants</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">strings or integers</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Operators</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>=</code>, <code>%</code>, <code>&amp;</code>, <code>|</code>, <code>!</code>, <code>~</code>, <code>&lt;&lt;</code>, <code>&gt;&gt;</code>, <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code>, '&#8656;`</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="constants-2">4.2.1. Constants</h4>
<div class="paragraph">
<p>Numeric constants can be only integers, encoded with one of several number radixes. The possible formats are written
using regexes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>binary numbers: <code>[0-1]+[bB]</code></p>
</li>
<li>
<p>decimal numbers: <code>[0-9]+[dD]?</code></p>
</li>
<li>
<p>octal numbers: <code>[0-7]+[oOqQ]</code></p>
</li>
<li>
<p>hexadecimal numbers: <code>[0-9][0-9a-fA-F]*[hH]</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Characters or strings must be enclosed in double-quotes, e,g,: <code>LD E, "*"</code></p>
</div>
</div>
<div class="sect3">
<h4 id="Z80-IDENTIFIERS">4.2.2. Identifiers</h4>
<div class="paragraph">
<p>Identifiers must fit to the following regex: <code>([a-zA-Z_\?@])[a-zA-Z_\?@0-9]*</code>. It means, that it has to start with
a letter a-z (or A-Z) or the at-sign (<code>@</code>). Then, it can be followed by letters, at-sign, or numbers.</p>
</div>
<div class="paragraph">
<p>However, they must not equal to any keyword.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="instructions-syntax-2">4.3. Instructions syntax</h3>
<div class="paragraph">
<p>The program is basically a sequence of instructions. The instructions are separated by a new line. The instruction
have optional and mandatory parts, e.g.:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>LABEL: CODE OPERANDS ; COMMENT</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread table table-striped table-condensed">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LABEL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifier of the memory position, followed by a colon (<code>:</code>).
                           It can be used as forward or backward reference in instructions
                           which expect memory address (or 16 bit number).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CODE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mandatory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Instruction name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>OPERANDS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">It depends</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If applicable, a comma-separated (<code>,</code>) operands of the instruction.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>COMMENT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">semi-colonm (<code>;</code>) followed by any text until the end of the line.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Fields <code>CODE</code> and <code>OPERANDS</code> must be separated by at least one space. For example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>HERE:   LD C, 0  ; Put 0 into C register
        DB 3Ah   ; Data constant of size 1 byte
LOOP:   JP LOOP  ; Infinite loop</pre>
</div>
</div>
<div class="paragraph">
<p>Labels are optional. Instructions and pseudo-instructions and register names are reserved for assembler and cannot
be used as labels. Also, there cannot be more definitions of the same label.</p>
</div>
<div class="paragraph">
<p>Operands must be separated with comma (<code>,</code>). There exist several operand types, which represent so-called "address modes".
Allowed address modes depend on the instruction. The possibilities are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Implicit addressing: instructions do not have operands. They are implicit.</p>
</li>
<li>
<p>Register addressing: operands are registers. 8-bit general-purpose register names are: <code>A</code>, <code>B</code>, <code>C</code>, <code>D</code>, <code>E</code>, <code>H</code>, <code>L</code>.
Register pairs have names: <code>BC</code>, <code>DE</code>, <code>HL</code>. Stack pointer is defined as <code>SP</code>, and program status word (used by <code>push</code>
/ <code>pop</code> instructions) as <code>AF</code>. Another 16-bit registers are defined as <code>IX</code>, <code>IY</code>.</p>
</li>
<li>
<p>Register indirect addressing: for example, loading a memory value at address in <code>HL</code> pair: <code>LD A, (HL)</code>.</p>
</li>
<li>
<p>Immediate addressing: operand is the 8-bit constant. It can be also one character, enclosed in double-quotes.</p>
</li>
<li>
<p>Direct addressing: operand is either 8-bit or 16-bit constant, which is understood as the memory location (address).
For example: <code>LD (1234h), HL</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Immediate data or addresses can be defined in various ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Integer constant</p>
</li>
<li>
<p>Integer constant as a result of evaluation of some expression (e.g. <code>2 &lt;&lt; 4</code>, or <code>2 + 2</code>)</p>
</li>
<li>
<p>Current address - denoted by special variable <code>$</code>. For example, instruction <code>JP $+6</code> denotes a jump by 6-bytes further
from the current address.</p>
</li>
<li>
<p>Character constants, enclosed in double-quotes (e.g. <code>LD A, "*"</code>)</p>
</li>
<li>
<p>Labels. For example: <code>JP THERE</code> will jump to the label <code>THERE</code>.</p>
</li>
<li>
<p>Variables. For example:</p>
<div class="literalblock">
<div class="content">
<pre>VALUE VAR 'A'
LD A, VALUE</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="expressions-2">4.4. Expressions</h3>
<div class="paragraph">
<p>An expression is a combination of the data constants and operators. Expressions are evaluated in compile-time. Given
any two expressions, they must not be defined in circular way.</p>
</div>
<div class="paragraph">
<p>Expressions can be used anywhere a constant is expected.</p>
</div>
<div class="paragraph">
<p>There exist several operators, such as:</p>
</div>
<table class="tableblock frame-all grid-all spread table table-striped table-condensed">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>+</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Addition. Example: <code>DB 2 + 2</code>; evaluates to <code>DB 4</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Subtraction. Example: <code>DW $ - 2</code>; evaluates to the current compilation address minus 2.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Multiply.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer division.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>=</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Comparison for equality. Returns 1 if operands equal, 0 otherwise. Example: <code>DB 2 = 2</code>; evaluates to <code>DB 1</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>%</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Remainder after integer division. Example <code>DB 4 mod 3</code>; evaluates to <code>DB 1</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Logical and.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>|</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Logical or.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>~</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Logical xor.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>!</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Logical not.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;&lt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Shift left by 1 bit. Example: <code>DB 1 SHL 3</code>; evaluates to <code>DB 8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&gt;&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Shift right by 1 bit.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Greater than. Example: <code>DB 3 &gt; 2</code>; evaluates to <code>DB 1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Less than.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&gt;=</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Greater or equal than.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&#8656;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Less or equal than.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Operator priorities are as follows:</p>
</div>
<table class="tableblock frame-topbot grid-all spread table table-striped table-condensed">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Priority</th>
<th class="tableblock halign-left valign-top">Operator</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tfoot>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>|</code>, <code>~</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Binary</p></td>
</tr>
</tfoot>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>( )</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unary</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>*</code>, <code>/</code>, <code>%</code>, <code>&lt;&lt;</code>, <code>&gt;&gt;</code>, <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code>, <code>&#8656;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Binary</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>+</code>, <code>-</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unary and binary</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>=</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Binary</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>!</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unary</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Binary</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>All operators work with its arguments as if they were 16-bit. Their results are always 16-bit numbers. If there
is expected 8-bit number, the result is automatically "cut" using operation <code>result AND 0FFh</code>. This may be unwanted
behavior and might lead to bugs, but it is often useful so the programmer must ensure the correctness.</p>
</div>
</div>
<div class="sect2">
<h3 id="defining-data-2">4.5. Defining data</h3>
<div class="paragraph">
<p>Data can be defined using special pseudoinstructions. These accept constants. Negative integers are using
<a href="https://en.wikipedia.org/wiki/Two&#8217;s_complement">two&#8217;s complement</a>.</p>
</div>
<div class="paragraph">
<p>The following table describes all possible data definition pseudoinstructions:</p>
</div>
<table class="tableblock frame-all grid-all spread table table-striped table-condensed">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DB [expression]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Define byte. The <code>[expression]</code> must be of size 1 byte.
                       Using this pseudoinstruction, a string can be defined, enclosed in
                       single quotes. For example: <code>DB 'Hello, world!'</code> is equal to
                       <code>DB 'H'</code>, <code>DB 'e'</code>, etc. on separate lines.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DW [expression]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Define word. The <code>[expression]</code> must be max. of size 2 bytes.
                       Data are stored using <a href="https://en.wikipedia.org/wiki/Endianness#Little-endian">little endian</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DS [expression]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Define storage. The <code>[expression]</code> represents number of bytes which should
                       be "reserved". The reserved space will not be modified in memory.
                       It is similar to "skipping" particular number of bytes.</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="examples-2">4.5.1. Examples:</h4>
<div class="literalblock">
<div class="content">
<pre>HERE:  DB 0A3H          ; A3
W0RD1: DB 5*2, 2FH-0AH  ; 0A25
W0RD2: DB 5ABCH SHR 8   ; 5A
STR:   DB "STRINGSpl"   ; 535452494E472031
MINUS: DB -03H          ; FD</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>ADD1: dw COMP          ; 1C3B  (assume COMP is 3B1CH)
ADD2: dw FILL          ; B43E (assume FILL is 3EB4H)
ADD3: dw 3C01H, 3CAEH  ; 013CAE3C</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="including-other-source-files-2">4.6. Including other source files</h3>
<div class="paragraph">
<p>It is both useful and good practice to write modular programs. According to the
<a href="https://en.wikipedia.org/wiki/Don&#8217;t_repeat_yourself">DRY</a> principle the repetitive parts of the program should be
refactored out into functions or modules. Functionally similar groups of these functions or modules can be put into
a library, reusable in other programs.</p>
</div>
<div class="paragraph">
<p>The pseudoinstruction <code>include</code> exists for the purpose of including already written source code into the current
program. The pseudoinstruction is defined as follows:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>INCLUDE "[filename]"</pre>
</div>
</div>
<div class="paragraph">
<p>where <code>[filename]</code> is a relative or absolute path to the file which will be included, enclosed in double-quotes.
The file can include other files, but there must not be defined circular includes (compiler will complain).</p>
</div>
<div class="paragraph">
<p>The current compilation address (denoted by <code>$</code> variable) after the include will be updated about the binary size
of the included file.</p>
</div>
<div class="paragraph">
<p>The namespace of the current program and the included file is <strong>shared</strong>. It means that labels or variables with the
same name in the current program and the included file are prohibited. Include file "sees" everything in the
current program as it was its part.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="paragraph">
<p>Let <code>a.asm</code> contains:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>ld b, 80h</pre>
</div>
</div>
<div class="paragraph">
<p>Let <code>b.asm</code> contains:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>include "a.asm"</pre>
</div>
</div>
<div class="paragraph">
<p>Then compiling <code>b.asm</code> will result in:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>06 80     ; ld b, 80h</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="origin-address-code-org-code-2">4.7. Origin address (<code>ORG</code>)</h3>
<div class="paragraph">
<p>Syntax: <code>ORG [expression]</code></p>
</div>
<div class="paragraph">
<p>Sets the value to the <code>$</code> variable. It means that from now on, the following instructions will be
placed at the address given by the <code>[expression]</code>. Effectively, it is the same as using <code>DS</code> pseudo-instruction,
but instead of defining number of skipped bytes, we define concrete memory location (address).</p>
</div>
<div class="paragraph">
<p>The following two code snippets are equal:</p>
</div>
<table class="tableblock frame-topbot grid-all spread table table-condensed">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Address</th>
<th class="tableblock halign-left valign-top">Block 1</th>
<th class="tableblock halign-left valign-top">Block 2</th>
<th class="tableblock halign-left valign-top">Opcode</th>
</tr>
</thead>
<tfoot>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2C10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NEXT: XOR A</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NEXT: XOR A</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AF</code></p></td>
</tr>
</tfoot>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2C00</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LD A,C</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LD A,C</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>79</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2C01</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>JP NEXT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>JP NEXT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>C3 10 2C</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2C04</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DS 12</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ORG $+12</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="equate-code-equ-code-2">4.8. Equate (<code>EQU</code>)</h3>
<div class="paragraph">
<p>Syntax: <code>[identifier] EQU [expression]</code></p>
</div>
<div class="paragraph">
<p>Define a constant. The <code>[identifier]</code> is a mandatory name of the constant. Please see the <a href="#AS-8080-IDENTIFIERS">Identifiers</a>
section for more details.</p>
</div>
<div class="paragraph">
<p><code>[expression]</code> is the 16-bit expression.</p>
</div>
<div class="paragraph">
<p>The pseudo-instruction will define a constant - assign a name to given expression. The name of the constant then can
be used anywhere where the constant is expected and the compiler will replace it with the expression.</p>
</div>
<div class="paragraph">
<p>It is not possible to redefine a constant.</p>
</div>
</div>
<div class="sect2">
<h3 id="using-variables-2">4.9. Using variables</h3>
<div class="paragraph">
<p>Syntax: <code>[identifier] VAR [expression]</code></p>
</div>
<div class="paragraph">
<p>Define or re-define a variable. The <code>[identifier]</code> is a mandatory name of the constant. Please see
the <a href="#Z80-IDENTIFIERS">Identifiers</a> section for more details.</p>
</div>
<div class="paragraph">
<p><code>[expression]</code> is the 16-bit expression.</p>
</div>
<div class="paragraph">
<p>The pseudo-instruction will define a variable - assign a name to given expression. Then, the name of the variable can
be used anywhere where the constant is expected.</p>
</div>
<div class="paragraph">
<p>It is possible to redefine a variable, which effectively means to reassign new expression to the same name and forgetting
the old one. The reassignment is aware of locality, i.e. before it the old value will be used, after it the new value
will be used.</p>
</div>
</div>
<div class="sect2">
<h3 id="conditional-assembly-2">4.10. Conditional assembly</h3>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>if [expression]
    i n s t r u c t i o n s
endif</pre>
</div>
</div>
<div class="paragraph">
<p>At first, the compiler evaluates the <code>[expression]</code>. If the result is 0, instructions between <code>if</code> and <code>endif</code> will be
ignored. Otherwise they will be included in the source code.</p>
</div>
</div>
<div class="sect2">
<h3 id="defining-and-using-macros-2">4.11. Defining and using macros</h3>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>[identifier] macro [operands]
    i n s t r u c t i o n s
endm</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>[identifier]</code> is a mandatory name of the macro. Please see the <a href="#Z80-IDENTIFIERS">Identifiers</a> section for more details.</p>
</div>
<div class="paragraph">
<p>The <code>[operands]</code> part is a list of identifiers, separated by commas (<code>,</code>). Inside the macro, operands act as constants.
If the macro does not use any operands, this part can be omitted.</p>
</div>
<div class="paragraph">
<p>The namespace of the operand identifiers is macro-local, ie. the operand names will not be visible
outside the macro. Also, the operand names can hide variables, labels or constants defined in the outer scope.</p>
</div>
<div class="paragraph">
<p>The macros can be understood as "templates" which will be expanded in the place where they are "called". The
call syntax is as follows:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>[macro name] [arguments]</pre>
</div>
</div>
<div class="paragraph">
<p>where <code>[macro name]</code> is the macro name as defined above. Then, <code>[arguments]</code> are comma-separated expressions, in the
order as the original operands are defined. The number of arguments must be the same as number of macro operands.</p>
</div>
<div class="paragraph">
<p>The macro can be defined anywhere in the program, even in some included file. Also, it does not matter in which place
is called - above or below the macro definition.</p>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>SHV MACRO
LOOP: RRCA        ; Right rotate with carry
      AND 7FH     ; Clear MSB of accumulator
      DEC D       ; Decrement rotation counter - register D
      JP NZ, LOOP ; Jump to next rotation
ENDM</pre>
</div>
</div>
<div class="paragraph">
<p>The macro <code>SHV</code> can be used as follows:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>LD A, (TEMP)
LD D,3  ; 3 rotations
SHV
LD (TEMP), A</pre>
</div>
</div>
<div class="paragraph">
<p>Or another definition:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>SHV MACRO AMT
      LD D,AMT   ; Number of rotations
LOOP: RRCA
      AND 7FH
      DEC D
      JP NZ, LOOP
ENDM</pre>
</div>
</div>
<div class="paragraph">
<p>And usage:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>LD A, (TEMP)
SHV 5
LD (TEMP), A</pre>
</div>
</div>
<div class="paragraph">
<p>Which has the same effect as the previous example.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="CPU-8080">5. CPU: Intel 8080 emulator</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Altair 8800 originally came with processor <a href="https://en.wikipedia.org/wiki/Intel_8080">Intel 8080</a>. It is 8-bit
microprocessor, from 1974. Initial clock frequency was 2 MHZ. This processor was one of the first general-purpose and
widespread processors, used not only in calculators but also in first personal computers. One of the key roles why
this CPU become so popular is that Gary Killdall targeted his CP/M to this CPU; and CP/M was de facto a "standard"
in personal computers those days.</p>
</div>
<div class="paragraph">
<p>Main features of the emulator include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Threaded-dispatch combined with interpretation as emulation technique,</p>
</li>
<li>
<p>Correct real timing of instructions,</p>
</li>
<li>
<p>Ability to set clock frequency manually at run-time,</p>
</li>
<li>
<p>Emulation of all instructions including interrupts,</p>
</li>
<li>
<p>Disassembler implementation,</p>
</li>
<li>
<p>Ability to "dump" instruction history to console at run-time,</p>
</li>
<li>
<p>Support of breakpoints,</p>
</li>
<li>
<p>Ability of communication with up to 256 I/O devices,</p>
</li>
<li>
<p>Status window shows all registers, flags, and run-time frequency.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dumping-executed-instructions">6. Dumping executed instructions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The CPU offers a quite unique feature, which is the ability to dump executed instructions as a sequence to the console.
When enabled, then each executed instruction - together with content of flags and registers values after the execution
are printed. This feature might be extremely useful in two cases:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Reverse engineering of some unknown software</p>
</li>
<li>
<p>It allows to build tools for automatic checking of register values during the emulation,
when performing automatic emulation.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In order to enable this feature, please see the section <a href="#CPU-8080-CONFIG_FILE">Configuration file</a>.</p>
</div>
<div class="paragraph">
<p>For example, let&#8217;s take one of the examples which computes a reverse text:</p>
</div>
<div class="listingblock">
<div class="title">Example program for reversing text in 8080 assembly</div>
<div class="content">
<pre class="pygments highlight"><code>; Print reversed text

org 1000

dcx sp       ; stack initialization (0FFFFh)

lxi h,text1
call putstr  ; print text1
lxi d,input  ; address for string input
call getline ; read from keyboard

lxi b,input

mvi d,0      ; chars counter

char_loop:
ldax b
inx b        ; bc = bc+1
cpi 10       ; end of input?
jz char_end
cpi 13
jz char_end

inr d        ; d =d+1
jmp char_loop
char_end:

dcx b        ;  bc = bc-1
dcx b

call newline

char2_loop:
ldax b
call putchar

dcx b

dcr d
jz char2_end

jmp char2_loop
char2_end:


hlt

include 'include\getchar.inc'
include 'include\getline.inc'
include 'include\putstr.inc'
include 'include\putchar.inc'
include 'include\newline.inc'

text1: db 'Reversed text ...',10,13,'Enter text: ',0
text2: db 10,13,'Reversed: ',0
input: ds 30</code></pre>
</div>
</div>
<div class="paragraph">
<p>When the program is being run, and the dump instructions feature is turned on, on console you can see the following
output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>0000 | PC=03e8 |       dcx SP |        3B  || regs=00 00 00 00 00 00 00 00  | flags=      | SP=ffff | PC=03e9
0001 | PC=03e9 |  lxi HL, 485 |  21 85 04  || regs=00 00 00 00 04 85 00 00  | flags=      | SP=ffff | PC=03ec
0001 | PC=03ec |     call 46D |  CD 6D 04  || regs=00 00 00 00 04 85 00 00  | flags=      | SP=fffd | PC=046d
0002 | PC=046d |     mov A, M |        7E  || regs=00 00 00 00 04 85 00 52  | flags=      | SP=fffd | PC=046e
0002 | PC=046e |       inx HL |        23  || regs=00 00 00 00 04 86 00 52  | flags=      | SP=fffd | PC=046f
0003 | PC=046f |        cpi 0 |     FE 00  || regs=00 00 00 00 04 86 00 52  | flags=      | SP=fffd | PC=0471
0004 | PC=0471 |           rz |        C8  || regs=00 00 00 00 04 86 00 52  | flags=      | SP=fffd | PC=0472
0005 | PC=0472 |       out 11 |     D3 11  || regs=00 00 00 00 04 86 00 52  | flags=      | SP=fffd | PC=0474
0006 | PC=0474 |      jmp 46D |  C3 6D 04  || regs=00 00 00 00 04 86 00 52  | flags=      | SP=fffd | PC=046d
0006 | PC=046d |     mov A, M |        7E  || regs=00 00 00 00 04 86 00 65  | flags=      | SP=fffd | PC=046e
0024 | Block from 0474 to 03EF; count=184
0024 | PC=03ef |  lxi DE, 4B2 |  11 B2 04  || regs=00 00 04 b2 04 a5 00 00  | flags= Z P  | SP=ffff | PC=03f2
0025 | PC=03f2 |     call 428 |  CD 28 04  || regs=00 00 04 b2 04 a5 00 00  | flags= Z P  | SP=fffd | PC=0428
0025 | PC=0428 |     mvi C, 0 |     0E 00  || regs=00 00 04 b2 04 a5 00 00  | flags= Z P  | SP=fffd | PC=042a
0025 | PC=042a |        in 10 |     DB 10  || regs=00 00 04 b2 04 a5 00 00  | flags= Z P  | SP=fffd | PC=042c
0026 | PC=042c |        ani 1 |     E6 01  || regs=00 00 04 b2 04 a5 00 00  | flags= Z P  | SP=fffd | PC=042e
0026 | PC=042e |       jz 42A |  CA 2A 04  || regs=00 00 04 b2 04 a5 00 00  | flags= Z P  | SP=fffd | PC=042a
0027 | PC=042a |        in 10 |     DB 10  || regs=00 00 04 b2 04 a5 00 00  | flags= Z P  | SP=fffd | PC=042c
1548 | Block from 042E to 0431; count=181125
1548 | PC=0431 |        in 11 |     DB 11  || regs=00 00 04 b2 04 a5 00 68  | flags=      | SP=fffd | PC=0433
1548 | PC=0433 |        cpi D |     FE 0D  || regs=00 00 04 b2 04 a5 00 68  | flags=      | SP=fffd | PC=0435
1548 | PC=0435 |       jz 461 |  CA 61 04  || regs=00 00 04 b2 04 a5 00 68  | flags=      | SP=fffd | PC=0438
1548 | PC=0438 |        cpi A |     FE 0A  || regs=00 00 04 b2 04 a5 00 68  | flags=      | SP=fffd | PC=043a
1549 | PC=043a |       jz 461 |  CA 61 04  || regs=00 00 04 b2 04 a5 00 68  | flags=      | SP=fffd | PC=043d
1549 | PC=043d |        cpi 8 |     FE 08  || regs=00 00 04 b2 04 a5 00 68  | flags=  AP  | SP=fffd | PC=043f
1549 | PC=043f |      jnz 459 |  C2 59 04  || regs=00 00 04 b2 04 a5 00 68  | flags=  AP  | SP=fffd | PC=0459
1549 | PC=0459 |       out 11 |     D3 11  || regs=00 00 04 b2 04 a5 00 68  | flags=  AP  | SP=fffd | PC=045b
1549 | PC=045b |      stax DE |        12  || regs=00 00 04 b2 04 a5 00 68  | flags=  AP  | SP=fffd | PC=045c
1549 | PC=045c |       inx DE |        13  || regs=00 00 04 b3 04 a5 00 68  | flags=  AP  | SP=fffd | PC=045d
1549 | PC=045d |        inr C |        0C  || regs=00 01 04 b3 04 a5 00 68  | flags=      | SP=fffd | PC=045e
1549 | PC=045e |      jmp 42A |  C3 2A 04  || regs=00 01 04 b3 04 a5 00 68  | flags=      | SP=fffd | PC=042a
1550 | PC=042a |        in 10 |     DB 10  || regs=00 01 04 b3 04 a5 00 00  | flags=      | SP=fffd | PC=042c
2940 | Block from 045E to 0461; count=267777
2940 | PC=0461 |     mvi A, A |     3E 0A  || regs=00 05 04 b7 04 a5 00 0a  | flags= ZAP  | SP=fffd | PC=0463
2940 | PC=0463 |      stax DE |        12  || regs=00 05 04 b7 04 a5 00 0a  | flags= ZAP  | SP=fffd | PC=0464
2940 | PC=0464 |       inx DE |        13  || regs=00 05 04 b8 04 a5 00 0a  | flags= ZAP  | SP=fffd | PC=0465
2940 | PC=0465 |     mvi A, D |     3E 0D  || regs=00 05 04 b8 04 a5 00 0d  | flags= ZAP  | SP=fffd | PC=0467
2940 | PC=0467 |      stax DE |        12  || regs=00 05 04 b8 04 a5 00 0d  | flags= ZAP  | SP=fffd | PC=0468
2940 | PC=0468 |       inx DE |        13  || regs=00 05 04 b9 04 a5 00 0d  | flags= ZAP  | SP=fffd | PC=0469
2940 | PC=0469 |     mvi A, 0 |     3E 00  || regs=00 05 04 b9 04 a5 00 00  | flags= ZAP  | SP=fffd | PC=046b
2941 | PC=046b |      stax DE |        12  || regs=00 05 04 b9 04 a5 00 00  | flags= ZAP  | SP=fffd | PC=046c
2941 | PC=046c |          ret |        C9  || regs=00 05 04 b9 04 a5 00 00  | flags= ZAP  | SP=ffff | PC=03f5
2941 | PC=03f5 |  lxi BC, 4B2 |  01 B2 04  || regs=04 b2 04 b9 04 a5 00 00  | flags= ZAP  | SP=ffff | PC=03f8
2941 | PC=03f8 |     mvi D, 0 |     16 00  || regs=04 b2 00 b9 04 a5 00 00  | flags= ZAP  | SP=ffff | PC=03fa
2941 | PC=03fa |      ldax BC |        0A  || regs=04 b2 00 b9 04 a5 00 68  | flags= ZAP  | SP=ffff | PC=03fb
2941 | PC=03fb |       inx BC |        03  || regs=04 b3 00 b9 04 a5 00 68  | flags= ZAP  | SP=ffff | PC=03fc
2941 | PC=03fc |        cpi A |     FE 0A  || regs=04 b3 00 b9 04 a5 00 68  | flags=      | SP=ffff | PC=03fe
2941 | PC=03fe |       jz 40A |  CA 0A 04  || regs=04 b3 00 b9 04 a5 00 68  | flags=      | SP=ffff | PC=0401
2942 | PC=0401 |        cpi D |     FE 0D  || regs=04 b3 00 b9 04 a5 00 68  | flags=      | SP=ffff | PC=0403
2942 | PC=0403 |       jz 40A |  CA 0A 04  || regs=04 b3 00 b9 04 a5 00 68  | flags=      | SP=ffff | PC=0406
2942 | PC=0406 |        inr D |        14  || regs=04 b3 01 b9 04 a5 00 68  | flags=      | SP=ffff | PC=0407
2942 | PC=0407 |      jmp 3FA |  C3 FA 03  || regs=04 b3 01 b9 04 a5 00 68  | flags=      | SP=ffff | PC=03fa
2942 | PC=03fa |      ldax BC |        0A  || regs=04 b3 01 b9 04 a5 00 65  | flags=      | SP=ffff | PC=03fb
2942 | Block from 0407 to 040A; count=36
2942 | PC=040a |       dcx BC |        0B  || regs=04 b7 05 b9 04 a5 00 0a  | flags= ZAP  | SP=ffff | PC=040b
2943 | PC=040b |       dcx BC |        0B  || regs=04 b6 05 b9 04 a5 00 0a  | flags= ZAP  | SP=ffff | PC=040c
2943 | PC=040c |     call 47A |  CD 7A 04  || regs=04 b6 05 b9 04 a5 00 0a  | flags= ZAP  | SP=fffd | PC=047a
2943 | PC=047a |     mvi A, A |     3E 0A  || regs=04 b6 05 b9 04 a5 00 0a  | flags= ZAP  | SP=fffd | PC=047c
2943 | PC=047c |     call 477 |  CD 77 04  || regs=04 b6 05 b9 04 a5 00 0a  | flags= ZAP  | SP=fffb | PC=0477
2943 | PC=0477 |       out 11 |     D3 11  || regs=04 b6 05 b9 04 a5 00 0a  | flags= ZAP  | SP=fffb | PC=0479
2943 | PC=0479 |          ret |        C9  || regs=04 b6 05 b9 04 a5 00 0a  | flags= ZAP  | SP=fffd | PC=047f
2943 | PC=047f |     mvi A, D |     3E 0D  || regs=04 b6 05 b9 04 a5 00 0d  | flags= ZAP  | SP=fffd | PC=0481
2943 | PC=0481 |     call 477 |  CD 77 04  || regs=04 b6 05 b9 04 a5 00 0d  | flags= ZAP  | SP=fffb | PC=0477
2943 | PC=0477 |       out 11 |     D3 11  || regs=04 b6 05 b9 04 a5 00 0d  | flags= ZAP  | SP=fffb | PC=0479
2943 | Block from 0481 to 0484; count=2
2943 | PC=0484 |          ret |        C9  || regs=04 b6 05 b9 04 a5 00 0d  | flags= ZAP  | SP=ffff | PC=040f
2944 | PC=040f |      ldax BC |        0A  || regs=04 b6 05 b9 04 a5 00 6f  | flags= ZAP  | SP=ffff | PC=0410
2944 | PC=0410 |     call 477 |  CD 77 04  || regs=04 b6 05 b9 04 a5 00 6f  | flags= ZAP  | SP=fffd | PC=0477
2944 | PC=0477 |       out 11 |     D3 11  || regs=04 b6 05 b9 04 a5 00 6f  | flags= ZAP  | SP=fffd | PC=0479
2944 | Block from 0410 to 0413; count=2
2944 | PC=0413 |       dcx BC |        0B  || regs=04 b5 05 b9 04 a5 00 6f  | flags= ZAP  | SP=ffff | PC=0414
2944 | PC=0414 |        dcr D |        15  || regs=04 b5 04 b9 04 a5 00 6f  | flags=  A   | SP=ffff | PC=0415
2944 | PC=0415 |       jz 41B |  CA 1B 04  || regs=04 b5 04 b9 04 a5 00 6f  | flags=  A   | SP=ffff | PC=0418
2944 | PC=0418 |      jmp 40F |  C3 0F 04  || regs=04 b5 04 b9 04 a5 00 6f  | flags=  A   | SP=ffff | PC=040f
2944 | PC=040f |      ldax BC |        0A  || regs=04 b5 04 b9 04 a5 00 6c  | flags=  A   | SP=ffff | PC=0410
2945 | Block from 0418 to 041B; count=31
2945 | PC=041b |          hlt |        76  || regs=04 b1 00 b9 04 a5 00 68  | flags= ZAP  | SP=ffff | PC=041c</pre>
</div>
</div>
<div class="paragraph">
<p>The dump format consists of lines, each line represents one instruction execution. The line is separated by <code>|</code> chars,
splitting it into so-called sections. Sections before the sequence <code>||</code> represent state <strong>before</strong> instruction execution,
and sections after it represent the state <strong>after</strong> instruction execution. Particular sections are described in the
following table.</p>
</div>
<table class="tableblock frame-topbot grid-all spread table table-striped table-condensed">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Column</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tfoot>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Program counter after instruction execution</p></td>
</tr>
</tfoot>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Timestamp from program start (seconds)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Program counter before instruction execution</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disassembled instruction</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Instruction opcodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Now follows the state <strong>after</strong> instruction execution</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Register values (<code>B</code>,<code>C</code>,<code>D</code>,<code>E</code>,<code>H</code>,<code>L</code>, reserved (always 0), <code>A</code>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Flags</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stack pointer register (<code>SP</code>)</p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="CPU-8080-CONFIG_FILE">6.1. Configuration file</h3>
<div class="paragraph">
<p>Configuration file of virtual computers contain also settings of all the used plug-ins, including CPUs. Please
read the section "Accessing settings of plug-ins" in the user documentation of Main module to see how the settings can
be accessed.</p>
</div>
<div class="paragraph">
<p>The following table shows all the possible settings of Intel 8080 CPU plug-in:</p>
</div>
<table class="tableblock frame-topbot grid-all spread table table-striped table-condensed">
<caption class="title">Table 1. Settings of Intel 8080 CPU emulator plug-in</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Valid values</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tfoot>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>printCodeUseCache</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true / false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>printCode</code> is set to <code>true</code>, then a cache will
                                                                    be used which remembers already visited blocks of code
                                                                    so the instruction dump will not be bloated with
                                                                    infinite loops</p></td>
</tr>
</tfoot>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>printCode</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true / false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether the emulator should print executed instructions,
                                                                    and its internal state to console (dump)</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="CPU-Z80">7. CPU: Zilog Z80 emulator</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It was possible to upgrade your Altair 8800 computer with a "better" 8-bit processor
<a href="https://en.wikipedia.org/wiki/Zilog_Z80">Zilog Z80</a>. The processor was probably the most used 8-bit processor in
80&#8217;s. It was backward compatible with 8080, and brought many enhancements. It was originally targeted for embedded
systems, but very soon it become very popular and used for all kinds of computers - including desktop computers,
arcade games, etc. Today the CPU is still used in some MP3 players, see e.g. <a href="https://en.wikipedia.org/wiki/S1_MP3_player" class="bare">https://en.wikipedia.org/wiki/S1_MP3_player</a>.</p>
</div>
<div class="paragraph">
<p>Main features of the emulator include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Interpretation as emulation technique,</p>
</li>
<li>
<p>Correct real timing of instructions,</p>
</li>
<li>
<p>Ability to set clock frequency manually at run-time,</p>
</li>
<li>
<p>Emulation of all instructions including interrupts,</p>
</li>
<li>
<p>Disassembler implementation,</p>
</li>
<li>
<p>Ability to "dump" instruction history to console at run-time,</p>
</li>
<li>
<p>Support of breakpoints,</p>
</li>
<li>
<p>Ability of communication with up to 256 I/O devices,</p>
</li>
<li>
<p>Status window shows all registers, flags, and run-time frequency.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="dumping-executed-instructions-2">7.1. Dumping executed instructions</h3>
<div class="paragraph">
<p>The CPU offers a quite unique feature, which is the ability to dump executed instructions as a sequence to the console.
When enabled, then each executed instruction - together with content of flags and registers values after the execution
are printed. This feature might be extremely useful in two cases:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Reverse engineering of some unknown software</p>
</li>
<li>
<p>It allows to build tools for automatic checking of register values during the emulation,
when performing automatic emulation.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In order to enable this feature, please see the section <a href="#CPU-Z80-CONFIG_FILE">Configuration file</a>.</p>
</div>
<div class="paragraph">
<p>For example, let&#8217;s take one of the examples which computes a reverse text:</p>
</div>
<div class="listingblock">
<div class="title">Example program for reversing text in Z80 assembly</div>
<div class="content">
<pre class="pygments highlight"><code>; Print reversed text

org 1000

dec sp       ; stack initialization (0FFFFh)

ld hl,text1
call putstr  ; print text1
ld de,input  ; address for string input
call getline ; read from keyboard

ld bc,input

ld d,0      ; chars counter

char_loop:
ld a, (bc)
inc bc        ; bc = bc+1
cp 10       ; end of input?
jp z, char_end
cp 13
jp z, char_end

inc d        ; d =d+1
jp char_loop
char_end:

dec bc        ;  bc = bc-1
dec bc

call newline

char2_loop:
ld a, (bc)
call putchar

dec bc

dec d
jp z, char2_end

jp char2_loop
char2_end:

halt

include "include\getchar.inc"
include "include\getline.inc"
include "include\putstr.inc"
include "include\putchar.inc"
include "include\newline.inc"

text1: db "Reversed text ...",10,13,"Enter text: ",0
text2: db 10,13,"Reversed: ",0
input: ds 30</code></pre>
</div>
</div>
<div class="paragraph">
<p>When the program is being run, and the dump instructions feature is turned on, on console you can see the following
output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>0000 | PC=03e8 |          dec SP |        3B  || regs=00 00 00 00 00 00 00 00  IX=0000 IY=0000 IFF=0 I=00 R=01 | flags=       | SP=ffff | PC=03e9
0001 | PC=03e9 |      ld HL, 485 |  21 85 04  || regs=00 00 00 00 04 85 00 00  IX=0000 IY=0000 IFF=0 I=00 R=02 | flags=       | SP=ffff | PC=03ec
0002 | PC=03ec |        call 46D |  CD 6D 04  || regs=00 00 00 00 04 85 00 00  IX=0000 IY=0000 IFF=0 I=00 R=03 | flags=       | SP=fffd | PC=046d
0002 | PC=046d |      ld A, (HL) |        7E  || regs=00 00 00 00 04 85 00 52  IX=0000 IY=0000 IFF=0 I=00 R=04 | flags=       | SP=fffd | PC=046e
0003 | PC=046e |          inc HL |        23  || regs=00 00 00 00 04 86 00 52  IX=0000 IY=0000 IFF=0 I=00 R=05 | flags=       | SP=fffd | PC=046f
0003 | PC=046f |            cp 0 |     FE 00  || regs=00 00 00 00 04 86 00 52  IX=0000 IY=0000 IFF=0 I=00 R=06 | flags=    N  | SP=fffd | PC=0471
0007 | PC=0471 |           ret Z |        C8  || regs=00 00 00 00 04 86 00 52  IX=0000 IY=0000 IFF=0 I=00 R=07 | flags=    N  | SP=fffd | PC=0472
0008 | PC=0472 |      out (11),A |     D3 11  || regs=00 00 00 00 04 86 00 52  IX=0000 IY=0000 IFF=0 I=00 R=08 | flags=    N  | SP=fffd | PC=0474
0008 | PC=0474 |          jp 46D |  C3 6D 04  || regs=00 00 00 00 04 86 00 52  IX=0000 IY=0000 IFF=0 I=00 R=09 | flags=    N  | SP=fffd | PC=046d
0009 | PC=046d |      ld A, (HL) |        7E  || regs=00 00 00 00 04 86 00 65  IX=0000 IY=0000 IFF=0 I=00 R=0a | flags=    N  | SP=fffd | PC=046e
0025 | Block from 0474 to 03EF; count=184
0025 | PC=03ef |      ld DE, 4B2 |  11 B2 04  || regs=00 00 04 b2 04 a5 00 00  IX=0000 IY=0000 IFF=0 I=00 R=42 | flags= Z  N  | SP=ffff | PC=03f2
0025 | PC=03f2 |        call 428 |  CD 28 04  || regs=00 00 04 b2 04 a5 00 00  IX=0000 IY=0000 IFF=0 I=00 R=43 | flags= Z  N  | SP=fffd | PC=0428
0025 | PC=0428 |         ld C, 0 |     0E 00  || regs=00 00 04 b2 04 a5 00 00  IX=0000 IY=0000 IFF=0 I=00 R=44 | flags= Z  N  | SP=fffd | PC=042a
0026 | PC=042a |        in A, 10 |     DB 10  || regs=00 00 04 b2 04 a5 00 02  IX=0000 IY=0000 IFF=0 I=00 R=45 | flags= Z  N  | SP=fffd | PC=042c
0026 | PC=042c |           and 1 |     E6 01  || regs=00 00 04 b2 04 a5 00 00  IX=0000 IY=0000 IFF=0 I=00 R=46 | flags= ZHP   | SP=fffd | PC=042e
0026 | PC=042e |       jp Z, 42A |  CA 2A 04  || regs=00 00 04 b2 04 a5 00 00  IX=0000 IY=0000 IFF=0 I=00 R=47 | flags= ZHP   | SP=fffd | PC=042a
0027 | PC=042a |        in A, 10 |     DB 10  || regs=00 00 04 b2 04 a5 00 02  IX=0000 IY=0000 IFF=0 I=00 R=48 | flags= ZHP   | SP=fffd | PC=042c
6323 | Block from 042E to 0431; count=1048716
6323 | PC=0431 |        in A, 11 |     DB 11  || regs=00 00 04 b2 04 a5 00 61  IX=0000 IY=0000 IFF=0 I=00 R=54 | flags=  H    | SP=fffd | PC=0433
6323 | PC=0433 |            cp D |     FE 0D  || regs=00 00 04 b2 04 a5 00 61  IX=0000 IY=0000 IFF=0 I=00 R=55 | flags=    N  | SP=fffd | PC=0435
6324 | PC=0435 |       jp Z, 461 |  CA 61 04  || regs=00 00 04 b2 04 a5 00 61  IX=0000 IY=0000 IFF=0 I=00 R=56 | flags=    N  | SP=fffd | PC=0438
6324 | PC=0438 |            cp A |     FE 0A  || regs=00 00 04 b2 04 a5 00 61  IX=0000 IY=0000 IFF=0 I=00 R=57 | flags=    N  | SP=fffd | PC=043a
6324 | PC=043a |       jp Z, 461 |  CA 61 04  || regs=00 00 04 b2 04 a5 00 61  IX=0000 IY=0000 IFF=0 I=00 R=58 | flags=    N  | SP=fffd | PC=043d
6324 | PC=043d |            cp 8 |     FE 08  || regs=00 00 04 b2 04 a5 00 61  IX=0000 IY=0000 IFF=0 I=00 R=59 | flags=    N  | SP=fffd | PC=043f
6324 | PC=043f |      jp NZ, 459 |  C2 59 04  || regs=00 00 04 b2 04 a5 00 61  IX=0000 IY=0000 IFF=0 I=00 R=5a | flags=    N  | SP=fffd | PC=0459
6324 | PC=0459 |      out (11),A |     D3 11  || regs=00 00 04 b2 04 a5 00 61  IX=0000 IY=0000 IFF=0 I=00 R=5b | flags=    N  | SP=fffd | PC=045b
6324 | PC=045b |      ld (DE), A |        12  || regs=00 00 04 b2 04 a5 00 61  IX=0000 IY=0000 IFF=0 I=00 R=5c | flags=    N  | SP=fffd | PC=045c
6324 | PC=045c |          inc DE |        13  || regs=00 00 04 b3 04 a5 00 61  IX=0000 IY=0000 IFF=0 I=00 R=5d | flags=    N  | SP=fffd | PC=045d
6325 | PC=045d |           inc C |        0C  || regs=00 01 04 b3 04 a5 00 61  IX=0000 IY=0000 IFF=0 I=00 R=5e | flags=       | SP=fffd | PC=045e
6325 | PC=045e |          jp 42A |  C3 2A 04  || regs=00 01 04 b3 04 a5 00 61  IX=0000 IY=0000 IFF=0 I=00 R=5f | flags=       | SP=fffd | PC=042a
6325 | PC=042a |        in A, 10 |     DB 10  || regs=00 01 04 b3 04 a5 00 02  IX=0000 IY=0000 IFF=0 I=00 R=60 | flags=       | SP=fffd | PC=042c
8683 | Block from 045E to 0461; count=440826
8683 | PC=0461 |         ld A, A |     3E 0A  || regs=00 04 04 b6 04 a5 00 0a  IX=0000 IY=0000 IFF=0 I=00 R=5a | flags= ZH N  | SP=fffd | PC=0463
8683 | PC=0463 |      ld (DE), A |        12  || regs=00 04 04 b6 04 a5 00 0a  IX=0000 IY=0000 IFF=0 I=00 R=5b | flags= ZH N  | SP=fffd | PC=0464
8683 | PC=0464 |          inc DE |        13  || regs=00 04 04 b7 04 a5 00 0a  IX=0000 IY=0000 IFF=0 I=00 R=5c | flags= ZH N  | SP=fffd | PC=0465
8683 | PC=0465 |         ld A, D |     3E 0D  || regs=00 04 04 b7 04 a5 00 0d  IX=0000 IY=0000 IFF=0 I=00 R=5d | flags= ZH N  | SP=fffd | PC=0467
8683 | PC=0467 |      ld (DE), A |        12  || regs=00 04 04 b7 04 a5 00 0d  IX=0000 IY=0000 IFF=0 I=00 R=5e | flags= ZH N  | SP=fffd | PC=0468
8684 | PC=0468 |          inc DE |        13  || regs=00 04 04 b8 04 a5 00 0d  IX=0000 IY=0000 IFF=0 I=00 R=5f | flags= ZH N  | SP=fffd | PC=0469
8684 | PC=0469 |         ld A, 0 |     3E 00  || regs=00 04 04 b8 04 a5 00 00  IX=0000 IY=0000 IFF=0 I=00 R=60 | flags= ZH N  | SP=fffd | PC=046b
8684 | PC=046b |      ld (DE), A |        12  || regs=00 04 04 b8 04 a5 00 00  IX=0000 IY=0000 IFF=0 I=00 R=61 | flags= ZH N  | SP=fffd | PC=046c
8684 | PC=046c |             ret |        C9  || regs=00 04 04 b8 04 a5 00 00  IX=0000 IY=0000 IFF=0 I=00 R=62 | flags= ZH N  | SP=ffff | PC=03f5
8684 | PC=03f5 |      ld BC, 4B2 |  01 B2 04  || regs=04 b2 04 b8 04 a5 00 00  IX=0000 IY=0000 IFF=0 I=00 R=63 | flags= ZH N  | SP=ffff | PC=03f8
8684 | PC=03f8 |         ld D, 0 |     16 00  || regs=04 b2 00 b8 04 a5 00 00  IX=0000 IY=0000 IFF=0 I=00 R=64 | flags= ZH N  | SP=ffff | PC=03fa
8684 | PC=03fa |      ld A, (BC) |        0A  || regs=04 b2 00 b8 04 a5 00 61  IX=0000 IY=0000 IFF=0 I=00 R=65 | flags= ZH N  | SP=ffff | PC=03fb
8684 | PC=03fb |          inc BC |        03  || regs=04 b3 00 b8 04 a5 00 61  IX=0000 IY=0000 IFF=0 I=00 R=66 | flags= ZH N  | SP=ffff | PC=03fc
8684 | PC=03fc |            cp A |     FE 0A  || regs=04 b3 00 b8 04 a5 00 61  IX=0000 IY=0000 IFF=0 I=00 R=67 | flags=    N  | SP=ffff | PC=03fe
8684 | PC=03fe |       jp Z, 40A |  CA 0A 04  || regs=04 b3 00 b8 04 a5 00 61  IX=0000 IY=0000 IFF=0 I=00 R=68 | flags=    N  | SP=ffff | PC=0401
8684 | PC=0401 |            cp D |     FE 0D  || regs=04 b3 00 b8 04 a5 00 61  IX=0000 IY=0000 IFF=0 I=00 R=69 | flags=    N  | SP=ffff | PC=0403
8685 | PC=0403 |       jp Z, 40A |  CA 0A 04  || regs=04 b3 00 b8 04 a5 00 61  IX=0000 IY=0000 IFF=0 I=00 R=6a | flags=    N  | SP=ffff | PC=0406
8685 | PC=0406 |           inc D |        14  || regs=04 b3 01 b8 04 a5 00 61  IX=0000 IY=0000 IFF=0 I=00 R=6b | flags=       | SP=ffff | PC=0407
8685 | PC=0407 |          jp 3FA |  C3 FA 03  || regs=04 b3 01 b8 04 a5 00 61  IX=0000 IY=0000 IFF=0 I=00 R=6c | flags=       | SP=ffff | PC=03fa
8685 | PC=03fa |      ld A, (BC) |        0A  || regs=04 b3 01 b8 04 a5 00 68  IX=0000 IY=0000 IFF=0 I=00 R=6d | flags=       | SP=ffff | PC=03fb
8685 | Block from 0407 to 040A; count=28
8685 | PC=040a |          dec BC |        0B  || regs=04 b6 04 b8 04 a5 00 0a  IX=0000 IY=0000 IFF=0 I=00 R=09 | flags= ZH N  | SP=ffff | PC=040b
8685 | PC=040b |          dec BC |        0B  || regs=04 b5 04 b8 04 a5 00 0a  IX=0000 IY=0000 IFF=0 I=00 R=0a | flags= ZH N  | SP=ffff | PC=040c
8685 | PC=040c |        call 47A |  CD 7A 04  || regs=04 b5 04 b8 04 a5 00 0a  IX=0000 IY=0000 IFF=0 I=00 R=0b | flags= ZH N  | SP=fffd | PC=047a
8685 | PC=047a |         ld A, A |     3E 0A  || regs=04 b5 04 b8 04 a5 00 0a  IX=0000 IY=0000 IFF=0 I=00 R=0c | flags= ZH N  | SP=fffd | PC=047c
8686 | PC=047c |        call 477 |  CD 77 04  || regs=04 b5 04 b8 04 a5 00 0a  IX=0000 IY=0000 IFF=0 I=00 R=0d | flags= ZH N  | SP=fffb | PC=0477
8686 | PC=0477 |      out (11),A |     D3 11  || regs=04 b5 04 b8 04 a5 00 0a  IX=0000 IY=0000 IFF=0 I=00 R=0e | flags= ZH N  | SP=fffb | PC=0479
8686 | PC=0479 |             ret |        C9  || regs=04 b5 04 b8 04 a5 00 0a  IX=0000 IY=0000 IFF=0 I=00 R=0f | flags= ZH N  | SP=fffd | PC=047f
8686 | PC=047f |         ld A, D |     3E 0D  || regs=04 b5 04 b8 04 a5 00 0d  IX=0000 IY=0000 IFF=0 I=00 R=10 | flags= ZH N  | SP=fffd | PC=0481
8686 | PC=0481 |        call 477 |  CD 77 04  || regs=04 b5 04 b8 04 a5 00 0d  IX=0000 IY=0000 IFF=0 I=00 R=11 | flags= ZH N  | SP=fffb | PC=0477
8686 | PC=0477 |      out (11),A |     D3 11  || regs=04 b5 04 b8 04 a5 00 0d  IX=0000 IY=0000 IFF=0 I=00 R=12 | flags= ZH N  | SP=fffb | PC=0479
8686 | Block from 0481 to 0484; count=2
8686 | PC=0484 |             ret |        C9  || regs=04 b5 04 b8 04 a5 00 0d  IX=0000 IY=0000 IFF=0 I=00 R=14 | flags= ZH N  | SP=ffff | PC=040f
8686 | PC=040f |      ld A, (BC) |        0A  || regs=04 b5 04 b8 04 a5 00 6a  IX=0000 IY=0000 IFF=0 I=00 R=15 | flags= ZH N  | SP=ffff | PC=0410
8686 | PC=0410 |        call 477 |  CD 77 04  || regs=04 b5 04 b8 04 a5 00 6a  IX=0000 IY=0000 IFF=0 I=00 R=16 | flags= ZH N  | SP=fffd | PC=0477
8686 | PC=0477 |      out (11),A |     D3 11  || regs=04 b5 04 b8 04 a5 00 6a  IX=0000 IY=0000 IFF=0 I=00 R=17 | flags= ZH N  | SP=fffd | PC=0479
8686 | Block from 0410 to 0413; count=2
8686 | PC=0413 |          dec BC |        0B  || regs=04 b4 04 b8 04 a5 00 6a  IX=0000 IY=0000 IFF=0 I=00 R=19 | flags= ZH N  | SP=ffff | PC=0414
8687 | PC=0414 |           dec D |        15  || regs=04 b4 03 b8 04 a5 00 6a  IX=0000 IY=0000 IFF=0 I=00 R=1a | flags=  H N  | SP=ffff | PC=0415
8687 | PC=0415 |       jp Z, 41B |  CA 1B 04  || regs=04 b4 03 b8 04 a5 00 6a  IX=0000 IY=0000 IFF=0 I=00 R=1b | flags=  H N  | SP=ffff | PC=0418
8687 | PC=0418 |          jp 40F |  C3 0F 04  || regs=04 b4 03 b8 04 a5 00 6a  IX=0000 IY=0000 IFF=0 I=00 R=1c | flags=  H N  | SP=ffff | PC=040f
8687 | PC=040f |      ld A, (BC) |        0A  || regs=04 b4 03 b8 04 a5 00 6f  IX=0000 IY=0000 IFF=0 I=00 R=1d | flags=  H N  | SP=ffff | PC=0410
8687 | Block from 0418 to 041B; count=23
8687 | PC=041b |            halt |        76  || regs=04 b1 00 b8 04 a5 00 61  IX=0000 IY=0000 IFF=0 I=00 R=34 | flags= ZH N  | SP=ffff | PC=041c</pre>
</div>
</div>
<div class="paragraph">
<p>The dump format consists of lines, each line represents one instruction execution. The line is separated by <code>|</code> chars,
splitting it into so-called sections. Sections before the sequence <code>||</code> represent state <strong>before</strong> instruction execution,
and sections after it represent the state <strong>after</strong> instruction execution. Particular sections are described in the
following table.</p>
</div>
<table class="tableblock frame-topbot grid-all spread table table-striped table-condensed">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Column</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tfoot>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Program counter after instruction execution</p></td>
</tr>
</tfoot>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Timestamp from program start (seconds)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Program counter before instruction execution</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disassembled instruction</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Instruction opcodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Now follows the state <strong>after</strong> instruction execution</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Register values (<code>B</code>, <code>C</code>, <code>D</code>, <code>E</code>, <code>H</code>, <code>L</code>, reserved (always 0), <code>A</code>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Flags</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stack pointer register (<code>SP</code>)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="CPU-Z80-CONFIG_FILE">7.2. Configuration file</h3>
<div class="paragraph">
<p>Configuration file of virtual computers contain also settings of all the used plug-ins, including CPUs. Please
read the section "Accessing settings of plug-ins" in the user documentation of Main module to see how the settings can
be accessed.</p>
</div>
<div class="paragraph">
<p>The following table shows all the possible settings of Zilog Z80 CPU plug-in:</p>
</div>
<table class="tableblock frame-topbot grid-all spread table table-striped table-condensed">
<caption class="title">Table 2. Settings of Zilog Z80 CPU emulator plug-in</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Valid values</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tfoot>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>printCodeUseCache</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true / false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>printCode</code> is set to <code>true</code>, then a cache will
                                                                    be used which remembers already visited blocks of code
                                                                    so the instruction dump will not be bloated with
                                                                    infinite loops</p></td>
</tr>
</tfoot>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>printCode</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true / false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether the emulator should print executed instructions,
                                                                    and its internal state to console (dump)</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="operating-memory-code-standard-mem-code">8. Operating memory <code>standard-mem</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This plug-in emulates an operating memory, in a quite broad meaning. It can be used for any virtual
computer which can benefit from the following basic properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A memory cell has size of 1 byte (8 bits)</p>
</li>
<li>
<p>Memory cells are linearly ordered (sequential)</p>
</li>
<li>
<p>Each memory cell is accessible by unique address, representing
the index of the memory cell, if the memory is imagined as an array of cells</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Besides, the memory supports these additional features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Setting up ROM (read only memory) ranges</p>
</li>
<li>
<p>Changing memory size; by default it is 64kB</p>
</li>
<li>
<p>Support of bank switching</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There are also some "interactive" features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Manual loading/saving memory images in either binary or Intel HEX format</p>
</li>
<li>
<p>Ability to automatically load a memory image at startup</p>
</li>
<li>
<p>Intuitive control using keystrokes, and nice visual presentation of the data</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This operating memory is (for now) used only in 8-bit emulator of MITS Altair8800. However it
is possible to develop an emulator which can benefit from it.</p>
</div>
<div class="sect2">
<h3 id="STANDARD-MEM_GUI">8.1. GUI overview</h3>
<div class="paragraph">
<p>To open the memory GUI (graphical user interface), click at the right-most icon in the debug toolbar, on the Emulator panel.
The window is shown, as in the following image:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://vbmacher.github.io/emuStudio/docuser/mits_altair_8800/images//standard-mem.png" alt="Standard operating memory">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>A</strong>: Open a memory image. Current memory content, if it does not interfere with the loaded data
will be kept.</p>
</li>
<li>
<p><strong>B</strong>: Dump (save) whole memory content into a file.</p>
</li>
<li>
<p><strong>C</strong>: Go to address. The address can be either in decimal, hexadecimal (prefix <code>0x</code>)
or octal (prefix <code>0</code>) format.</p>
</li>
<li>
<p><strong>D</strong>: Find a sequence. A dialog shows up where user can find either a plain text or sequence of bytes in the memory.</p>
</li>
<li>
<p><strong>E</strong>: Erases all memory content.</p>
</li>
<li>
<p><strong>F</strong>: Shows <a href="#STANDARD-MEM_SETTINGS">memory settings</a></p>
</li>
<li>
<p><strong>G</strong>: By double-clicking on the memory cell it is possible to edit it and change its value.
The value format is the same as the input to "go to address" dialog (see <strong>C</strong>).</p>
</li>
<li>
<p><strong>H</strong>: Page of the memory view. The whole memory cannot be shown in single window, because it can
be quite large (64 kB by default), so it was divided into pages.</p>
</li>
<li>
<p><strong>I</strong>: If the memory has set up <a href="#STANDARD-MEM_BANKS">memory banks</a>, it is possible to change the view to different bank.
Switching in here has no effect on the emulator and on the active bank.</p>
</li>
<li>
<p><strong>J</strong>: Displays the data of the selected cell in various forms.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Generally, it is possible to move around the cells using keystrokes (arrows). If user presses some
other letter/number key, a small text field appears allowing to edit the current value. When editing
is finished, user can press ENTER key to confirm it, or ESC key to discard the editing.</p>
</div>
</div>
<div class="sect2">
<h3 id="STANDARD-MEM_SETTINGS">8.2. Memory settings</h3>
<div class="paragraph">
<p>Settings window can be opened by clicking on "settings" icon in the main GUI window:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://vbmacher.github.io/emuStudio/docuser/mits_altair_8800/images//standard-mem-settings.png" alt="Memory settings">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>A</strong>: Settings for memory bank-switching</p>
</li>
<li>
<p><strong>B</strong>: Settings for ROM areas</p>
</li>
<li>
<p><strong>C</strong>: If checked, settings for ROM areas will be saved to the configuration file</p>
</li>
<li>
<p><strong>D</strong>: List of memory images which will be loaded at startup</p>
</li>
<li>
<p><strong>E</strong>: The button will apply the settings</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>ROM areas and memory bank-switching is explained in the following sections.</p>
</div>
<div class="sect3">
<h4 id="STANDARD-MEM_ROM">8.2.1. ROM areas</h4>
<div class="paragraph">
<p>Some "controllers" - used as embedded devices - usually logically organize memory into areas, some of
which are read only, which usually contains the firmware, and some are rewritable. Physically, these memories
are wired to specific addresses, so the programmer can access them.</p>
</div>
<div class="paragraph">
<p>Standard operating memory plug-in emulates this behavior. It allows to define ROM areas which represent read only
memory. There can be set up multiple ROM areas, and they can overlap. Effectively it means that memory cells in
ROM area cannot be changed from software running on the emulator. All writes to the memory will be ignored.</p>
</div>
<div class="paragraph">
<p>Manually, as a user it is possible to change the values, but only by loading new memory image. Editing the value
will not work.</p>
</div>
<div class="paragraph">
<p>If a ROM range is defined, it is possible to remove only a part of it, effectively splitting the range and correcting their
boundaries. For example, if there is defined a ROM range from 0x0A - 0x64 (see the image above), then it is possible
to remove a range e.g. 0x32 - 0x46, which is the part of defined ROM area. Then, the original ROM area is split into
two parts - first will be a range from 0x0A - 0x31, and the second from 0x47 - 0x64.</p>
</div>
</div>
<div class="sect3">
<h4 id="STANDARD-MEM_BANKS">8.2.2. Memory bank-switching</h4>
<div class="paragraph">
<p>This technique was invented as a workaround for a problem when the address space of a processor was smaller than memory
size. In order to overcome this issue, memory was logically split into many regions of size equal to the processor address
space. These regions are called "banks".</p>
</div>
<div class="paragraph">
<p>Physically, banks could refer to the same memory, but they could be also different memories (e.g. external cartridges),
and the bank-switching involved switching the active memory.</p>
</div>
<div class="paragraph">
<p>Selecting a bank from a programming perspective was usually done by writing some code to some I/O port using some I/O
instruction of a CPU. But it can be implemented in various ways, e.g. some memory addresses can be used for selecting
a bank.</p>
</div>
<div class="paragraph">
<p>Also, it was very common that some part of the address space still kept some common memory part which was never switched
out. This part is called a "common" part. In emuStudio, common part starts with the <code>Common</code> address (as it can be seen
in the Settings dialog image above) and ends till the rest of the CPU address space (or memory end).</p>
</div>
<div class="paragraph">
<p>To summarize, let&#8217;s consider an example. If a CPU is 8-bit, it means it has address space of size 2^8 - i.e. it can
access memory from address 0 to (2^8 - 1). If the memory was larger, CPU just doesn&#8217;t allow to access higher memory
cells. So memory bank-switching is coming for the rescue. If the memory has 2 MB, we require <code>2^log2(2MB) = 2^21</code> addresses.
So, if we won&#8217;t have any common address space, we require <code>ceil(21 / 8) = 3</code> banks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>bank 0: maps from 0 - (2^8 - 1)</p>
</li>
<li>
<p>bank 1: maps from 2^8 - (2^16 - 1)</p>
</li>
<li>
<p>bank 2: maps from 2^16 - (2^21 - 1)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="STANDARD-MEM_CONFIG_FILE">8.3. Configuration file</h3>
<div class="paragraph">
<p>Configuration file of virtual computers contain also settings of all the used plug-ins, including devices. Please
read the section "Accessing settings of plug-ins" in the user documentation of Main module to see how the settings can
be accessed.</p>
</div>
<div class="paragraph">
<p>The following table shows all the possible settings of Standard operating memory plug-in:</p>
</div>
<table class="tableblock frame-topbot grid-all spread table table-striped table-condensed">
<caption class="title">Table 3. Settings of Standard operating memory</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Valid values</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tfoot>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>imageAddress</code>(i)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt;= 0 and &lt; mem size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The i-th memory image load address</p></td>
</tr>
</tfoot>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>banksCount</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt;= 0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of memory banks</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>commonBoundary</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt;= 0 and &lt; mem size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Address from which the banks are shared</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>memorySize</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">65536</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt; 0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Memory size in bytes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ROMfrom</code>(i)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt;= 0 and &lt; mem size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Start of the i-th ROM area</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ROMto</code>(i)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt;= <code>ROMfrom</code>(i) and &lt; mem size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">End of the i-th ROM area</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>imageName</code>(i)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">file path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The i-th memory image file name.
                                                                    <sup class="footnote">[<a id="_footnoteref_2" class="footnote" href="#_footnote_2" title="View footnote.">2</a>]</sup></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="using-memory-in-custom-computers">8.4. Using memory in custom computers</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This section is for developers of emulators. If you do not plan to create custom virtual computers,
      you can safely skip this section. In order to get started with developing plug-ins for emuStudio,
      please read tutorial "Developing emuStudio Plugins".
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As it was mentioned in the earlier sections, the Standard operating memory plug-in can be used in other
computers, too. Besides standard operations which are provided by <code>emulib.plugins.memory.MemoryContext</code> interface,
it provides custom context API, enabling to use more features - e.g. bank-switching.</p>
</div>
<div class="paragraph">
<p>You can obtain the context during the <code>initialize()</code> method of plug-in main class. The context is named
<code>net.sf.emustudio.memory.standard.StandardMemoryContext</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span style="color: #666666">...</span>

<span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">initialize</span><span style="color: #666666">(</span>SettingsManager settings<span style="color: #666666">)</span> <span style="color: #666666">{</span>
    <span style="color: #666666">...</span>

    StandardMemoryContext mem <span style="color: #666666">=</span> contextPool<span style="color: #666666">.</span><span style="color: #7D9029">getMemoryContext</span><span style="color: #666666">(</span>pluginID<span style="color: #666666">,</span> StandardMemoryContext<span style="color: #666666">.</span><span style="color: #7D9029">class</span><span style="color: #666666">);</span>
    <span style="color: #666666">...</span>
<span style="color: #666666">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The memory context has the following content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span style="color: #008000; font-weight: bold">package</span> <span style="color: #0000FF; font-weight: bold">net.sf.emustudio.memory.standard</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">emulib.annotations.ContextType</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">emulib.plugins.memory.MemoryContext</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">java.util.List</span><span style="color: #666666">;</span>

<span style="color: #408080; font-style: italic">/**</span>
<span style="color: #408080; font-style: italic"> * Extended memory context.</span>
<span style="color: #408080; font-style: italic"> *</span>
<span style="color: #408080; font-style: italic"> * Supports bank switching, ROM ranges, and loading HEX/BIN files.</span>
<span style="color: #408080; font-style: italic"> */</span>
<span style="color: #AA22FF">@ContextType</span><span style="color: #666666">(</span>id <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;Standard memory&quot;</span><span style="color: #666666">)</span>
<span style="color: #008000; font-weight: bold">public</span> <span style="color: #008000; font-weight: bold">interface</span> <span style="color: #0000FF; font-weight: bold">StandardMemoryContext</span> <span style="color: #008000; font-weight: bold">extends</span> MemoryContext<span style="color: #666666">&lt;</span>Short<span style="color: #666666">&gt;</span> <span style="color: #666666">{</span>

    <span style="color: #408080; font-style: italic">/**</span>
<span style="color: #408080; font-style: italic">     * This interface represents a range of addresses in the memory.</span>
<span style="color: #408080; font-style: italic">     */</span>
    <span style="color: #008000; font-weight: bold">interface</span> <span style="color: #0000FF; font-weight: bold">AddressRange</span> <span style="color: #666666">{</span>
        <span style="color: #B00040">int</span> <span style="color: #0000FF">getStartAddress</span><span style="color: #666666">();</span>
        <span style="color: #B00040">int</span> <span style="color: #0000FF">getStopAddress</span><span style="color: #666666">();</span>
    <span style="color: #666666">}</span>

    <span style="color: #408080; font-style: italic">/**</span>
<span style="color: #408080; font-style: italic">     * Determine whether specified memory position is read-only.</span>
<span style="color: #408080; font-style: italic">     *</span>
<span style="color: #408080; font-style: italic">     * @param address memory position</span>
<span style="color: #408080; font-style: italic">     * @return true if the memory position is read only, false otherwise</span>
<span style="color: #408080; font-style: italic">     */</span>
    <span style="color: #B00040">boolean</span> <span style="color: #0000FF">isROM</span><span style="color: #666666">(</span><span style="color: #B00040">int</span> address<span style="color: #666666">);</span>

    <span style="color: #408080; font-style: italic">/**</span>
<span style="color: #408080; font-style: italic">     * Get list of ranges of read-only addresses.</span>
<span style="color: #408080; font-style: italic">     *</span>
<span style="color: #408080; font-style: italic">     * @return list of ROM memory addresses</span>
<span style="color: #408080; font-style: italic">     */</span>
    List<span style="color: #666666">&lt;?</span> <span style="color: #008000; font-weight: bold">extends</span> AddressRange<span style="color: #666666">&gt;</span> <span style="color: #0000FF">getROMRanges</span><span style="color: #666666">();</span>

    <span style="color: #408080; font-style: italic">/**</span>
<span style="color: #408080; font-style: italic">     * Set specified memory range as RAM (Random Access Memory).</span>
<span style="color: #408080; font-style: italic">     *</span>
<span style="color: #408080; font-style: italic">     * @param range address range</span>
<span style="color: #408080; font-style: italic">     */</span>
    <span style="color: #B00040">void</span> <span style="color: #0000FF">setRAM</span><span style="color: #666666">(</span>AddressRange range<span style="color: #666666">);</span>

    <span style="color: #408080; font-style: italic">/**</span>
<span style="color: #408080; font-style: italic">     * Set specified memory range as ROM (Read Only Memory).</span>
<span style="color: #408080; font-style: italic">     *</span>
<span style="color: #408080; font-style: italic">     * @param range address range</span>
<span style="color: #408080; font-style: italic">     */</span>
    <span style="color: #B00040">void</span> <span style="color: #0000FF">setROM</span><span style="color: #666666">(</span>AddressRange range<span style="color: #666666">);</span>

    <span style="color: #408080; font-style: italic">/**</span>
<span style="color: #408080; font-style: italic">     * Get number of available memory banks.</span>
<span style="color: #408080; font-style: italic">     *</span>
<span style="color: #408080; font-style: italic">     * @return count of memory banks</span>
<span style="color: #408080; font-style: italic">     */</span>
    <span style="color: #B00040">int</span> <span style="color: #0000FF">getBanksCount</span><span style="color: #666666">();</span>

    <span style="color: #408080; font-style: italic">/**</span>
<span style="color: #408080; font-style: italic">     * Get index of the selected memory bank.</span>
<span style="color: #408080; font-style: italic">     *</span>
<span style="color: #408080; font-style: italic">     * @return index of active (selected) memory bank</span>
<span style="color: #408080; font-style: italic">     */</span>
    <span style="color: #B00040">short</span> <span style="color: #0000FF">getSelectedBank</span><span style="color: #666666">();</span>

    <span style="color: #408080; font-style: italic">/**</span>
<span style="color: #408080; font-style: italic">     * Select (set as active) a memory bank.</span>
<span style="color: #408080; font-style: italic">     *</span>
<span style="color: #408080; font-style: italic">     * @param bankIndex index (number) of a bank which should be selected</span>
<span style="color: #408080; font-style: italic">     */</span>
    <span style="color: #B00040">void</span> <span style="color: #0000FF">selectBank</span><span style="color: #666666">(</span><span style="color: #B00040">short</span> bankIndex<span style="color: #666666">);</span>

    <span style="color: #408080; font-style: italic">/**</span>
<span style="color: #408080; font-style: italic">     * Return an address in the memory which represents a boundary from which</span>
<span style="color: #408080; font-style: italic">     * the memory banks have the same content. Before this address all banks</span>
<span style="color: #408080; font-style: italic">     * can have different content.</span>
<span style="color: #408080; font-style: italic">     *</span>
<span style="color: #408080; font-style: italic">     * @return common boundary address</span>
<span style="color: #408080; font-style: italic">     */</span>
    <span style="color: #B00040">int</span> <span style="color: #0000FF">getCommonBoundary</span><span style="color: #666666">();</span>

    <span style="color: #408080; font-style: italic">/**</span>
<span style="color: #408080; font-style: italic">     * Loads a HEX file into the memory.</span>
<span style="color: #408080; font-style: italic">     *</span>
<span style="color: #408080; font-style: italic">     * @param filename file name</span>
<span style="color: #408080; font-style: italic">     * @param bank bank index</span>
<span style="color: #408080; font-style: italic">     * @return true if the file was loaded successfully, false otherwise</span>
<span style="color: #408080; font-style: italic">     */</span>
    <span style="color: #B00040">boolean</span> <span style="color: #0000FF">loadHex</span><span style="color: #666666">(</span>String filename<span style="color: #666666">,</span> <span style="color: #B00040">int</span> bank<span style="color: #666666">);</span>

    <span style="color: #408080; font-style: italic">/**</span>
<span style="color: #408080; font-style: italic">     * Loads a binary file into the memory.</span>
<span style="color: #408080; font-style: italic">     *</span>
<span style="color: #408080; font-style: italic">     * @param filename file name</span>
<span style="color: #408080; font-style: italic">     * @param address location in the memory</span>
<span style="color: #408080; font-style: italic">     * @param bank bank index</span>
<span style="color: #408080; font-style: italic">     * @return true if the file was loaded successfully, false otherwise</span>
<span style="color: #408080; font-style: italic">     */</span>
    <span style="color: #B00040">boolean</span> <span style="color: #0000FF">loadBin</span><span style="color: #666666">(</span>String filename<span style="color: #666666">,</span> <span style="color: #B00040">int</span> address<span style="color: #666666">,</span> <span style="color: #B00040">int</span> bank<span style="color: #666666">);</span>

<span style="color: #666666">}</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="DISK-88">9. Disk controller <code>88-disk</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Altair Disk offered the advantage of fixed memory including relatively fast access to data. Data were transferred with
speed 250 Kb/s (The plug-in does not emulate this). Disk was connected with disk controller (or board), and the data
were transferred in serial fashion, bit after bit.</p>
</div>
<div class="paragraph">
<p>Disk controller, on the other hand communicated with CPU. It transformed these serial data into 8-bit words which were
stored/read by CPU into/from operating memory.</p>
</div>
<div class="paragraph">
<p>MITS 88-DISK offered to connect up to 16 disk devices (one can be seen in the front image in the Introduction section).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Original manual can be downloaded at
      <a href="http://www.virtualaltair.com/virtualaltair.com/PDF/88dsk%20manual%20v2.pdf">this link</a>.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="features">9.1. Features</h3>
<div class="paragraph">
<p>The plug-in emulates basic functionality of the whole disk system for Altair 8800 computer. It is not only disk
controller, but also the disk drive.</p>
</div>
<div class="paragraph">
<p>The features include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>allows to mount up to 16 disk images</p>
</li>
<li>
<p>CPU ports can be set manually</p>
</li>
<li>
<p>interrupts are not implemented</p>
</li>
<li>
<p>images can be saved for automatic mount at startup</p>
</li>
<li>
<p>GUI</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="DISK-88_MOUNTING_IMAGES">9.2. Mounting disk images</h3>
<div class="paragraph">
<p>In order to mount DISK images to the device, please go to the Settings window <sup class="footnote" id="_footnote_peripheral">[<a id="_footnoteref_3" class="footnote" href="#_footnote_3" title="View footnote.">3</a>]</sup>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://vbmacher.github.io/emuStudio/docuser/mits_altair_8800/images//88-disk-01.png" alt="Settings window of 88-DISK">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>A</strong>: Select drive (A - P)</p>
</li>
<li>
<p><strong>B</strong>: Choosing the image file</p>
</li>
<li>
<p><strong>C</strong>: Set sectors count and sector length for the current drive <sup class="footnote">[<a id="_footnoteref_4" class="footnote" href="#_footnote_4" title="View footnote.">4</a>]</sup>.</p>
</li>
<li>
<p><strong>D</strong>: Set default values for sector count and sector length for the current drive.</p>
</li>
<li>
<p><strong>E</strong>: Mount/unmount the image file onto/from the selected drive.
Mount operation: If there is any disk mounted already, the new image will be re-mounted.</p>
</li>
<li>
<p><strong>F</strong>: Check box for saving the settings into the computer configuration file. If checked, the settings will be
loaded after start.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="cpu-ports-settings">9.3. CPU Ports settings</h3>
<div class="paragraph">
<p>MITS 88-DISK board communicates with CPU using its ports. There are three ports overall, each for different function.
For more information, see section <a href="#DISK-88_PROGRAMMING">Programming</a>. By default, the ports used by 88-DISK are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>port 1: 0x08</p>
</li>
<li>
<p>port 2: 0x09</p>
</li>
<li>
<p>port 3: 0x0A</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These numbers can be changed in the Settings window, tab "CPU Ports":</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://vbmacher.github.io/emuStudio/docuser/mits_altair_8800/images//88-disk-02.png" alt="Setting CPU ports">
</div>
</div>
</div>
<div class="sect2">
<h3 id="configuration-file">9.4. Configuration file</h3>
<div class="paragraph">
<p>Configuration file of virtual computers contain also settings of all the used plug-ins, including devices. Please
read the section "Accessing settings of plug-ins" in the user documentation of Main module to see how the settings can
be accessed.</p>
</div>
<div class="paragraph">
<p>The following table shows all the possible settings of MITS 88-DISK plug-in:</p>
</div>
<table class="tableblock frame-topbot grid-all spread table table-striped table-condensed">
<caption class="title">Table 4. Settings of MITS 88-DISK</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Valid values</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tfoot>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>image15</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Path to existing file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">File name to mount on disk P (15)</p></td>
</tr>
</tfoot>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>port1CPU</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x08</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt; 0 and &lt; 256</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of Port 1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>port2CPU</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x09</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt; 0 and &lt; 256</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of Port 2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>port3CPU</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x0A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt; 0 and &lt; 256</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of Port 3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sectorsPerTrack</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt; 0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Count of sectors in a disk image</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sectorLength</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">137</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt; 0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Size of one sector in bytes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>image0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Path to existing file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">File name to mount on disk A (0)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="DISK-88_PROGRAMMING">9.5. Programming</h3>
<div class="paragraph">
<p>Data are written onto or read from disk in a serial fashion. The position in the floppy disk is uniquely set by the
track number, sector number and the offset in the sector. It is rudimentary to know how many tracks are available,
so as how many sectors per track and the sector size.</p>
</div>
<div class="paragraph">
<p>In Altair8800, drive <code>Pertec FD400</code> used 8" diskettes. Each had 77 tracks. The track had 32 sectors with 137 bytes long.
The capacity was therefore <code>77 * 32 * 137 = 337568 B = 330 kB</code>. Software used less capacity, because 9 bytes from
each sector were used for the integrity checksum.</p>
</div>
<div class="sect3">
<h4 id="setting-the-position">9.5.1. Setting the position</h4>
<div class="paragraph">
<p>Track number and sector number can be set only incrementally, not directly. Setting the offset within the sector is
more challenging.</p>
</div>
<div class="paragraph">
<p>After track and sector were set, programmer must "poll" the status port which tells him when the
disk position is set to the beginning of the sector. Then, programmer must read data until he gets to the position
where he wanted.</p>
</div>
</div>
<div class="sect3">
<h4 id="cpu-ports">9.5.2. CPU Ports</h4>
<div class="paragraph">
<p>The controller communicates with CPU using three I/O ports at addresses (by default) 0x08, 0x09 and 0x0A. The following
table shows the CPU ports and how they are used.</p>
</div>
<table class="tableblock frame-topbot grid-all spread table table-condensed">
<caption class="title">Table 5. Summary of CPU ports usage</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Port</th>
<th class="tableblock halign-left valign-top">Address</th>
<th class="tableblock halign-left valign-top">Input</th>
<th class="tableblock halign-left valign-top">Output</th>
</tr>
</thead>
<tfoot>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x0A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Write data</p></td>
</tr>
</tfoot>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x08</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disk and controller status</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Select disk</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x09</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get number of sector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disk settings</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Now, detailed description of the ports follow. Bits are ordered in a byte as follows:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>D7 D6 D5 D4 D3 D2 D1 D0</pre>
</div>
</div>
<div class="paragraph">
<p>where <code>D7</code> is the most significant bit, and <code>D0</code> the least significant bit.</p>
</div>
<div class="sect4">
<h5 id="port-1-default-address-0x08">Port 1 (default address: 0x08)</h5>
<div class="paragraph">
<p><strong>WRITE</strong>:</p>
</div>
<div class="paragraph">
<p>Selects and enables one of 16 disk devices. By selecting a drive, all further operations
will be performed on that drive. If the disk has not mounted any disk image, all further operations will be ignored.
The previously selected device will be disabled.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>D7</code>         : if the value is 1, disable the drive. If the value is 0, select and enable the drive.</p>
</li>
<li>
<p><code>D6 D5 D4</code>   : unused bits</p>
</li>
<li>
<p><code>D3 D2 D1 D0</code>: index of the drive to be selected. From 0-15.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>READ</strong>:</p>
</div>
<div class="paragraph">
<p>Read disk status of the selected drive.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>D7</code> : <em>New read data available</em>. Indicates if there is at least 1 byte available for reading from Port 3 (value=0).
It will be reset after data are read (value=1). If the value is 1, data read from Port 3 will be invalid or
no new data is available.</p>
</li>
<li>
<p><code>D6</code> : <em>Track 0</em>. Indicates if the head is positioned at track 0 (value=0).</p>
</li>
<li>
<p><code>D5</code> : <em>Interrupt Enabled</em>. Indicates if interrupts are used (value=0). The plug-in does not support interrupts,
therefore the value will be always 1.</p>
</li>
<li>
<p><code>D4 D3</code> : Unused bits; they are always 0.</p>
</li>
<li>
<p><code>D2</code> : <em>Head Status</em>. Indicates the correctness of the head setting. If the value is 0, reading sector number from Port 2
will be valid.</p>
</li>
<li>
<p><code>D1</code> : <em>Move head</em>. Indicates if the movement of the disk head is allowed. If the value is 1, all track number changes
will be ignored.</p>
</li>
<li>
<p><code>D0</code> : <em>Enter new write data</em>. Indicates if the device is ready for writing data. If the value is 1, all written
data will be ignored.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Initial values of the bits are: <code>11100111</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="port-2-default-address-0x09">Port 2 (default address: 0x09)</h5>
<div class="paragraph">
<p><strong>WRITE</strong>:</p>
</div>
<div class="paragraph">
<p>Control the disk head, and other settings if a disk drive is selected.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>D7</code> : <em>Write Enable</em>. Initializes write sequence (enables writing to the disk; value=1). The plug-in sets the sector
number to 0 and also value 0 to bit <code>D0</code> of Port 1 (<em>Enter new write data</em>) <sup class="footnote">[<a id="_footnoteref_5" class="footnote" href="#_footnote_5" title="View footnote.">5</a>]</sup>.</p>
</li>
<li>
<p><code>D6</code> : <em>Head Current Switch</em>. On real disks the bit should be set to 1 when a program is writting data to tracks
from 43-76. The plug-in the bit is ignored.</p>
</li>
<li>
<p><code>D5</code> : <em>Interrupt Disable</em>. Setting is ignored sicne plug-in does not support interrupts.</p>
</li>
<li>
<p><code>D4</code> : <em>Interrupt Enable</em>. Setting is ignored sicne plug-in does not support interrupts.</p>
</li>
<li>
<p><code>D3</code> : <em>Head unload</em>. Removes head from the disk surface. Reading sector number will now become invalid. In addition,
value of bit <code>D7</code> from Port 1 (<em>New read data available</em>) become 1 (no new data).</p>
</li>
<li>
<p><code>D2</code> : <em>Head load</em>. Sets the disk head onto disk surface. Reading sector number now becomes valid. If additionally
the bit <code>D7</code> from Port 1 (<em>New data available</em>) is set, it is possible to read data from the disk.</p>
</li>
<li>
<p><code>D1</code> : <em>Step Out</em>. Move the disk head back by 1 track (the track number is decremented). It is required to check
bit <code>D1</code> of Port 1 (<em>Move head</em>) to have value 0.</p>
</li>
<li>
<p><code>D0</code> : <em>Step In</em>. Move the disk head ahead by 1 track (the track number is incremented). It is required to check
bit <code>D1</code> of Port 1 (<em>Move head</em>) to have value 0.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>READ</strong>:</p>
</div>
<div class="paragraph">
<p>Reads the number of the sector. The value can be read only if a disk drive is selected and the disk head is positioned
at the disk surface (by setting the bit <code>D2</code>).</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>D7 D6</code> : Unused bits; they are always 1.</p>
</li>
<li>
<p><code>D5 D4 D3 D2 D1</code>: Number of the sector, counted from 0.</p>
</li>
<li>
<p><code>D0</code> : <em>Sector True</em>. If the value is 0, the offset in sector is 0 <sup class="footnote">[<a id="_footnoteref_6" class="footnote" href="#_footnote_6" title="View footnote.">6</a>]</sup>.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="port-3-default-address-0x0a">Port 3 (default address: 0x0A)</h5>
<div class="paragraph">
<p><strong>WRITE</strong>:</p>
</div>
<div class="paragraph">
<p>Write a byte to disk. In order to perform valid write, the <em>Write Enable</em> <code>D7</code> bit of Port 2 must be set to 1. Before data
are written to disk, it is required to check bit <code>D0</code> from Port 1 (<em>Enter new write data</em>).</p>
</div>
<div class="paragraph">
<p><strong>READ</strong>:</p>
</div>
<div class="paragraph">
<p>Read a byte from disk. In order to perform valid read, the <em>Head load</em> <code>D2</code> bit of Port 2 must be set to 1. Only if bit
<code>D7</code> from Port 1 (<em>New read data available</em>) is set to 0, the read data are valid.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="program-example">9.5.3. Program example</h4>
<div class="paragraph">
<p>In this section, an example is presented showing how to read/write data from/to the floppy disk. At first, it writes
one byte (letter <code>A</code> with ASCII value 65) to track 1, sector 18 and offset 20. Then, it reads the byte to operating
memory at address 0x200.</p>
</div>
<div class="paragraph">
<p>The program uses 3 procedures (in assembler for Intel 8080) for setting the disk position (<code>ltrack</code> for loading the
track number, <code>lsector</code> for loading the sector number, and <code>loffset</code> for loading the offset within the sector) and two
more for data reading (<code>read</code>) and writing (<code>write</code>).</p>
</div>
<div class="listingblock">
<div class="title">Example program for writing/reading using MITS 88-DISK</div>
<div class="content">
<pre>disk0  equ 0    ; disk number
track  equ 1    ; track number
sector equ 18   ; sector number
offset equ 20   ; offset within the sector
data   equ 'A'  ; data for writing

dcx sp          ; set stack register to 0xFFFF

mvi a, disk0    ; select disk
out 08h

call ltrack     ; set track number

call we         ; set 'write enable' sequence
call lsector    ; set sector number
call loffset    ; set sector offset
call write      ; write data

call lsector    ; set sector number (for clearing the offset)
call loffset    ; set sector offset
call read       ; read data

lxi h, readdata ; load address for reading the data
mov m, a        ; move the data there

hlt             ; end

ltrack0:        ; the procedure will set track number to 0
in 08h          ; read disk status
ani 1000000b    ; track 0 ?
rz              ; yes, return
mvi a, 1000b    ; head unload
out 09h
call movetrk    ; wait until the disk head can be moved
mvi a, 10b      ; step out, decrement track number
out 08h
jmp ltrack0

ltrack:         ; procedure sets a track number
call ltrack0    ; at first, set track number to 0
mvi b, track+1  ; b = track + 1
stepin:         ; stepin: {
dcr b           ;   b--;
rz              ;   if (b == 0) return;
call movetrk    ;   wait until the disk head can be moved
mvi a, 1        ;   step in, increment track number
out 09h
jmp stepin      ;   goto stepin;
                ; }

movetrk:        ; procedure waits until the disk head can be moved
in 08h          ; read disk status
ani 10b         ; can the disk head be moved?
jnz movetrk     ; nope, try again...
ret             ; yes, return

lsector:        ; procedure sets a sector number
mvi a, 100b     ; head load
out 09h
waits:
in 09h          ; read sector number
ani 3Fh         ; clear unused bits
rrc
cpi sector      ; is the number what is requested?
jnz waits       ; nope, try again
ret             ; yes, return

loffset:        ; procedure sets a sector offset
mvi b, offset+1 ; b = offset + 1
stepoff:        ; stepoff: {
dcr b           ;   b--;
rz              ;   if (b == 0) return;
call read       ;   read data; the offset is incremented
jmp stepoff     ;   goto stepoff;
                ; }

read:           ; procedure reads data from the disk
in 08h          ; read disk status
ani 100b        ; check if the disk head is loaded on the disk surface
rnz             ; if not, return
waitr:
in 08h          ; read disk status
ani 10000000b   ; New read data available ?
jnz waitr       ; nope, try again...
in 0Ah          ; yes, read data
ret             ; return

we:             ; procedure enables 'write enable' sequence
mvi a, 10000000b ; write enable
out 09h
ret

write:          ; procedure writes data to the disk
in 08h          ; read disk status
ani 100b        ; check if the disk head is loaded on the disk surface
rnz             ; if not, return
waitw:
in 08h          ; read disk status
ani 1           ; enter new write data ?
jnz waitw       ; nope, try again...
mvi a, data     ; yes, write data
out 0Ah
ret

org 200h
readdata: db 0</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="SIO-88">10. Serial board <code>88-sio</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Altair 8800 computer was equipped with serial board called
<a href="http://www.s100computers.com/Hardware%20Folder/MITS/SIO-B/SIO.htm">88-SIO</a>, or 88-2 SIO. It was a device which allowed
connecting other devices using RS-232 interface. From one side it was attached to CPU on at least two ports
(most commonly 0x10 and 0x11). The other side was ended with one or two physical ports (allowing to connect one or
two devices). Real board supported both hardware and software interrupts.</p>
</div>
<div class="paragraph">
<p>The following image shows MITS 88-SIO-2 board.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://vbmacher.github.io/emuStudio/docuser/mits_altair_8800/images//88-sio-2.png" alt="Serial board MITS 88-SIO-2">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Original manual of MITS 88-SIO serial board can be downloaded at
      <a href="http://maben.homeip.net/static/s100/altair/cards/Altair%2088-SIO%20serial%20IO.pdf">this link</a>.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="features-2">10.1. Features</h3>
<div class="paragraph">
<p>The plug-in emulates only basic functionality of the board. It has the following features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>allows to connect one device only</p>
</li>
<li>
<p>CPU ports can be set manually</p>
</li>
<li>
<p>interrupts are not implemented</p>
</li>
<li>
<p>setting of transfer speed, parity, number of stop bits is not supported</p>
</li>
<li>
<p>GUI</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="cpu-ports-settings-2">10.2. CPU Ports settings</h3>
<div class="paragraph">
<p>MITS 88-SIO board is attached to CPU using multiple ports. By default, the used CPU ports are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Status port: 0x03, 0x10, 0x14, 0x16, 0x18 (preferred: 0x10)</p>
</li>
<li>
<p>Data port: 0x02, 0x11, 0x15, 0x17, 0x19 (preferred: 0x11)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The reason why there are multiple "bindings" is that there existed various software which expected specific bindings.
The presented default values are the most common ones.</p>
</div>
<div class="paragraph">
<p>These numbers can be changed in the Settings window:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://vbmacher.github.io/emuStudio/docuser/mits_altair_8800/images//88-sio-ports.png" alt="Settings window">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>A</strong>: Attach Status SIO port to some new CPU port. The CPU port must be unique among both Status and Data ports
attachments.</p>
</li>
<li>
<p><strong>B</strong>: Detach Status SIO port from selected CPU port.</p>
</li>
<li>
<p><strong>C</strong>: Attach Data SIO port to some new CPU port. The CPU port must be unique among both Status and Data ports
attachments.</p>
</li>
<li>
<p><strong>D</strong>: Detach Data SIO port from selected CPU port.</p>
</li>
<li>
<p><strong>E</strong>: List of CPU ports to which the Status SIO port is attached</p>
</li>
<li>
<p><strong>F</strong>: Clear the current attachements of the Status SIO port and attach it to default CPU ports</p>
</li>
<li>
<p><strong>G</strong>: List of CPU ports to which the Data SIO port is attached</p>
</li>
<li>
<p><strong>H</strong>: Clear the current attachements of the Data SIO port and attach it to default CPU ports</p>
</li>
<li>
<p><strong>I</strong>: When selected, clicking on <code>OK</code> button will save the settings and will be applied at next emuStudio start.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="connecting-devices">10.3. Connecting devices</h3>
<div class="paragraph">
<p>MITS 88-SIO board as emuStudio plug-in is a device which does nothing really useful. It just listens (and understands)
commands coming from CPU through the I/O ports. The command is either a request for reading or request for writing to
the attached device.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Theoretically any device which supports the basic I/O (reading/writing), can be attached to the board. More about
      plug-in internals can be found in programmer&#8217;s manual of emuStudio, which is not part of the user documentation.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Usually, attached devices were:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>serial terminal</p>
</li>
<li>
<p>line printer</p>
</li>
<li>
<p>paper tape reader/punch</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In current implementation of Altair 8800 emulator, the only suitable device which can be attached to the board is
terminal ADM-3A from Lear Siegler, Inc and which is described in its own section.</p>
</div>
</div>
<div class="sect2">
<h3 id="configuration-file-2">10.4. Configuration file</h3>
<div class="paragraph">
<p>Configuration file of virtual computers contain also settings of all the used plug-ins, including devices. Please
read the section "Accessing settings of plug-ins" in the user documentation of Main module to see how the settings can
be accessed.</p>
</div>
<div class="paragraph">
<p>The following table shows all the possible settings of MITS 88-SIO plug-in:</p>
</div>
<table class="tableblock frame-topbot grid-all spread table table-condensed">
<caption class="title">Table 6. Settings of MITS 88-SIO</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Valid values</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tfoot>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>dataPortNumberX</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt; 0 and &lt; 256; X range from 0 upwards</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X-th Number of Data Port</p></td>
</tr>
</tfoot>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>statusPortNumberX</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt; 0 and &lt; 256; X range from 0 upwards</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X-th Number of Status Port</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>As can be seen; the <code>X</code> represents a number, it&#8217;s a way how two SIO ports can be attached to multiple CPU ports.</p>
</div>
</div>
<div class="sect2">
<h3 id="SIO-88_PROGRAMMING">10.5. Programming</h3>
<div class="paragraph">
<p>In order to show something useful, let&#8217;s assume that a terminal LSI ADM-3A is attached to the board.
Remember, the board only mediates the communication, it does not interpret any of the sent/received characters.</p>
</div>
<div class="sect3">
<h4 id="cpu-ports-2">10.5.1. CPU Ports</h4>
<div class="paragraph">
<p>The whole communication between the board (and attached device) and CPU is controlled by programming the two ports:
Status port and Data port. The following table shows the ports and how they are used.</p>
</div>
<table class="tableblock frame-topbot grid-all spread table table-condensed">
<caption class="title">Table 7. Summary of CPU ports usage</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Port</th>
<th class="tableblock halign-left valign-top">Address</th>
<th class="tableblock halign-left valign-top">Input</th>
<th class="tableblock halign-left valign-top">Output</th>
</tr>
</thead>
<tfoot>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Write data</p></td>
</tr>
</tfoot>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read board status</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not used. Originally used for enabling/disabling interrupts.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Now, detailed description of the ports follow. Bits are ordered in a byte as follows:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>D7 D6 D5 D4 D3 D2 D1 D0</pre>
</div>
</div>
<div class="paragraph">
<p>where <code>D7</code> is the most significant bit, and <code>D0</code> the least significant bit.</p>
</div>
</div>
<div class="sect3">
<h4 id="port-1-control-port">10.5.2. Port 1 ("Control" port)</h4>
<div class="paragraph">
<p>Default addresses: 0x03, 0x10, 0x14, 0x16, 0x18 (preferred is 0x10)</p>
</div>
<div class="paragraph">
<p><strong>WRITE</strong>:</p>
</div>
<div class="paragraph">
<p>Controls input/output interrupts enable. If both interrupts are set to be enabled, it only empties transmitter buffer
in the device, which was a post-step after interrupts being enabled. However, the plug-in does not implement interrupts
support.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>D7 D6 D5 D4 D3 D2</code> : unused bits</p>
</li>
<li>
<p><code>D1 D0</code>             : Used for enabling/disabling interrupts. Not used in emuStudio.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>READ</strong>:</p>
</div>
<div class="paragraph">
<p>Read status of the device.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>D7</code> : <em>Output device ready</em>. Always 0 in the emulator.</p>
</li>
<li>
<p><code>D6</code> : Not used (always 0).</p>
</li>
<li>
<p><code>D5</code> : <em>Data available (for writing to the attached device)</em>. Always 0 in the emulator, meaning that no data is
pending to be written. Data are written immediately after <code>OUT</code> instruction.</p>
</li>
<li>
<p><code>D4</code> : <em>Data overflow</em>. Value 1 means a new word of data has been received before the previous word was inputted to
the accumulator. In emuStudio, this never happens.</p>
</li>
<li>
<p><code>D3</code> : <em>Framing error</em>. Value 1 means that data bit has no valid stop bit. In emuStudio, this never happens.</p>
</li>
<li>
<p><code>D2</code> : <em>Parity error</em>. Value 1 means that received parity does not agree with selected parity. In emuStudio, this
never happens.</p>
</li>
<li>
<p><code>D1</code> : <em>Transmitter buffer empty</em>. Value 1 means that the data word has been received from the attached device and it&#8217;s
available for reading (from the Data port).</p>
</li>
<li>
<p><code>D0</code> : <em>Input device ready</em>. Value 1 means that the CPU can write data to the SIO (that the board is ready). Always 1
in the emulator.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="port-2-data-port">10.5.3. Port 2 ("Data" port)</h4>
<div class="paragraph">
<p>Default addresses: 0x02, 0x11, 0x15, 0x17, 0x19 (preferred is 0x11)</p>
</div>
<div class="paragraph">
<p><strong>WRITE</strong>:</p>
</div>
<div class="paragraph">
<p>Write data to the attached device.</p>
</div>
<div class="paragraph">
<p><strong>READ</strong>:</p>
</div>
<div class="paragraph">
<p>Read data from the attached device.</p>
</div>
<div class="paragraph">
<p>If the attached device sends asynchronously multiple data, the emulated board stores all in a buffer (queue) with
unlimited capacity, so no data should be lost and can be read anytime.</p>
</div>
</div>
<div class="sect3">
<h4 id="program-example-2">10.5.4. Program example</h4>
<div class="paragraph">
<p>In this section it will be shown a small "How to" program terminal using 88-SIO ports.</p>
</div>
<div class="sect4">
<h5 id="print-a-character-on-screen">Print a character on screen</h5>
<div class="paragraph">
<p>In emuStudio, it is enough to write data to Port 2, e.g.:</p>
</div>
<div class="listingblock">
<div class="title">Example program for writing character on terminal</div>
<div class="content">
<pre>mvi a, 'H'
out 11h
mvi a, 'i'
out 11h</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="print-a-string-on-screen">Print a string on screen</h5>
<div class="paragraph">
<p>For writing strings, it is more practical to have a procedure.</p>
</div>
<div class="listingblock">
<div class="title">Example program for writing text on terminal</div>
<div class="content">
<pre>lxi h, text  ; load address of 'text' label to HL
call print   ; print text
hlt          ; halt CPU

text: db 'Hello, world!',0

; Procedure for printing text to terminal.
; Input: pair HL must contain the address of the ASCIIZ string
print:
    mov a, m  ; load character from HL
    inx h     ; increment HL
    cpi 0     ; is the character = 0?
    rz        ; yes; quit
    out 11h   ; otherwise; show it
    jmp print ; and repeat from the beginning</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="reading-character-from-keyboard">Reading character from keyboard</h5>
<div class="paragraph">
<p>For reading a character, it is required to read the Port 1 until the character is not ready.
Then we can read it from Port 2.</p>
</div>
<div class="listingblock">
<div class="title">Example procedure for reading a character from terminal</div>
<div class="content">
<pre>; Procedure will read a single character from terminal
; Input: none
; Output: register A will contain the character.
getchar:
    in 10h     ; read Port 1
    ani 1      ; is data ready ?
    jz getchar ; not; try again
    in 11h     ; yes; read it (into A register)
    ret</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="reading-text-from-keyboard">Reading text from keyboard</h5>
<div class="paragraph">
<p>Now follows an example, which will read a whole line of characters into memory starting at address in <code>DE</code> pair. The
procedure will interpret some control keys, like: backspace and ENTER keys.</p>
</div>
<div class="listingblock">
<div class="title">Example program for reading text from terminal</div>
<div class="content">
<pre>lxi h, text        ; load address of 'text' label to HL
xchg               ; DE &lt;-&gt; HL
call getline       ; read line from the keyboard into DE

lxi h, text        ; load 'text' address again
call print         ; print the text on screen

hlt                ; halt CPU

text: ds 30        ; here will be stored the read text

;Procedure for reading a text from keyboard.
;Input: DE = address, where the text should be put after reading
;       C  = is used internally
getline:
    mvi c, 0       ; register C will be used as a counter of
                   ; read characters
next_char:
    in 10h         ; read Port 1: status
    ani 1          ; is the char ready for reading?
    jz next_char   ; not; try again
    in 11h         ; yes; read it to A register

    ; now ENTER and Backspace will be interpreted
    cpi 13         ; ENTER?
    jz getline_ret ; yes; it means end of input
    cpi 8          ; Backspace ?
    jnz save_char  ; if not; store the character

    ; Backspace interpretation
    mov a, c       ; A &lt;- number of read characters
    cpi 0          ; are we at the beginning?
    jz next_char   ; yes; ignore the backspace

    dcx d          ; not; decrement DE
    dcr c          ; decrement count of read characters
    mvi a,8        ; "show" the backspace (terminal will
                   ; interpret this by moving the cursor
                   ; to the left by 1 char)
    out 11h
    mvi a, 32      ; "clear" the current character on screen
                   ; by a space character (ASCII code 32)
    out 11h

    mvi a,8        ; and move the cursor back again
    out 11h
    jmp next_char  ; jump to next char

save_char:         ; stores a character into memory at DE
    out 11h        ; show the character in A register
    stax d         ; store it at address DE
    inx d          ; increment DE
    inr c          ; increment number of read characters
    jmp next_char  ; jump to next char

getline_ret:       ; end of input
                   ; ENTER will be stored as CRLF
    mvi a,13       ; CR (Carriage Return)
    stax d         ; store the char
    inx d          ; increment DE
    mvi a, 10      ; LF (Line Feed)
    stax d         ; store the char
    inx d          ; increment DE
    mvi a, 0       ; char 0 (End-Of-Input)
    stax d         ; store the char
    ret            ; return</pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="terminal-code-adm3a-terminal-code">11. Terminal <code>adm3a-terminal</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Emulation of famous terminal from Lear Siegler, Inc. - ADM-3A. It had a nick name 'Dumb Terminal'. In the time (1974),
due to its cheapness and speed capabilities required in that time, it became de facto standard in the industry.
Often it was used in connection with MITS Altair 8800 computer, so the decision of which terminal to emulate was clear.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The maintenance manual can be downloaded at
      <a href="http://www.mirrorservice.org/sites/www.bitsavers.org/pdf/learSiegler/ADM3A_Maint.pdf">this link</a>, operator&#8217;s manual
      <a href="http://maben.homeip.net/static/s100/learSiegler/terminal/Lear%20Siegler%20ADM3A%20operators%20manual.pdf">here</a>.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="display">11.1. Display</h3>
<div class="paragraph">
<p>The terminal could display 128 ASCII characters (upper-case and lower-case letters, punctuation and numbers). The
original ADM-3 could display only 64 (only capital-letters and some other). For saving very expensive RAM the terminal
offered size 12 rows x 80 columns, with optional extension to 24 rows x 80 columns. The size used in the emulator is
hardcoded to 80 columns x 24 rows.</p>
</div>
<div class="paragraph">
<p>Besides, the emulator uses custom font colored green, with anti-aliasing support and double-buffering.</p>
</div>
</div>
<div class="sect2">
<h3 id="keyboard">11.2. Keyboard</h3>
<div class="paragraph">
<p>The terminal could generate always 128 ASCII characters (upper-case, lower-case, punctuation and numbers). Besides,
it could generate special control characters which had effect on the current cursor position and were not sent to
CPU.</p>
</div>
<div class="paragraph">
<p>The emulator allows to generate almost anything what your host keyboard can give. It is only up to font which characters
it can display. The font cannot display any special non-US characters used in various languages. Just classic ASCII.</p>
</div>
<div class="paragraph">
<p>Besides, the terminal can capture control codes (holding <code>CTRL</code> plus some key), and special control codes (<code>ESC + '='</code>
plus some key). The following subsection lists all possible control and special control key combinations.</p>
</div>
<div class="sect3">
<h4 id="ADM3A-CONTROL_CODES">11.2.1. Control codes</h4>
<div class="paragraph">
<p>The following table shows control codes (<code>CTRL</code> plus some key combinations). The table can be found in original manuals.
The emulator is following it.</p>
</div>
<table class="tableblock frame-topbot grid-all spread table table-striped table-condensed">
<caption class="title">Table 8. Control codes</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Code</th>
<th class="tableblock halign-left valign-top">ASCII mnemonic</th>
<th class="tableblock halign-left valign-top">Function in ADM-3A</th>
</tr>
</thead>
<tfoot>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CTRL+^</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Home cursor</p></td>
</tr>
</tfoot>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CTRL+@</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NUL</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CTRL+A</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SOH</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CTRL+B</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>STX</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CTRL+C</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ETX</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CTRL+D</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EOT</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CTRL+E</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ENQ</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Initiates ID message with automatic "Answer Back" option. <sup class="footnote" id="_footnote_control">[<a id="_footnoteref_7" class="footnote" href="#_footnote_7" title="View footnote.">7</a>]</sup></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CTRL+F</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ACK</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CTRL+G</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BEL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sounds audible beep in ADM-3A (not in emulator yet :( )</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CTRL+H</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Backspace</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CTRL+I</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HT</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CTRL+J</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LF</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Line feed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CTRL+K</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Upline</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CTRL+L</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FF</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Forward space</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CTRL+M</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CTRL+N</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SO</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unlock keyboard <sup class="footnoteref">[<a class="footnote" href="#_footnote_7" title="View footnote.">7</a>]</sup></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CTRL+O</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SI</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Lock keyboard <sup class="footnoteref">[<a class="footnote" href="#_footnote_7" title="View footnote.">7</a>]</sup></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CTRL+P</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>OLE</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CTRL+Q</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DCI</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CTRL+R</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DC2</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CTRL+S</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DC3</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CTRL+T</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DC4</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CTRL+U</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NAK</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CTRL+V</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SYN</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CTRL+W</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ETB</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CTRL+X</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CAN</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CTRL+Y</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EM</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CTRL+Z</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SUB</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Clear screen</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CTRL+[</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ESC</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Initiate load cursor</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CTRL+x</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FS</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CTRL+]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>GS</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="absolute-cursor-position-from-the-keyboard">11.2.2. Absolute cursor position from the keyboard</h4>
<div class="paragraph">
<p>The terminal also allowed to set the absolute cursor position, when in "Cursor control Mode". The ADM-3A emulator
does not have such mode, but <code>ESC+'=' X Y</code> combinations allows to set the cursor position. As you could see in
the <a href="#ADM3A-CONTROL_CODES">Control codes</a> section, pressing the <code>ESC</code> "Initiates load cursor" operation. If the user then presses <code>=</code> key, then
the terminal takes next 2 keystrokes, and translates them into <code>X</code> and <code>Y</code> coordinates for the new position of the
cursor. The following table shows the key-to-coordinate translation table.</p>
</div>
<table class="tableblock frame-topbot grid-all spread table table-striped table-condensed">
<caption class="title">Table 9. Translation of keystrokes to cursor coordinates</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Number</th>
</tr>
</thead>
<tfoot>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>o</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">79</p></td>
</tr>
</tfoot>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>' '</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>!</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>#</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>%</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>'</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>+</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">11</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>,</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">13</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>.</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">14</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">15</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">17</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">18</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">19</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>4</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">20</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">21</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>6</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">22</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>7</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">23</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>8</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">24</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>9</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">25</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">26</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">27</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">28</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>=</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">29</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">30</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>?</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">31</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>A</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">33</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>B</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">34</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>C</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">35</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>D</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">36</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>E</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">37</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>F</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">38</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>G</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">39</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>H</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">40</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>I</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">41</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>J</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">42</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>K</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">43</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>L</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">44</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>M</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">45</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>N</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">46</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>O</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">47</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>P</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">48</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Q</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">49</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>R</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">50</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>S</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">51</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>T</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">52</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>U</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">53</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>V</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">54</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>W</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">55</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>X</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">56</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Y</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">57</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Z</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">58</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">59</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>\</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">60</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">61</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>^</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">62</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">63</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>`</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>a</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">65</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>b</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">66</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>c</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">67</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>d</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">68</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>e</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">69</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>f</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">70</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>g</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">71</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>h</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">72</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>i</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">73</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>j</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">74</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>k</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">75</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>l</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">76</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>m</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">77</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>n</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">78</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="adm-3a-settings">11.3. ADM-3A Settings</h3>
<div class="paragraph">
<p>It is possible to configure the terminal either from GUI or manually modifying configuration settings. In the case
of manual file modification, emuStudio must be restarted (for more information, see section <a href="#ADM3A-CONFIG_FILE">Configuration file</a>).</p>
</div>
<div class="paragraph">
<p>The "settings" window <sup class="footnoteref">[<a class="footnote" href="#_footnote_3" title="View footnote.">3</a>]</sup> is
shown in the following image:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://vbmacher.github.io/emuStudio/docuser/mits_altair_8800/images//adm3a-settings.png" alt="Settings window of ADM-3A terminal">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>A</strong>: File for reading input (when redirected)</p>
</li>
<li>
<p><strong>B</strong>: File for writing output (when redirected)</p>
</li>
<li>
<p><strong>C</strong>: In automatic mode, how long the terminal should wait until it reads next input character from the file
(in milliseconds)</p>
</li>
<li>
<p><strong>D</strong>: Whether every keystroke will also cause to display it. Programs don&#8217;t always "echo" the characters back
to the screen.</p>
</li>
<li>
<p><strong>E</strong>: Whether terminal GUI should be always-on-top of other windows</p>
</li>
<li>
<p><strong>F</strong>: Whether the display should use anti-aliasing.</p>
</li>
<li>
<p><strong>G</strong>: Clears the screen.</p>
</li>
<li>
<p><strong>H</strong>: Rolls the screen down by 1 line</p>
</li>
<li>
<p><strong>I</strong>: If checked, then by pressing OK the settings will be saved to the configuration file. If not, they will be not
saved. In any case, the effect of the settings will be visible immediately.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The terminal behaves differently when emuStudio is run in automatic (no GUI) mode. In that moment, input is
      redirected to be read from a file, and also output is redirected to be written to another file. The file names are
      configurable in the computer config file. Using redirection in GUI mode is currently not possible.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="ADM3A-CONFIG_FILE">11.4. Configuration file</h3>
<div class="paragraph">
<p>Configuration file of virtual computers contain also settings of all the used plug-ins, including devices. Please
read the section "Accessing settings of plug-ins" in the user documentation of Main module to see how the settings can
be accessed.</p>
</div>
<div class="paragraph">
<p>The following table shows all the possible settings of ADM-3A plug-in:</p>
</div>
<table class="tableblock frame-topbot grid-all spread table table-striped table-condensed">
<caption class="title">Table 10. Settings of LSI ADM-3A</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Valid values</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tfoot>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>halfDuplex</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true / false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether every keystroke will also cause to display
                                                                    it.</p></td>
</tr>
</tfoot>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>inputFileName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>adm3A-terminal.in</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Path to existing file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">File for reading input (when redirected)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>outputFileName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>adm3A-terminal.out</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Path to existing file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">File for writing output (when redirected)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>inputReadDelay</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt; 0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">How long the terminal should wait
                                                                    until it reads next input character from the file
                                                                    (in milliseconds)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>alwaysOnTop</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true / false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether terminal GUI should be always-on-top of other
                                                                    windows</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>antiAliasing</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true / false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether the display should use anti-aliasing.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="virtual-device-code-simhpseudo-z80-code">12. Virtual device <code>simhPseudo-z80</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Virtual device partially reimplemented from <a href="http://simh.trailing-edge.com/">simh</a> emulator. This device is used
mainly for communication between CP/M 3 operating system for <code>simh</code> and emuStudio. Most of the original functionality
is not implemented, but it is crucial for support of memory bank-switching.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="original-software-for-altair8800">13. Original software for Altair8800</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Since Altair8800 virtual computer emulates a real machine, it&#8217;s possible to use real software written for the computer.
As was mentioned in <a href="#ALTAIR_FOR_EMUSTUDIO">Altair8800 for emuStudio</a> section, several operating systems and programs can be run on Altair.
There are many disk and memory images of those systems available online, but only some were tested and proved to work.
Some of the available online sites are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://schorn.ch/altair_4.php">Peter Schorn</a></p>
</li>
<li>
<p><a href="http://altairclone.com/support.htm">Altair clone</a></p>
</li>
<li>
<p><a href="http://www.classiccmp.org/cpmarchives/cpm/mirrors/www.schorn.ch/cpm/intro.php">SIMH</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In order to build custom disk images, please follow this link:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://www.autometer.de/unix4fun/z80pack/" class="bare">http://www.autometer.de/unix4fun/z80pack/</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Most of the disk images were borrowed from great <a href="http://simh.trailing-edge.com/">simh</a> emulator.
It&#8217;s obvious that some images were modified for simh. On the other hand, it&#8217;s not that obvious if the original images
would actually work at all.</p>
</div>
<div class="paragraph">
<p>Tested and fully-functional images were:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Operating system CP/M v2.2 and 3</p>
</li>
<li>
<p>Altair DOS v1.0</p>
</li>
<li>
<p>BASIC programming language in various versions</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Disk / memory images for software for Altair8800 are available on many online sites, such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://schorn.ch/altair.html" class="bare">http://schorn.ch/altair.html</a></p>
</li>
<li>
<p><a href="http://www.classiccmp.org/cpmarchives/cpm/mirrors/www.schorn.ch/cpm/intro.php" class="bare">http://www.classiccmp.org/cpmarchives/cpm/mirrors/www.schorn.ch/cpm/intro.php</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Some manuals can be found at e.g. <a href="http://altairclone.com/altair_manuals.htm" class="bare">http://altairclone.com/altair_manuals.htm</a>.</p>
</div>
<div class="paragraph">
<p>The following subsections describe in short how to boot some of those systems, along with screen-shots how it looks.</p>
</div>
<div class="sect2">
<h3 id="A8800-SOFTWARE-BOOT_ROM">13.1. Boot ROM</h3>
<div class="paragraph">
<p>Booting operating systems on Altair requires special ROM image to be <a href="#XASMEML">loaded in operating memory</a>
<sup class="footnote">[<a id="_footnoteref_8" class="footnote" href="#_footnote_8" title="View footnote.">8</a>]</sup>.</p>
</div>
<div class="paragraph">
<p>Originally, more boot ROMs existed. Different boot ROMs were used to load the code from different devices.
In current implementation of emuStudio, there is only one boot ROM supported - so called 'disk boot loader' (or DBL),
which loads operating system from MITS 88-DISK (through CPU ports).</p>
</div>
<div class="paragraph">
<p>The boot loader is already available in a file <code>boot.bin</code>. You can find it at the
<a href="http://emustudio.sourceforge.net/downloads.html">download page</a>.</p>
</div>
<div class="paragraph">
<p>The boot ROM must be loaded into memory at address <code>0xFF00</code> (hexadecimal). It is safe to jump to this address manually
when operating system image file is mounted.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
All subsequent sections assume that the boot loader has been loaded in the operating memory.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="cp-m-2-2">13.2. CP/M 2.2</h3>
<div class="paragraph">
<p>During Altair8800 computer era, many operating systems, applications and programming languages have been developed.
On of the most known operating systems is CP/M. It was written by Gary Kildall from Digital Research, Inc. At first
it was mono-tasking and single-user operating system which didn&#8217;t need more than 64kB of memory. Subsequent versions
added multi-user variants and they were ported to 16-bit processors.</p>
</div>
<div class="paragraph">
<p>The combination of CP/M and computers with S-100 bus <sup class="footnote">[<a id="_footnoteref_9" class="footnote" href="#_footnote_9" title="View footnote.">9</a>]</sup>
was big "industry standard", widely spread in 70&#8217;s up to 80&#8217;s years of twentieth century. The operating system took
the burden of programming abilities from user, and this was one of the reasons why the demand for hardware and software
was rapidly increased.</p>
</div>
<div class="paragraph">
<p>Tested image has name <code>altcpm.dsk</code>. It can be downloaded at <a href="http://schorn.ch/cpm/zip/altsw.zip">this link</a>.</p>
</div>
<div class="paragraph">
<p>In order to run CP/M, please follow these steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#DISK-88_MOUNTING_IMAGES">Mounting disk images</a> <code>altcpm.dsk</code> to drive <code>A:</code> in MITS 88-DISK.</p>
</li>
<li>
<p>In emuStudio jump to location <code>0xFF00</code> <sup class="footnote" id="_footnote_debugger">[<a id="_footnoteref_10" class="footnote" href="#_footnote_10" title="View footnote.">10</a>]</sup></p>
</li>
<li>
<p>Optionally, you can set CPU frequency to 2000 kHz, which was Intel 8080 original frequency.</p>
</li>
<li>
<p>Before starting emulation, show ADM-3A terminal <sup class="footnoteref">[<a class="footnote" href="#_footnote_3" title="View footnote.">3</a>]</sup></p>
</li>
<li>
<p>Run the emulation <sup class="footnoteref">[<a class="footnote" href="#_footnote_10" title="View footnote.">10</a>]</sup></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>After these steps were completed, CP/M should start (an informational message appears) and command line prompt will
be displayed:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://vbmacher.github.io/emuStudio/docuser/mits_altair_8800/images//cpm22.png" alt="Operating system CP/M 2.2">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Command <code>dir</code> is working, <code>ls</code> is better <code>dir</code>. More information about CP/M commands can be found at
      <a href="http://www.classiccmp.org/dunfield/r/cpm22.pdf">this link</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="cp-m-3">13.3. CP/M 3</h3>
<div class="paragraph">
<p>Steps for running CP/M 3 operating systems are not that different from CP/M 2. The disk image file is called
<code>cpm3.dsk</code> and can be downloaded at <a href="http://schorn.ch/cpm/zip/cpm3.zip">this link</a>. CP/M 3 came with two versions:
banked and non-banked. The image is the banked version of CP/M. Also, <code>simh</code> authors provided custom BIOS and custom
boot loader.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Manual of CP/M 3 can be found at <a href="http://www.cpm.z80.de/manuals/cpm3-usr.pdf">this link</a>. For more information
      about <code>simh</code> Altair8800 and CP/M 3, click <a href="http://simh.trailing-edge.com/pdf/altairz80_doc.pdf">here</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>There are some requirements for the computer architecture, a bit different for CP/M 2.2.</p>
</div>
<div class="sect3">
<h4 id="cpu">13.3.1. CPU</h4>
<div class="paragraph">
<p>It is recommended to use Z80 version of the computer as was presented in the section <a href="#ALTAIR_FOR_EMUSTUDIO">Altair8800 for emuStudio</a>.
CPU Intel 8080 will work for the operating system itself, but most provided applications require Z80.</p>
</div>
</div>
<div class="sect3">
<h4 id="operating-memory">13.3.2. Operating memory</h4>
<div class="paragraph">
<p>Also, the operating memory needs to be set for memory banks <sup class="footnote">[<a id="_footnoteref_11" class="footnote" href="#_footnote_11" title="View footnote.">11</a>]</sup>.
The following parameters were borrowed from <code>simh</code> and were tested:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>8 memory banks</p>
</li>
<li>
<p>common address <code>C000h</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="boot-rom">13.3.3. Boot ROM</h4>
<div class="paragraph">
<p>There exist specific version of boot loader (modified probably by <code>simh</code> authors) to load CP/M into banked memory.
It has name <code>mboot.bin</code> and you can find it at the <a href="http://emustudio.sourceforge.net/downloads.html">download page</a>.
Before other steps, please <a href="#XASMEML">load this image into operating memory</a> at address 0xFF00 (hexadecimal).</p>
</div>
</div>
<div class="sect3">
<h4 id="steps-for-booting-cp-m-3">13.3.4. Steps for booting CP/M 3</h4>
<div class="paragraph">
<p>Specific steps how to boot CP/M 3 in emuStudio follow:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#DISK-88_MOUNTING_IMAGES">Mounting disk images</a> <code>cpm3.dsk</code> to drive <code>A:</code> in MITS 88-DISK.</p>
</li>
<li>
<p>In emuStudio jump to location <code>0xFF00</code> <sup class="footnoteref">[<a class="footnote" href="#_footnote_10" title="View footnote.">10</a>]</sup></p>
</li>
<li>
<p>Optionally, you can set CPU frequency to 2500 kHz, which was Zilog Z80 original frequency.</p>
</li>
<li>
<p>Before starting emulation, show ADM-3A terminal <sup class="footnoteref">[<a class="footnote" href="#_footnote_3" title="View footnote.">3</a>]</sup></p>
</li>
<li>
<p>Run the emulation <sup class="footnoteref">[<a class="footnote" href="#_footnote_10" title="View footnote.">10</a>]</sup></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The following image shows the look right after the boot:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://vbmacher.github.io/emuStudio/docuser/mits_altair_8800/images//cpm3.png" alt="Operating system CP/M 3 (banked version)">
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="altair-dos-v1-0">13.4. Altair DOS v1.0</h3>
<div class="paragraph">
<p>Steps for booting Altair DOS v1.0 follow:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#DISK-88_MOUNTING_IMAGES">Mounting disk images</a> <code>altdos.dsk</code> to drive <code>A:</code> in MITS 88-DISK.</p>
</li>
<li>
<p>In emuStudio jump to location <code>0xFF00</code> <sup class="footnoteref">[<a class="footnote" href="#_footnote_10" title="View footnote.">10</a>]</sup></p>
</li>
<li>
<p>Optionally, you can set CPU frequency to 2000 kHz, which was Intel 8080 original frequency.</p>
</li>
<li>
<p>Before starting emulation, show ADM-3A terminal <sup class="footnoteref">[<a class="footnote" href="#_footnote_3" title="View footnote.">3</a>]</sup></p>
</li>
<li>
<p>Run the emulation <sup class="footnoteref">[<a class="footnote" href="#_footnote_10" title="View footnote.">10</a>]</sup></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The system will start asking some questions. According to the
 <a href="http://altairclone.com/downloads/manuals/Altair%20DOS%20User&#8217;s%20Manual.pdf">manual</a>, the answers for emuStudio are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>MEMORY SIZE?</code> &#8594; 64 or ENTER (if memory ROM is at 0xFFFF)</p>
</li>
<li>
<p><code>INTERRUPTS</code> &#8594; N or just ENTER</p>
</li>
<li>
<p><code>HIGHEST DISK NUMBER?</code> &#8594; 0 (if only 1 disk is mounted)</p>
</li>
<li>
<p><code>HOW MANY DISK FILES?</code> &#8594; 3</p>
</li>
<li>
<p><code>HOW MANY RANDOM FILES?</code> &#8594; 2</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The basic commands you can use are e.g. <code>MNT 0</code> - to mount the drive, and then <code>DIR 0</code> to list the files.</p>
</div>
<div class="paragraph">
<p>If you want AltairDOS being able to automatically detect how much memory is installed on system,
it is possible. The system does it by very nasty trick - testing if it can write to particular address
(ofcourse, maximum is 16-bits - i.e. 64K of memory). If the result is the same as it was before reading,
it means that it reached the "end of memory". But when it fails to detect the ROM, it fails to determine
the size, too, and the output will be <code>INSUFFICIENT MEMORY</code>.</p>
</div>
<div class="paragraph">
<p>The following image shows how it looks like:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://vbmacher.github.io/emuStudio/docuser/mits_altair_8800/images//altairdos.gif" alt="Operating system Altair DOS 1.0">
</div>
</div>
</div>
<div class="sect2">
<h3 id="basic">13.5. BASIC</h3>
<div class="paragraph">
<p>In this section will be presented how to boot MITS BASIC version 4.1. There is possible to boot also other versions,
but the principle is always the same.</p>
</div>
<div class="paragraph">
<p>As it is written in <code>simh</code> manual: MITS BASIC 4.1 was the commonly used software for serious users of the Altair
computer. It is a powerful (but slow) BASIC with some extended commands to allow it to access and manage the disk.
There was no operating system it ran under.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
After boot, you must mount the disk with <code>MOUNT 0</code>. Then, command <code>FILES</code> will show all files on the disk. In
      order to run a file, run command <code>RUN "file"</code>. Manual can be found at
      <a href="http://bitsavers.informatik.uni-stuttgart.de/pdf/mits/Altair_8800_BASIC_4.1_Reference_Jul77.pdf">this link</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>It is assumed you have either <code>boot.bin</code> or <code>mboot.bin</code> mounted in the operating memory (see <a href="#A8800-SOFTWARE-BOOT_ROM">Boot ROM</a>
for more details).</p>
</div>
<div class="paragraph">
<p>Steps for booting BASIC follow:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#DISK-88_MOUNTING_IMAGES">Mounting disk images</a> <code>mbasic.dsk</code> to drive <code>A:</code> in MITS 88-DISK.</p>
</li>
<li>
<p>In emuStudio jump to location <code>0xFF00</code> <sup class="footnoteref">[<a class="footnote" href="#_footnote_10" title="View footnote.">10</a>]</sup></p>
</li>
<li>
<p>Optionally, you can set CPU frequency to 2000 kHz, which was Intel 8080 original frequency.</p>
</li>
<li>
<p>Before starting emulation, show ADM-3A terminal <sup class="footnoteref">[<a class="footnote" href="#_footnote_3" title="View footnote.">3</a>]</sup></p>
</li>
<li>
<p>Run the emulation <sup class="footnoteref">[<a class="footnote" href="#_footnote_10" title="View footnote.">10</a>]</sup></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The following image shows the look right after the boot:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://vbmacher.github.io/emuStudio/docuser/mits_altair_8800/images//mbasic.png" alt="Altair 8800 Basic 4.1">
</div>
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnote_1">
<a href="#_footnoteref_1">1</a>. They were used for various bootloaders
</div>
<div class="footnote" id="_footnote_2">
<a href="#_footnoteref_2">2</a>. If it                                                                     ends with <code>.hex</code> suffix, it will be loaded                                                                     as Intel HEX format, otherwise as binary
</div>
<div class="footnote" id="_footnote_3">
<a href="#_footnoteref_3">3</a>. "peripheral devices" window in the Emulator panel in emuStudio
</div>
<div class="footnote" id="_footnote_4">
<a href="#_footnoteref_4">4</a>. Be cautious with the settings. Incorrect values can result in disk image file damage. Default values are used for classic Altair8800 image files used by simh
</div>
<div class="footnote" id="_footnote_5">
<a href="#_footnoteref_5">5</a>. According to manual the write sequence holds only for short time, maximally until the end of sector is reached. The plug-in does not limit the sequence period, it is deactivated only when the end of the sector is reached. In addition each first byte and the last byte of a sector should have set its MSB (7th bit) to 1. It was called the "sync bit" for easier identification of start or end of a sector. However, the plug-in does not require it.
</div>
<div class="footnote" id="_footnote_6">
<a href="#_footnoteref_6">6</a>. According to manual, the bit is set for maximum 30 microseconds. Programs could detect the bit set and quickly start writing data until the <em>Sector true</em> came back again. It could be made in time easily, because CPU was much faster than disk itself. Plug-in does not limit the period. The value is 0 practically all the time, until first byte is written.
</div>
<div class="footnote" id="_footnote_7">
<a href="#_footnoteref_7">7</a>. "In the original                        ADM-3A device, these codes were executable only from computer."
</div>
<div class="footnote" id="_footnote_8">
<a href="#_footnoteref_8">8</a>. The purpose of a boot ROM is to load specific block of data from a device and then run it as if it was code. The code block is often called 'boot loader'. It is very small program which just loads either the whole or part of the operating system into memory and then jumps to it.
</div>
<div class="footnote" id="_footnote_9">
<a href="#_footnoteref_9">9</a>. 8-bit computers sharing some similarities with Altair 8800
</div>
<div class="footnote" id="_footnote_10">
<a href="#_footnoteref_10">10</a>. See "Debugger toolbar" in the user documentation of Main module
</div>
<div class="footnote" id="_footnote_11">
<a href="#_footnoteref_11">11</a>. Please see section <a href="#XASMEMB">Bank switching</a>
</div>
</div>
            
        </div>
    </div>
</div>


    <footer class="site-footer">
        <div class="container">
            <nav class="navbar">
                <div class="container">
                    <ul class="nav navbar-nav">
                        <li><a href="https://github.com/vbmacher/emuStudio">GitHub</a></li>
                        <li><a href="https://sourceforge.net/p/emustudio/" rel="nofollow"><img alt="Download emuStudio" src="https://sourceforge.net/sflogo.php?type=10&group_id=340604"></a></li>
                        <li class="navbar-text">&copy; Copyright 2006-2017, Peter Jakubo</li>
                    </ul>
                </div>
            </nav>
        </div>
    </footer>

    </body>
</html>

