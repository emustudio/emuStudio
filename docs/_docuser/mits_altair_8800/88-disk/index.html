<!--
  ~ This file is part of emuStudio.
  ~
  ~ Copyright (C) 2006-2020  Peter Jakubčo
  ~
  ~ This program is free software: you can redistribute it and/or modify
  ~ it under the terms of the GNU General Public License as published by
  ~ the Free Software Foundation, either version 3 of the License, or
  ~ (at your option) any later version.
  ~
  ~ This program is distributed in the hope that it will be useful,
  ~ but WITHOUT ANY WARRANTY; without even the implied warranty of
  ~ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  ~ GNU General Public License for more details.
  ~
  ~ You should have received a copy of the GNU General Public License
  ~ along with this program.  If not, see <https://www.gnu.org/licenses/>.
  -->

<!DOCTYPE html>
<html lang="en">
<head>

    <!-- Meta -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <title>88 Disk &diams; emuStudio</title>
    <meta name="keywords"
          content="emulator-programming,emulation-platform,emulation-framework,altair8800,Z80,intel-8080,SSEM,RAM,RASP,random-access-machine,random-access-stored-program-machine">
    <meta name="description" content="Universal computer emulation platform and framework.">
    <meta name=”robots” content=”noindex,follow”>

    <meta property="og:title" content="88 Disk">
    <meta property="og:image" content="../../../img/logo-2.svg">
    <meta property="og:description" content="Universal computer emulation platform and framework.">

    <!-- RSS -->
    <link rel="alternate" type="application/rss+xml" title="emuStudio &diams; Computer emulation platform/framework"
          href="../../../feed.xml">
    <link rel="alternate" type="application/atom+xml" title="emuStudio &diams; Computer emulation platform/framework"
          href="../../../atom.xml">

    <!-- Favicons -->
    <link rel="shortcut icon" type="image/x-icon" href="../../../favicon.ico?">
    <meta name="application-name" content="emuStudio &diams; Computer emulation platform/framework">
    <meta name="msapplication-TileColor" content="#ffffff">

    <!-- Fonts -->
    <link rel="stylesheet"
          href="//fonts.googleapis.com/css?family=Roboto+Condensed:300,300italic,400,400italic,700,700italic|Oswald:300,400,700">

    <!-- Styles -->
    <link rel="stylesheet" href="../../../css/style.css">


    <!-- Scripts -->

    <!--[if lt IE 9]>
        <script src="../../../js/html5shiv.min.js"></script>
        <script src="../../../js/respond.min.js"></script>
    [endif]-->

    <script src="../../../js/jquery-3.1.1.min.js"></script>
    <script src="../../../js/bootstrap.min.js"
            integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
            crossorigin="anonymous">
    </script>


    <script async defer id="github-bjs" src="https://buttons.github.io/buttons.js"></script>


    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-3492956-5"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'UA-3492956-5');

    </script>

</head>


<body>


<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar"
                    aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/"><i><img alt="&diams;" style="margin: -5px;margin-right:2px;"
                                                     src="../../../img/logo-2.svg" width="30px"/></i>emuStudio</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
            <!--<form class="navbar-form navbar-left" role="search">-->
            <!--<div class="form-group">-->
            <!--<input type="text" class="form-control" placeholder="Search website">-->
            <!--</div>-->
            <!--<button type="submit" class="btn btn-default">Submit</button>-->
            <!--</form>-->
            <ul class="nav navbar-nav navbar-right">

                <li>
                    <a href="/">Home</a>
                </li>

                <li>
                    <a href="/download">Download</a>
                </li>

                <li>
                    <a href="/docs">Docs</a>
                </li>

                <li>
                    <a href="/devel">Developer</a>
                </li>

                <li>
                    <a href="/roadmap">Roadmap</a>
                </li>

                <li>
                    <a href="/about">About</a>
                </li>

            </ul>
        </div>
    </div>
</nav>


<div class="title-group">
    <h1 class="special" data-toc-skip>
      <span>
          
            88 Disk
          
      </span>
    </h1>


</div>


<div class="container">
    <div class="sect1">
        <h2 id="DISK-88">Disk controller <code>88-disk</code></h2>
        <div class="sectionbody">
            <div class="paragraph">
                <p>Altair Disk offered the advantage of fixed memory including relatively fast access to data. Data were
                    transferred with
                    speed 250 Kb/s (The plug-in does not emulate this). Disk was connected with disk controller (or
                    board), and the data
                    were transferred in serial fashion, bit after bit.</p>
            </div>
            <div class="paragraph">
                <p>Disk controller, on the other hand communicated with CPU. It transformed these serial data into 8-bit
                    words which were
                    stored/read by CPU into/from operating memory.</p>
            </div>
            <div class="paragraph">
                <p>MITS 88-DISK offered to connect up to 16 disk devices (one can be seen in the front image in the
                    Introduction section).</p>
            </div>
            <div class="admonitionblock note">
                <table>
                    <tr>
                        <td class="icon">
                            <i class="fa icon-note" title="Note"></i>
                        </td>
                        <td class="content">
                            Original manual can be downloaded at
                            <a href="http://www.virtualaltair.com/virtualaltair.com/PDF/88dsk%20manual%20v2.pdf">this
                                link</a>.
                        </td>
                    </tr>
                </table>
            </div>
            <div class="sect2">
                <h3 id="features">Features</h3>
                <div class="paragraph">
                    <p>The plug-in emulates basic functionality of the whole disk system for Altair 8800 computer. It is
                        not only disk
                        controller, but also the disk drive.</p>
                </div>
                <div class="paragraph">
                    <p>The features include:</p>
                </div>
                <div class="ulist">
                    <ul>
                        <li>
                            <p>allows to mount up to 16 disk images</p>
                        </li>
                        <li>
                            <p>CPU ports can be set manually</p>
                        </li>
                        <li>
                            <p>interrupts are not implemented</p>
                        </li>
                        <li>
                            <p>images can be saved for automatic mount at startup</p>
                        </li>
                        <li>
                            <p>GUI</p>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="sect2">
                <h3 id="DISK-88_MOUNTING_IMAGES">Mounting disk images</h3>
                <div class="paragraph">
                    <p>In order to mount DISK images to the device, please go to the Settings window <sup
                            class="footnote" id="_footnote_peripheral">[<a id="_footnoteref_1" class="footnote"
                                                                           href="#_footnote_1"
                                                                           title="View footnote.">1</a>]</sup>:</p>
                </div>
                <div class="imageblock">
                    <div class="content">
                        <img src="/docuser/mits_altair_8800/images//88-disk-01.png" alt="Settings window of 88-DISK">
                    </div>
                </div>
                <div class="ulist">
                    <ul>
                        <li>
                            <p><strong>A</strong>: Select drive (A - P)</p>
                        </li>
                        <li>
                            <p><strong>B</strong>: Choosing the image file</p>
                        </li>
                        <li>
                            <p><strong>C</strong>: Set sectors count and sector length for the current drive <sup
                                    class="footnote">[<a id="_footnoteref_2" class="footnote" href="#_footnote_2"
                                                         title="View footnote.">2</a>]</sup>.</p>
                        </li>
                        <li>
                            <p><strong>D</strong>: Set default values for sector count and sector length for the current
                                drive.</p>
                        </li>
                        <li>
                            <p><strong>E</strong>: Mount/unmount the image file onto/from the selected drive.
                                Mount operation: If there is any disk mounted already, the new image will be re-mounted.
                            </p>
                        </li>
                        <li>
                            <p><strong>F</strong>: Check box for saving the settings into the computer configuration
                                file. If checked, the settings will be
                                loaded after start.</p>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="sect2">
                <h3 id="cpu-ports-settings">CPU Ports settings</h3>
                <div class="paragraph">
                    <p>MITS 88-DISK board communicates with CPU using its ports. There are three ports overall, each for
                        different function.
                        For more information, see section <a href="#DISK-88_PROGRAMMING">Programming</a>. By default,
                        the ports used by 88-DISK are:</p>
                </div>
                <div class="ulist">
                    <ul>
                        <li>
                            <p>port 1: 0x08</p>
                        </li>
                        <li>
                            <p>port 2: 0x09</p>
                        </li>
                        <li>
                            <p>port 3: 0x0A</p>
                        </li>
                    </ul>
                </div>
                <div class="paragraph">
                    <p>These numbers can be changed in the Settings window, tab "CPU Ports":</p>
                </div>
                <div class="imageblock">
                    <div class="content">
                        <img src="/docuser/mits_altair_8800/images//88-disk-02.png" alt="Setting CPU ports">
                    </div>
                </div>
            </div>
            <div class="sect2">
                <h3 id="configuration-file">Configuration file</h3>
                <div class="paragraph">
                    <p>Configuration file of virtual computers contain also settings of all the used plug-ins, including
                        devices. Please
                        read the section "Accessing settings of plug-ins" in the user documentation of Main module to
                        see how the settings can
                        be accessed.</p>
                </div>
                <div class="paragraph">
                    <p>The following table shows all the possible settings of MITS 88-DISK plug-in:</p>
                </div>
                <table class="tableblock frame-topbot grid-all spread table table-striped table-condensed">
                    <caption class="title">Table 1. Settings of MITS 88-DISK</caption>
                    <colgroup>
                        <col style="width: 25%;">
                        <col style="width: 25%;">
                        <col style="width: 25%;">
                        <col style="width: 25%;">
                    </colgroup>
                    <thead>
                    <tr>
                        <th class="tableblock halign-left valign-top">Name</th>
                        <th class="tableblock halign-left valign-top">Default value</th>
                        <th class="tableblock halign-left valign-top">Valid values</th>
                        <th class="tableblock halign-left valign-top">Description</th>
                    </tr>
                    </thead>
                    <tfoot>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock"><code>image15</code></p>
                        </td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Path to existing file</p>
                        </td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">File name to mount on disk P
                            (15)</p></td>
                    </tr>
                    </tfoot>
                    <tbody>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock"><code>port1CPU</code></p>
                        </td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">0x08</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">&gt; 0 and &lt; 256</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Number of Port 1</p></td>
                    </tr>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock"><code>port2CPU</code></p>
                        </td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">0x09</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">&gt; 0 and &lt; 256</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Number of Port 2</p></td>
                    </tr>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock"><code>port3CPU</code></p>
                        </td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">0x0A</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">&gt; 0 and &lt; 256</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Number of Port 3</p></td>
                    </tr>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock"><code>sectorsPerTrack</code>
                        </p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">&gt; 0</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Count of sectors in a disk
                            image</p></td>
                    </tr>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock"><code>sectorLength</code>
                        </p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">137</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">&gt; 0</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Size of one sector in
                            bytes</p></td>
                    </tr>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock"><code>image0</code></p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Path to existing file</p>
                        </td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">File name to mount on disk A
                            (0)</p></td>
                    </tr>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
                    </tr>
                    </tbody>
                </table>
            </div>
            <div class="sect2">
                <h3 id="DISK-88_PROGRAMMING">Programming</h3>
                <div class="paragraph">
                    <p>Data are written onto or read from disk in a serial fashion. The position in the floppy disk is
                        uniquely set by the
                        track number, sector number and the offset in the sector. It is rudimentary to know how many
                        tracks are available,
                        so as how many sectors per track and the sector size.</p>
                </div>
                <div class="paragraph">
                    <p>In Altair8800, drive <code>Pertec FD400</code> used 8" diskettes. Each had 77 tracks. The track
                        had 32 sectors with 137 bytes long.
                        The capacity was therefore <code>77 * 32 * 137 = 337568 B = 330 kB</code>. Software used less
                        capacity, because 9 bytes from
                        each sector were used for the integrity checksum.</p>
                </div>
                <div class="sect3">
                    <h4 id="setting-the-position">Setting the position</h4>
                    <div class="paragraph">
                        <p>Track number and sector number can be set only incrementally, not directly. Setting the
                            offset within the sector is
                            more challenging.</p>
                    </div>
                    <div class="paragraph">
                        <p>After track and sector were set, programmer must "poll" the status port which tells him when
                            the
                            disk position is set to the beginning of the sector. Then, programmer must read data until
                            he gets to the position
                            where he wanted.</p>
                    </div>
                </div>
                <div class="sect3">
                    <h4 id="cpu-ports">CPU Ports</h4>
                    <div class="paragraph">
                        <p>The controller communicates with CPU using three I/O ports at addresses (by default) 0x08,
                            0x09 and 0x0A. The following
                            table shows the CPU ports and how they are used.</p>
                    </div>
                    <table class="tableblock frame-topbot grid-all spread table table-condensed">
                        <caption class="title">Table 2. Summary of CPU ports usage</caption>
                        <colgroup>
                            <col style="width: 25%;">
                            <col style="width: 25%;">
                            <col style="width: 25%;">
                            <col style="width: 25%;">
                        </colgroup>
                        <thead>
                        <tr>
                            <th class="tableblock halign-left valign-top">Port</th>
                            <th class="tableblock halign-left valign-top">Address</th>
                            <th class="tableblock halign-left valign-top">Input</th>
                            <th class="tableblock halign-left valign-top">Output</th>
                        </tr>
                        </thead>
                        <tfoot>
                        <tr>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">0x0A</p></td>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">Read data</p></td>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">Write data</p></td>
                        </tr>
                        </tfoot>
                        <tbody>
                        <tr>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">0x08</p></td>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">Disk and controller
                                status</p></td>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">Select disk</p></td>
                        </tr>
                        <tr>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">0x09</p></td>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">Get number of sector</p>
                            </td>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">Disk settings</p></td>
                        </tr>
                        </tbody>
                    </table>
                    <div class="paragraph">
                        <p>Now, detailed description of the ports follow. Bits are ordered in a byte as follows:</p>
                    </div>
                    <div class="literalblock">
                        <div class="content">
                            <pre>D7 D6 D5 D4 D3 D2 D1 D0</pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>where <code>D7</code> is the most significant bit, and <code>D0</code> the least significant
                            bit.</p>
                    </div>
                    <div class="sect4">
                        <h5 id="port-1-default-address-0x08">Port 1 (default address: 0x08)</h5>
                        <div class="paragraph">
                            <p><strong>WRITE</strong>:</p>
                        </div>
                        <div class="paragraph">
                            <p>Selects and enables one of 16 disk devices. By selecting a drive, all further operations
                                will be performed on that drive. If the disk has not mounted any disk image, all further
                                operations will be ignored.
                                The previously selected device will be disabled.</p>
                        </div>
                        <div class="ulist">
                            <ul>
                                <li>
                                    <p><code>D7</code> : if the value is 1, disable the drive. If the value is 0, select
                                        and enable the drive.</p>
                                </li>
                                <li>
                                    <p><code>D6 D5 D4</code> : unused bits</p>
                                </li>
                                <li>
                                    <p><code>D3 D2 D1 D0</code>: index of the drive to be selected. From 0-15.</p>
                                </li>
                            </ul>
                        </div>
                        <div class="paragraph">
                            <p><strong>READ</strong>:</p>
                        </div>
                        <div class="paragraph">
                            <p>Read disk status of the selected drive.</p>
                        </div>
                        <div class="ulist">
                            <ul>
                                <li>
                                    <p><code>D7</code> : <em>New read data available</em>. Indicates if there is at
                                        least 1 byte available for reading from Port 3 (value=0).
                                        It will be reset after data are read (value=1). If the value is 1, data read
                                        from Port 3 will be invalid or
                                        no new data is available.</p>
                                </li>
                                <li>
                                    <p><code>D6</code> : <em>Track 0</em>. Indicates if the head is positioned at track
                                        0 (value=0).</p>
                                </li>
                                <li>
                                    <p><code>D5</code> : <em>Interrupt Enabled</em>. Indicates if interrupts are used
                                        (value=0). The plug-in does not support interrupts,
                                        therefore the value will be always 1.</p>
                                </li>
                                <li>
                                    <p><code>D4 D3</code> : Unused bits; they are always 0.</p>
                                </li>
                                <li>
                                    <p><code>D2</code> : <em>Head Status</em>. Indicates the correctness of the head
                                        setting. If the value is 0, reading sector number from Port 2
                                        will be valid.</p>
                                </li>
                                <li>
                                    <p><code>D1</code> : <em>Move head</em>. Indicates if the movement of the disk head
                                        is allowed. If the value is 1, all track number changes
                                        will be ignored.</p>
                                </li>
                                <li>
                                    <p><code>D0</code> : <em>Enter new write data</em>. Indicates if the device is ready
                                        for writing data. If the value is 1, all written
                                        data will be ignored.</p>
                                </li>
                            </ul>
                        </div>
                        <div class="paragraph">
                            <p>Initial values of the bits are: <code>11100111</code>.</p>
                        </div>
                    </div>
                    <div class="sect4">
                        <h5 id="port-2-default-address-0x09">Port 2 (default address: 0x09)</h5>
                        <div class="paragraph">
                            <p><strong>WRITE</strong>:</p>
                        </div>
                        <div class="paragraph">
                            <p>Control the disk head, and other settings if a disk drive is selected.</p>
                        </div>
                        <div class="ulist">
                            <ul>
                                <li>
                                    <p><code>D7</code> : <em>Write Enable</em>. Initializes write sequence (enables
                                        writing to the disk; value=1). The plug-in sets the sector
                                        number to 0 and also value 0 to bit <code>D0</code> of Port 1 (<em>Enter new
                                            write data</em>) <sup class="footnote">[<a id="_footnoteref_3"
                                                                                       class="footnote"
                                                                                       href="#_footnote_3"
                                                                                       title="View footnote.">3</a>]</sup>.
                                    </p>
                                </li>
                                <li>
                                    <p><code>D6</code> : <em>Head Current Switch</em>. On real disks the bit should be
                                        set to 1 when a program is writting data to tracks
                                        from 43-76. The plug-in the bit is ignored.</p>
                                </li>
                                <li>
                                    <p><code>D5</code> : <em>Interrupt Disable</em>. Setting is ignored sicne plug-in
                                        does not support interrupts.</p>
                                </li>
                                <li>
                                    <p><code>D4</code> : <em>Interrupt Enable</em>. Setting is ignored sicne plug-in
                                        does not support interrupts.</p>
                                </li>
                                <li>
                                    <p><code>D3</code> : <em>Head unload</em>. Removes head from the disk surface.
                                        Reading sector number will now become invalid. In addition,
                                        value of bit <code>D7</code> from Port 1 (<em>New read data available</em>)
                                        become 1 (no new data).</p>
                                </li>
                                <li>
                                    <p><code>D2</code> : <em>Head load</em>. Sets the disk head onto disk surface.
                                        Reading sector number now becomes valid. If additionally
                                        the bit <code>D7</code> from Port 1 (<em>New data available</em>) is set, it is
                                        possible to read data from the disk.</p>
                                </li>
                                <li>
                                    <p><code>D1</code> : <em>Step Out</em>. Move the disk head back by 1 track (the
                                        track number is decremented). It is required to check
                                        bit <code>D1</code> of Port 1 (<em>Move head</em>) to have value 0.</p>
                                </li>
                                <li>
                                    <p><code>D0</code> : <em>Step In</em>. Move the disk head ahead by 1 track (the
                                        track number is incremented). It is required to check
                                        bit <code>D1</code> of Port 1 (<em>Move head</em>) to have value 0.</p>
                                </li>
                            </ul>
                        </div>
                        <div class="paragraph">
                            <p><strong>READ</strong>:</p>
                        </div>
                        <div class="paragraph">
                            <p>Reads the number of the sector. The value can be read only if a disk drive is selected
                                and the disk head is positioned
                                at the disk surface (by setting the bit <code>D2</code>).</p>
                        </div>
                        <div class="ulist">
                            <ul>
                                <li>
                                    <p><code>D7 D6</code> : Unused bits; they are always 1.</p>
                                </li>
                                <li>
                                    <p><code>D5 D4 D3 D2 D1</code>: Number of the sector, counted from 0.</p>
                                </li>
                                <li>
                                    <p><code>D0</code> : <em>Sector True</em>. If the value is 0, the offset in sector
                                        is 0 <sup class="footnote">[<a id="_footnoteref_4" class="footnote"
                                                                       href="#_footnote_4" title="View footnote.">4</a>]</sup>.
                                    </p>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="sect4">
                        <h5 id="port-3-default-address-0x0a">Port 3 (default address: 0x0A)</h5>
                        <div class="paragraph">
                            <p><strong>WRITE</strong>:</p>
                        </div>
                        <div class="paragraph">
                            <p>Write a byte to disk. In order to perform valid write, the <em>Write Enable</em>
                                <code>D7</code> bit of Port 2 must be set to 1. Before data
                                are written to disk, it is required to check bit <code>D0</code> from Port 1 (<em>Enter
                                    new write data</em>).</p>
                        </div>
                        <div class="paragraph">
                            <p><strong>READ</strong>:</p>
                        </div>
                        <div class="paragraph">
                            <p>Read a byte from disk. In order to perform valid read, the <em>Head load</em>
                                <code>D2</code> bit of Port 2 must be set to 1. Only if bit
                                <code>D7</code> from Port 1 (<em>New read data available</em>) is set to 0, the read
                                data are valid.</p>
                        </div>
                    </div>
                </div>
                <div class="sect3">
                    <h4 id="program-example">Program example</h4>
                    <div class="paragraph">
                        <p>In this section, an example is presented showing how to read/write data from/to the floppy
                            disk. At first, it writes
                            one byte (letter <code>A</code> with ASCII value 65) to track 1, sector 18 and offset 20.
                            Then, it reads the byte to operating
                            memory at address 0x200.</p>
                    </div>
                    <div class="paragraph">
                        <p>The program uses 3 procedures (in assembler for Intel 8080) for setting the disk position
                            (<code>ltrack</code> for loading the
                            track number, <code>lsector</code> for loading the sector number, and <code>loffset</code>
                            for loading the offset within the sector) and two
                            more for data reading (<code>read</code>) and writing (<code>write</code>).</p>
                    </div>
                    <div class="listingblock">
                        <div class="title">Example program for writing/reading using MITS 88-DISK</div>
                        <div class="content">
<pre>disk0  equ 0    ; disk number
track  equ 1    ; track number
sector equ 18   ; sector number
offset equ 20   ; offset within the sector
data   equ 'A'  ; data for writing

dcx sp          ; set stack register to 0xFFFF

mvi a, disk0    ; select disk
out 08h

call ltrack     ; set track number

call we         ; set 'write enable' sequence
call lsector    ; set sector number
call loffset    ; set sector offset
call write      ; write data

call lsector    ; set sector number (for clearing the offset)
call loffset    ; set sector offset
call read       ; read data

lxi h, readdata ; load address for reading the data
mov m, a        ; move the data there

hlt             ; end

ltrack0:        ; the procedure will set track number to 0
in 08h          ; read disk status
ani 1000000b    ; track 0 ?
rz              ; yes, return
mvi a, 1000b    ; head unload
out 09h
call movetrk    ; wait until the disk head can be moved
mvi a, 10b      ; step out, decrement track number
out 08h
jmp ltrack0

ltrack:         ; procedure sets a track number
call ltrack0    ; at first, set track number to 0
mvi b, track+1  ; b = track + 1
stepin:         ; stepin: {
dcr b           ;   b--;
rz              ;   if (b == 0) return;
call movetrk    ;   wait until the disk head can be moved
mvi a, 1        ;   step in, increment track number
out 09h
jmp stepin      ;   goto stepin;
                ; }

movetrk:        ; procedure waits until the disk head can be moved
in 08h          ; read disk status
ani 10b         ; can the disk head be moved?
jnz movetrk     ; nope, try again...
ret             ; yes, return

lsector:        ; procedure sets a sector number
mvi a, 100b     ; head load
out 09h
waits:
in 09h          ; read sector number
ani 3Fh         ; clear unused bits
rrc
cpi sector      ; is the number what is requested?
jnz waits       ; nope, try again
ret             ; yes, return

loffset:        ; procedure sets a sector offset
mvi b, offset+1 ; b = offset + 1
stepoff:        ; stepoff: {
dcr b           ;   b--;
rz              ;   if (b == 0) return;
call read       ;   read data; the offset is incremented
jmp stepoff     ;   goto stepoff;
                ; }

read:           ; procedure reads data from the disk
in 08h          ; read disk status
ani 100b        ; check if the disk head is loaded on the disk surface
rnz             ; if not, return
waitr:
in 08h          ; read disk status
ani 10000000b   ; New read data available ?
jnz waitr       ; nope, try again...
in 0Ah          ; yes, read data
ret             ; return

we:             ; procedure enables 'write enable' sequence
mvi a, 10000000b ; write enable
out 09h
ret

write:          ; procedure writes data to the disk
in 08h          ; read disk status
ani 100b        ; check if the disk head is loaded on the disk surface
rnz             ; if not, return
waitw:
in 08h          ; read disk status
ani 1           ; enter new write data ?
jnz waitw       ; nope, try again...
mvi a, data     ; yes, write data
out 0Ah
ret

org 200h
readdata: db 0</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="footnotes">
        <hr>
        <div class="footnote" id="_footnote_1">
            <a href="#_footnoteref_1">1</a>. "peripheral devices" window in the Emulator panel in emuStudio
        </div>
        <div class="footnote" id="_footnote_2">
            <a href="#_footnoteref_2">2</a>. Be cautious with the settings. Incorrect values can result in disk image
            file damage. Default values are used for classic Altair8800 image files used by simh
        </div>
        <div class="footnote" id="_footnote_3">
            <a href="#_footnoteref_3">3</a>. According to manual the write sequence holds only for short time, maximally
            until the end of sector is reached. The plug-in does not limit the sequence period, it is deactivated only
            when the end of the sector is reached. In addition each first byte and the last byte of a sector should have
            set its MSB (7th bit) to 1. It was called the "sync bit" for easier identification of start or end of a
            sector. However, the plug-in does not require it.
        </div>
        <div class="footnote" id="_footnote_4">
            <a href="#_footnoteref_4">4</a>. According to manual, the bit is set for maximum 30 microseconds. Programs
            could detect the bit set and quickly start writing data until the <em>Sector true</em> came back again. It
            could be made in time easily, because CPU was much faster than disk itself. Plug-in does not limit the
            period. The value is 0 practically all the time, until first byte is written.
        </div>
    </div>
</div>


<footer class="site-footer">
    <div class="container">
        <nav class="navbar">
            <div class="container">
                <ul class="nav navbar-nav">
                    <li><a href="https://github.com/vbmacher/emuStudio">GitHub</a></li>
                    <li><a href="https://sourceforge.net/p/net.emustudio/" rel="nofollow"><img alt="Download emuStudio"
                                                                                           src="https://sourceforge.net/sflogo.php?type=10&group_id=340604"></a>
                    </li>
                    <li class="navbar-text">&copy; Copyright 2006-2018, Peter Jakubčo</li>
                </ul>
            </div>
        </nav>
    </div>
</footer>

</body>
</html>

