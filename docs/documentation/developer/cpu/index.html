<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Writing a CPU - Developer documentation for emuStudio</title> <link rel="shortcut icon" href="/documentation/developer/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/documentation/developer/assets/css/just-the-docs.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-3492956-5"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', "UA-3492956-5"); </script> <script type="text/javascript" src="/documentation/developer/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/documentation/developer/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>Writing a CPU | Developer documentation for emuStudio</title> <meta name="generator" content="Jekyll v3.8.7" /> <meta property="og:title" content="Writing a CPU" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Developer documentation for emuStudio. emuStudio is universal emulation platform and framework targeting mainly academic sphere." /> <meta property="og:description" content="Developer documentation for emuStudio. emuStudio is universal emulation platform and framework targeting mainly academic sphere." /> <link rel="canonical" href="/documentation/developer/cpu/" /> <meta property="og:url" content="/documentation/developer/cpu/" /> <meta property="og:site_name" content="Developer documentation for emuStudio" /> <script type="application/ld+json"> {"description":"Developer documentation for emuStudio. emuStudio is universal emulation platform and framework targeting mainly academic sphere.","headline":"Writing a CPU","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/documentation/developer/assets/logo-1.svg"}},"@type":"WebPage","url":"/documentation/developer/cpu/","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="link" viewBox="0 0 16 16"> <title>Link</title> <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path> </symbol> </svg> <div class="page-wrap"> <div class="side-bar"> <div class="site-header"> <a href="/documentation/developer" class="site-title lh-tight"> <div class="site-logo"></div> </a> <button class="menu-button fs-3 js-main-nav-trigger" data-text-toggle="Hide" type="button">Menu</button> </div> <div class="navigation main-nav js-main-nav"> <nav role="navigation" aria-label="Main navigation"> <ul class="navigation-list"><li class="navigation-list-item active"><a href="/documentation/developer/404.html" class="navigation-list-link"></a></li><li class="navigation-list-item active"><a href="/documentation/developer/" class="navigation-list-link"></a></li><li class="navigation-list-item"><a href="/documentation/developer/introduction/" class="navigation-list-link">Introduction</a></li><li class="navigation-list-item"><a href="/documentation/developer/getting_started/" class="navigation-list-link">Getting started</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="/documentation/developer/getting_started/contributing" class="navigation-list-link">How to contribute</a></li><li class="navigation-list-item "><a href="/documentation/developer/getting_started/gitflow" class="navigation-list-link">Git workflow</a></li><li class="navigation-list-item "><a href="/documentation/developer/getting_started/documenting" class="navigation-list-link">Documenting</a></li></ul></li><li class="navigation-list-item"><a href="/documentation/developer/plugin_basics/" class="navigation-list-link">Plugin basics</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="/documentation/developer/plugin_basics/loading" class="navigation-list-link">Loading and initialization</a></li><li class="navigation-list-item "><a href="/documentation/developer/plugin_basics/context" class="navigation-list-link">Plugin contexts</a></li></ul></li><li class="navigation-list-item"><a href="/documentation/developer/compiler/" class="navigation-list-link">Writing a compiler</a></li><li class="navigation-list-item active"><a href="/documentation/developer/cpu/" class="navigation-list-link active">Writing a CPU</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="/documentation/developer/cpu/rootclass" class="navigation-list-link">Plugin Root</a></li><li class="navigation-list-item "><a href="/documentation/developer/cpu/runstate" class="navigation-list-link">Run states</a></li><li class="navigation-list-item "><a href="/documentation/developer/cpu/engine" class="navigation-list-link">Emulator engine</a></li><li class="navigation-list-item "><a href="/documentation/developer/cpu/disassembler" class="navigation-list-link">Disassembler</a></li></ul></li><li class="navigation-list-item"><a href="/documentation/developer/memory/" class="navigation-list-link">Writing a memory</a></li><li class="navigation-list-item"><a href="/documentation/developer/device/" class="navigation-list-link">Writing a device</a></li></ul> </nav> </div> <footer class="site-footer"> <p class="text-small text-grey-dk-000 mb-4">This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</p> </footer> </div> <div class="main-content-wrap js-main-content" tabindex="0"> <div class="main-content"> <div class="page-header js-page-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" class="js-search-input search-input" tabindex="0" placeholder="Search Developer documentation for emuStudio" aria-label="Search Developer documentation for emuStudio" autocomplete="off"> <svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" class="search-icon"><title>Search</title><g fill-rule="nonzero"><path d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z"/><path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z"/></g></svg> </div> <div class="js-search-results search-results-wrap"></div> </div> <ul class="list-style-none text-small aux-nav"> <li class="d-inline-block my-0"><a href="/">Back to website</a></li> </ul> </div> <div class="page"> <div id="main-content" class="page-content" role="main"> <h1 id="writing-a-cpu"> <a href="#writing-a-cpu" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Writing a CPU </h1> <p>CPU plugins in emuStudio are not just plain emulators. They must cooperate with emuStudio and provide capabilities allowing debugging and some interaction.</p> <p>A CPU plugin must implement:</p> <dl> <dt>Emulation “engine”</dt> <dd>It is the CPU emulator itself, and it should be implemented using some emulation technique. In Java there are not many options, so usually either interpretation or threaded dispatch are used, both described e.g. <a href="http://cse.unl.edu/~witty/class/embedded/material/note/emulation.pdf" target="_blank">here</a> or <a href="http://www.xsim.com/papers/Bario.2001.emubook.pdf" target="_blank">here</a>.</dd> <dt>Disassembler</dt> <dd>It will be used by emuStudio for creating the list of instructions in the debugger panel.</dd> <dt>Java Swing GUI panel</dt> <dd>It should implement the visualization of CPU registers, possibly current frequency and CPU run state.</dd> </dl> <p>Both disassembler and GUI panel should be instantiated just once. It is good practice to instantiate disassembler during plugin <a href="/documentation/developer/plugin_basics/loading.html#plugin-instantiation">instantiation</a> or <a href="/documentation/developer/plugin_basics/loading.html#plugin-initialization">initialization</a>, and GUI in the <a href="/documentation/developer/emulib_javadoc/net/emustudio/emulib/plugins/cpu/CPU.html#getStatusPanel()" target="_blank">CPU.getStatusPanel()</a> method call. emuStudio application will call the method just once from Swing <a href="https://docs.oracle.com/javase/tutorial/uiswing/concurrency/dispatch.html" target="_blank">Event dispatch thread</a>.</p> <p>Programming a disassembler might be tedious and error-prone. Therefore we encourage to use a tool which can generate the disassembler from a specification file. The tool is called <a href="https://github.com/emustudio/edigen" target="_blank">Edigen</a>, an abbreviation for <em>Emulator DIsassembler GENerator</em>. It can be nicely incorporated into Gradle build using <a href="https://github.com/emustudio/edigen-gradle-plugin" target="_blank">edigen-gradle-plugin</a>.</p> <hr> <h2 class="text-delta">Table of contents</h2> <ul> <li> <a href="/documentation/developer/cpu/rootclass">Plugin Root</a> </li> <li> <a href="/documentation/developer/cpu/runstate">Run states</a> </li> <li> <a href="/documentation/developer/cpu/engine">Emulator engine</a> </li> <li> <a href="/documentation/developer/cpu/disassembler">Disassembler</a> </li> </ul> </div> </div> </div> </div> </body> </html>
