<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Writing a memory - Emulator programming tutorial for emuStudio 0.39</title> <link rel="shortcut icon" href="/documentation/developer/0.39/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/documentation/developer/0.39/assets/css/just-the-docs.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-3492956-5"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', "UA-3492956-5"); </script> <script type="text/javascript" src="/documentation/developer/0.39/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/documentation/developer/0.39/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>Writing a memory | Emulator programming tutorial for emuStudio 0.39</title> <meta name="generator" content="Jekyll v3.8.5" /> <meta property="og:title" content="Writing a memory" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Emulator programming tutorial for emuStudio 0.39. emuStudio is universal emulation platform and framework targeting mainly academic sphere." /> <meta property="og:description" content="Emulator programming tutorial for emuStudio 0.39. emuStudio is universal emulation platform and framework targeting mainly academic sphere." /> <link rel="canonical" href="/documentation/developer/0.39/memory/" /> <meta property="og:url" content="/documentation/developer/0.39/memory/" /> <meta property="og:site_name" content="Emulator programming tutorial for emuStudio 0.39" /> <script type="application/ld+json"> {"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/documentation/developer/0.39/assets/logo-1.svg"}},"description":"Emulator programming tutorial for emuStudio 0.39. emuStudio is universal emulation platform and framework targeting mainly academic sphere.","@type":"WebPage","headline":"Writing a memory","url":"/documentation/developer/0.39/memory/","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="link" viewBox="0 0 16 16"> <title>Link</title> <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path> </symbol> </svg> <div class="page-wrap"> <div class="side-bar"> <div class="site-header"> <a href="/documentation/developer/0.39" class="site-title lh-tight"> <div class="site-logo"></div> </a> <button class="menu-button fs-3 js-main-nav-trigger" data-text-toggle="Hide" type="button">Menu</button> </div> <div class="navigation main-nav js-main-nav"> <nav role="navigation" aria-label="Main navigation"> <ul class="navigation-list"><li class="navigation-list-item active"><a href="/documentation/developer/0.39/404.html" class="navigation-list-link"></a></li><li class="navigation-list-item active"><a href="/documentation/developer/0.39/" class="navigation-list-link"></a></li><li class="navigation-list-item"><a href="/documentation/developer/0.39/introduction/" class="navigation-list-link">Introduction</a></li><li class="navigation-list-item"><a href="/documentation/developer/0.39/getting_started/" class="navigation-list-link">Getting started</a></li><li class="navigation-list-item"><a href="/documentation/developer/0.39/compiler/" class="navigation-list-link">Writing a compiler</a></li><li class="navigation-list-item active"><a href="/documentation/developer/0.39/memory/" class="navigation-list-link active">Writing a memory</a></li><li class="navigation-list-item"><a href="/documentation/developer/0.39/cpu/" class="navigation-list-link">Writing a CPU emulator</a></li><li class="navigation-list-item"><a href="/documentation/developer/0.39/device/" class="navigation-list-link">Writing a device</a></li></ul> </nav> </div> <footer class="site-footer"> <p class="text-small text-grey-dk-000 mb-4">This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</p> </footer> </div> <div class="main-content-wrap js-main-content" tabindex="0"> <div class="main-content"> <div class="page-header js-page-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" class="js-search-input search-input" tabindex="0" placeholder="Search Emulator programming tutorial for emuStudio 0.39" aria-label="Search Emulator programming tutorial for emuStudio 0.39" autocomplete="off"> <svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" class="search-icon"><title>Search</title><g fill-rule="nonzero"><path d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z"/><path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z"/></g></svg> </div> <div class="js-search-results search-results-wrap"></div> </div> <ul class="list-style-none text-small aux-nav"> <li class="d-inline-block my-0"><a href="/">Back to website</a></li> </ul> </div> <div class="page"> <div id="main-content" class="page-content" role="main"> <div class="sect1"> <h2 id="MEMORY_HOWTO"> <a href="#MEMORY_HOWTO" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Writing a memory </h2> <div class="sectionbody"> <div class="paragraph"> <p>This tutorial will describe some basic knowledge about how to create an operating memory to be used in emuStudio. In emuStudio, virtual computers usually conform to von-Neumann architecture. In this architecture, the memory is a separate component. The tutorial focuses on how to use emuLib API in a memory for SSEM computer.</p> </div> <div class="sect2"> <h3 id="MEMORY_GETTING_STARTED"> <a href="#MEMORY_GETTING_STARTED" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Getting started </h3> <div class="paragraph"> <p>Before reading on, please read the <a href="#INTRODUCTION_PLUGINS">[INTRODUCTION_PLUGINS]</a> chapter. It gives the information needed for setting up the development environment and for basic understanding how the emuStudio/plug-ins lifecycle work.</p> </div> <div class="paragraph"> <p>Within this tutorial, we will implement a main store of SSEM "Baby" machine, to conform with other tutorials for other plug-ins. Before we start, here&#8217;s a few words about what purpose and capabilities memories in emuStudio can have.</p> </div> <div class="paragraph"> <p>In first stored-program computers, operating memory was accessible only by CPU. It means that all data between the memory and other devices had to be transferred through CPU. When data from memory was required, CPU "paused" the execution of instructions and accessed the memory in the meantime. This slowed down CPU and consequently the whole program. Later, DMA (direct memory access) capability was introduced, which allowed devices to directly access the memory, or be notified when the memory changes.</p> </div> <div class="paragraph"> <p>In emuStudio, you can connect the memory with devices, or even with a compiler. This is one example of the versatility and power of emuStudio.</p> </div> <div class="paragraph"> <p>There are three main behavioral contracts which need to be taken into account, when creating memory plug-in:</p> </div> <div class="ulist"> <ul> <li> <p>Memory can be connected with none, one or more plug-ins of any type</p> </li> <li> <p>Memory plug-in is necessary for creating a virtual machine (emuStudio requires it)</p> </li> <li> <p>Operations of memory can be extended using special class called "context"</p> </li> </ul> </div> <div class="paragraph"> <p>The implication is that the memory can be shared across CPU and devices, and the communication can be optimized with custom operations. The context class is a customization which extends default context behavior. This tutorial will cover some basics in this topic.</p> </div> <div class="sect3"> <h4 id="ssem-memory"> <a href="#ssem-memory" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> SSEM memory </h4> <div class="paragraph"> <p>SSEM used the world&#8217;s first random-access memory called Williams or Williams-Kilburn tube <sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnote_1" title="View footnote.">1</a>]</sup>. The used principle was the same as in standard Cathode-Ray-Tubes (CRTs). Original EDSAC computer (which introduced the von Neumann architecture) did not have random-access memory.</p> </div> <div class="paragraph"> <p>The memory had 32 memory cells (called words), each had size of 32 bits. The memory could contain instructions and data. So, one SSEM instruction perfectly fits in the single memory word.</p> </div> <div class="paragraph"> <p>Within this tutorial, we will hardcode the word size and memory size. But we&#8217;ll also implement a GUI for the memory, which is often far more complicated than the emulated memory itself <sup class="footnote">[<a id="_footnoteref_2" class="footnote" href="#_footnote_2" title="View footnote.">2</a>]</sup></p> </div> </div> </div> <div class="sect2"> <h3 id="preparing-the-environment"> <a href="#preparing-the-environment" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Preparing the environment </h3> <div class="paragraph"> <p>In order to start developing the memory, create new Java project. Here, Maven will be used for dependencies management. The plug-in will be implemented as another standard emuStudio plug-in, so it will inherit Maven plug-in dependencies from the main POM file.</p> </div> <div class="paragraph"> <p>The project should be located at <code>emuStudio/plugins/mem/ssem-mem</code>, and should contain the following structure:</p> </div> <div class="literalblock"> <div class="content"><pre>src/
  main/
    java/
    resources/
test/
  java/
pom.xml</pre></div> </div> <div class="admonitionblock note"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> Note the naming of the plug-in. It follows the naming convention as described in the <a href="#INTRODUCTION_NAMING">[INTRODUCTION_NAMING]</a> guide. </td> </tr> </table></div> </div> <div class="paragraph"> <p>The POM file of the project might look as follows:</p> </div> <div class="listingblock"> <div class="title"><code>ssem-mem/pom.xml</code></div> <div class="content"><pre class="pygments highlight"><code data-lang="xml"><span style="color: #008000; font-weight: bold">&lt;project</span> <span style="color: #7D9029">xmlns=</span><span style="color: #BA2121">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span style="color: #7D9029">xmlns:xsi=</span><span style="color: #BA2121">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
  <span style="color: #7D9029">xsi:schemaLocation=</span><span style="color: #BA2121">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;modelVersion&gt;</span>4.0.0<span style="color: #008000; font-weight: bold">&lt;/modelVersion&gt;</span>

  <span style="color: #008000; font-weight: bold">&lt;parent&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;groupId&gt;</span>net.sf.emustudio<span style="color: #008000; font-weight: bold">&lt;/groupId&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;artifactId&gt;</span>emustudio-parent<span style="color: #008000; font-weight: bold">&lt;/artifactId&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;version&gt;</span>0.39<span style="color: #008000; font-weight: bold">&lt;/version&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;relativePath&gt;</span>../../..<span style="color: #008000; font-weight: bold">&lt;/relativePath&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;/parent&gt;</span>

  <span style="color: #008000; font-weight: bold">&lt;artifactId&gt;</span>ssem-mem<span style="color: #008000; font-weight: bold">&lt;/artifactId&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;packaging&gt;</span>jar<span style="color: #008000; font-weight: bold">&lt;/packaging&gt;</span>

  <span style="color: #008000; font-weight: bold">&lt;name&gt;</span>SSEM Memory<span style="color: #008000; font-weight: bold">&lt;/name&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;description&gt;</span>Operating memory (main store) for the SSEM computer<span style="color: #008000; font-weight: bold">&lt;/description&gt;</span>

  <span style="color: #008000; font-weight: bold">&lt;build&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;finalName&gt;</span>ssem-mem<span style="color: #008000; font-weight: bold">&lt;/finalName&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;plugins&gt;</span>
      <span style="color: #008000; font-weight: bold">&lt;plugin&gt;</span>
        <span style="color: #008000; font-weight: bold">&lt;groupId&gt;</span>org.apache.maven.plugins<span style="color: #008000; font-weight: bold">&lt;/groupId&gt;</span>
        <span style="color: #008000; font-weight: bold">&lt;artifactId&gt;</span>maven-compiler-plugin<span style="color: #008000; font-weight: bold">&lt;/artifactId&gt;</span>
      <span style="color: #008000; font-weight: bold">&lt;/plugin&gt;</span>
      <span style="color: #008000; font-weight: bold">&lt;plugin&gt;</span>
        <span style="color: #008000; font-weight: bold">&lt;groupId&gt;</span>org.apache.maven.plugins<span style="color: #008000; font-weight: bold">&lt;/groupId&gt;</span>
        <span style="color: #008000; font-weight: bold">&lt;artifactId&gt;</span>maven-jar-plugin<span style="color: #008000; font-weight: bold">&lt;/artifactId&gt;</span>
        <span style="color: #008000; font-weight: bold">&lt;configuration&gt;</span>
          <span style="color: #008000; font-weight: bold">&lt;archive&gt;</span>
            <span style="color: #008000; font-weight: bold">&lt;manifest&gt;</span>
              <span style="color: #008000; font-weight: bold">&lt;addClasspath&gt;</span>false<span style="color: #008000; font-weight: bold">&lt;/addClasspath&gt;</span>
              <span style="color: #008000; font-weight: bold">&lt;addDefaultImplementationEntries&gt;</span>true<span style="color: #008000; font-weight: bold">&lt;/addDefaultImplementationEntries&gt;</span>
              <span style="color: #008000; font-weight: bold">&lt;addDefaultSpecificationEntries&gt;</span>true<span style="color: #008000; font-weight: bold">&lt;/addDefaultSpecificationEntries&gt;</span>
            <span style="color: #008000; font-weight: bold">&lt;/manifest&gt;</span>
          <span style="color: #008000; font-weight: bold">&lt;/archive&gt;</span>
        <span style="color: #008000; font-weight: bold">&lt;/configuration&gt;</span>
      <span style="color: #008000; font-weight: bold">&lt;/plugin&gt;</span>
      <span style="color: #008000; font-weight: bold">&lt;plugin&gt;</span>
        <span style="color: #008000; font-weight: bold">&lt;groupId&gt;</span>org.apache.maven.plugins<span style="color: #008000; font-weight: bold">&lt;/groupId&gt;</span>
        <span style="color: #008000; font-weight: bold">&lt;artifactId&gt;</span>maven-dependency-plugin<span style="color: #008000; font-weight: bold">&lt;/artifactId&gt;</span>
      <span style="color: #008000; font-weight: bold">&lt;/plugin&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;/plugins&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;/build&gt;</span>

  <span style="color: #008000; font-weight: bold">&lt;dependencies&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;dependency&gt;</span>
      <span style="color: #008000; font-weight: bold">&lt;groupId&gt;</span>net.sf.emustudio<span style="color: #008000; font-weight: bold">&lt;/groupId&gt;</span>
      <span style="color: #008000; font-weight: bold">&lt;artifactId&gt;</span>emuLib<span style="color: #008000; font-weight: bold">&lt;/artifactId&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;/dependency&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;dependency&gt;</span>
      <span style="color: #008000; font-weight: bold">&lt;groupId&gt;</span>org.slf4j<span style="color: #008000; font-weight: bold">&lt;/groupId&gt;</span>
      <span style="color: #008000; font-weight: bold">&lt;artifactId&gt;</span>slf4j-api<span style="color: #008000; font-weight: bold">&lt;/artifactId&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;/dependency&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;dependency&gt;</span>
      <span style="color: #008000; font-weight: bold">&lt;groupId&gt;</span>junit<span style="color: #008000; font-weight: bold">&lt;/groupId&gt;</span>
      <span style="color: #008000; font-weight: bold">&lt;artifactId&gt;</span>junit<span style="color: #008000; font-weight: bold">&lt;/artifactId&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;/dependency&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;dependency&gt;</span>
      <span style="color: #008000; font-weight: bold">&lt;groupId&gt;</span>org.easymock<span style="color: #008000; font-weight: bold">&lt;/groupId&gt;</span>
      <span style="color: #008000; font-weight: bold">&lt;artifactId&gt;</span>easymock<span style="color: #008000; font-weight: bold">&lt;/artifactId&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;/dependency&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;/dependencies&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/project&gt;</span></code></pre></div> </div> <div class="paragraph"> <p>And let&#8217;s start with the first Java class, the main plug-in class. Let&#8217;s put it to package <code>net.sf.emustudio.ssem.memory</code>, and call it <code>MemoryImpl</code>.</p> </div> </div> <div class="sect2"> <h3 id="MEMORY_BASIC_STUFF"> <a href="#MEMORY_BASIC_STUFF" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> The main class </h3> <div class="paragraph"> <p>Go to the <code>MemoryImpl</code> class source. Extend the class from <code>emulib.plugins.memory.AbstractMemory</code> class. The class extends from <code>Memory</code> interface and implements the most common methods, usable by all memories.</p> </div> <div class="paragraph"> <p>It is also necessary to annotate the class with <code>emulib.annotations.PluginType</code> annotation, which is required for every main class of any emuStudio plug-in. The code snippet looks as follows:</p> </div> <div class="listingblock"> <div class="title"><code>src/main/java/net/sf/emustudio/ssem/memory/MemoryImpl.java</code></div> <div class="content"><pre class="pygments highlight"><code data-lang="java"><span style="color: #008000; font-weight: bold">package</span> <span style="color: #0000FF; font-weight: bold">net.sf.emustudio.ssem.memory</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">emulib.annotations.PLUGIN_TYPE</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">emulib.annotations.PluginType</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">emulib.plugins.memory.AbstractMemory</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">emulib.runtime.ContextPool</span><span style="color: #666666">;</span>

<span style="color: #AA22FF">@PluginType</span><span style="color: #666666">(</span>
        type <span style="color: #666666">=</span> PLUGIN_TYPE<span style="color: #666666">.</span><span style="color: #7D9029">MEMORY</span><span style="color: #666666">,</span>
        title <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;SSEM memory&quot;</span><span style="color: #666666">,</span>
        copyright <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;\u00A9 Copyright 2016, Peter Jakubčo&quot;</span><span style="color: #666666">,</span>
        description <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;Main store for SSEM machine&quot;</span>
<span style="color: #666666">)</span>
<span style="color: #008000; font-weight: bold">public</span> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">MemoryImpl</span> <span style="color: #008000; font-weight: bold">extends</span> AbstractMemory <span style="color: #666666">{</span>
    <span style="color: #008000; font-weight: bold">private</span> <span style="color: #008000; font-weight: bold">final</span> <span style="color: #008000; font-weight: bold">static</span> Logger LOGGER <span style="color: #666666">=</span> LoggerFactory<span style="color: #666666">.</span><span style="color: #7D9029">getLogger</span><span style="color: #666666">(</span>MemoryImpl<span style="color: #666666">.</span><span style="color: #7D9029">class</span><span style="color: #666666">);</span>

    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #0000FF">MemoryImpl</span><span style="color: #666666">(</span>Long pluginID<span style="color: #666666">,</span> ContextPool contextPoolImpl<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        <span style="color: #008000; font-weight: bold">super</span><span style="color: #666666">(</span>pluginID<span style="color: #666666">);</span>
    <span style="color: #666666">}</span>

    <span style="color: #408080; font-style: italic">// ... other methods ...</span>
<span style="color: #666666">}</span></code></pre></div> </div> <div class="admonitionblock note"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> The constructor presented here is mandatory. This is one of the behavioral contracts, emuStudio expects that a plug-in will have a constructor with two arguments: <code>pluginID</code> (assigned by emuStudio), and a context pool, which is a storage or registrar of all plug-ins contexts. </td> </tr> </table></div> </div> </div> <div class="sect2"> <h3 id="few-notes-on-ssem-memory"> <a href="#few-notes-on-ssem-memory" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Few notes on SSEM memory </h3> <div class="paragraph"> <p>When thinking about computer memory - what is it? During time, memory abstraction has evolved to an idea of memory as a collection of cells, equally-sized, which are ordered sequentially. This is the simplest description, and I would say that more-less all memories look like this. When emulating a computer memory in a programming language like Java, it would be then just a plain array.</p> </div> <div class="paragraph"> <p>SSEM had 32 so-called "lines", which represented cells in memory. Each line, or a cell, was 4 bytes long. It is therefore tempting to implement SSEM memory as array of integers, because <code>int</code> type has 4 bytes.</p> </div> <div class="paragraph"> <p>It is indeed possible, but we will face to an unsolvable problem when implementing CPU, if we want to use Edigen <sup class="footnote">[<a id="_footnoteref_3" class="footnote" href="#_footnote_3" title="View footnote.">3</a>]</sup>. Unfortunately, Edigen is so-far designed in a way that it expects the memory having cell size of a byte, not more. Therefore, we will keep that also for SSEM memory emulation, but visually try to present it as having 4-byte cells. It would require additional mathematics when working with memory (in the CPU tutorial you would find it as well), but not having impact on performance.</p> </div> </div> <div class="sect2"> <h3 id="memory-context"> <a href="#memory-context" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Memory context </h3> <div class="paragraph"> <p>Abstracts are helping us to understand ideas and see how they can be composed into a whole. In this fashion, memory main interface, presented in section <a href="#MEMORY_BASIC_STUFF">The main class</a>, is the communication point with emuStudio. The main module is using methods in this interface. The communication with CPU and devices is done through another concept, which is called a context. The contexts differ for various plug-ins; and they can be customized.</p> </div> <div class="paragraph"> <p>Plug-ins which provide a context, must register it to the <code>ContextPool</code>, given in a constructor in the main plugin class. This registration should be performed as early as possible - in the constructor itself. After all plug-ins are instantiated, emuStudio expects that all contexts are already registered.</p> </div> <div class="paragraph"> <p>The next step, generally true for all plug-ins, is calling of <code>Plugin.initialize()</code> method, in this case - <code>Memory.initialize()</code>. The initialization can now use the context pool for different purpose - for obtaining contexts, if it requires some. More on this topic can be found in the <a href="#INTRODUCTION_BEHAVIORAL">[INTRODUCTION_BEHAVIORAL]</a> section.</p> </div> <div class="paragraph"> <p>So, in our case - we must create a memory context, which will be used by SSEM CPU and SSEM CRT display. We don&#8217;t need special customized context, so we can comfortably extend from class <code>AbstractMemoryContext</code>, which will implement some methods of the <code>MemoryContext</code> interface for us. We will call the class <code>MemoryContextImpl</code>:</p> </div> <div class="listingblock"> <div class="title"><code>src/main/java/net/sf/emustudio/ssem/memory/impl/MemoryContextImpl.java</code></div> <div class="content"><pre class="pygments highlight"><code data-lang="java"><span style="color: #008000; font-weight: bold">package</span> <span style="color: #0000FF; font-weight: bold">net.sf.emustudio.ssem.memory.impl</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">emulib.plugins.memory.AbstractMemoryContext</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">net.jcip.annotations.ThreadSafe</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">java.util.Arrays</span><span style="color: #666666">;</span>

<span style="color: #AA22FF">@ThreadSafe</span>
<span style="color: #008000; font-weight: bold">public</span> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">MemoryContextImpl</span> <span style="color: #008000; font-weight: bold">extends</span> AbstractMemoryContext<span style="color: #666666">&lt;</span>Byte<span style="color: #666666">&gt;</span> <span style="color: #666666">{</span>
    <span style="color: #008000; font-weight: bold">static</span> <span style="color: #008000; font-weight: bold">final</span> <span style="color: #B00040">int</span> NUMBER_OF_CELLS <span style="color: #666666">=</span> <span style="color: #666666">32</span> <span style="color: #666666">*</span> <span style="color: #666666">4;</span>

    <span style="color: #408080; font-style: italic">// byte type is atomic in JVM memory model</span>
    <span style="color: #008000; font-weight: bold">private</span> <span style="color: #008000; font-weight: bold">final</span> <span style="color: #B00040">byte</span><span style="color: #666666">[]</span>memory <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> <span style="color: #B00040">byte</span><span style="color: #666666">[</span>NUMBER_OF_CELLS<span style="color: #666666">];</span>

    <span style="color: #AA22FF">@Override</span>
    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">clear</span><span style="color: #666666">()</span> <span style="color: #666666">{</span>
        Arrays<span style="color: #666666">.</span><span style="color: #7D9029">fill</span><span style="color: #666666">(</span>memory<span style="color: #666666">,</span> <span style="color: #666666">(</span><span style="color: #B00040">byte</span><span style="color: #666666">)0);</span>
        notifyMemoryChanged<span style="color: #666666">(-1);</span> <span style="color: #408080; font-style: italic">// notify that all memory has changed</span>
    <span style="color: #666666">}</span>

    <span style="color: #AA22FF">@Override</span>
    <span style="color: #008000; font-weight: bold">public</span> Class<span style="color: #666666">&lt;?&gt;</span> getDataType<span style="color: #666666">()</span> <span style="color: #666666">{</span>
        <span style="color: #008000; font-weight: bold">return</span> Byte<span style="color: #666666">.</span><span style="color: #7D9029">class</span><span style="color: #666666">;</span>
    <span style="color: #666666">}</span>

    <span style="color: #AA22FF">@Override</span>
    <span style="color: #008000; font-weight: bold">public</span> Byte <span style="color: #0000FF">read</span><span style="color: #666666">(</span><span style="color: #B00040">int</span> from<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        <span style="color: #008000; font-weight: bold">return</span> memory<span style="color: #666666">[</span>from<span style="color: #666666">];</span>
    <span style="color: #666666">}</span>

    <span style="color: #AA22FF">@Override</span>
    <span style="color: #008000; font-weight: bold">public</span> Byte<span style="color: #666666">[]</span> <span style="color: #0000FF">readWord</span><span style="color: #666666">(</span><span style="color: #B00040">int</span> from<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000; font-weight: bold">new</span> Byte<span style="color: #666666">[]</span> <span style="color: #666666">{</span> memory<span style="color: #666666">[</span>from<span style="color: #666666">],</span> memory<span style="color: #666666">[</span>from<span style="color: #666666">+1],</span> memory<span style="color: #666666">[</span>from<span style="color: #666666">+2],</span> memory<span style="color: #666666">[</span>from<span style="color: #666666">+3]</span> <span style="color: #666666">};</span>
    <span style="color: #666666">}</span>

    <span style="color: #AA22FF">@Override</span>
    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">write</span><span style="color: #666666">(</span><span style="color: #B00040">int</span> to<span style="color: #666666">,</span> Byte val<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        memory<span style="color: #666666">[</span>to<span style="color: #666666">]</span> <span style="color: #666666">=</span> val<span style="color: #666666">;</span>
        notifyMemoryChanged<span style="color: #666666">(</span>to<span style="color: #666666">);</span>
    <span style="color: #666666">}</span>

    <span style="color: #AA22FF">@Override</span>
    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">writeWord</span><span style="color: #666666">(</span><span style="color: #B00040">int</span> to<span style="color: #666666">,</span> Byte<span style="color: #666666">[]</span> cells<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        <span style="color: #B00040">int</span> i <span style="color: #666666">=</span> <span style="color: #666666">0;</span>
        <span style="color: #008000; font-weight: bold">for</span> <span style="color: #666666">(</span><span style="color: #B00040">byte</span> cell <span style="color: #666666">:</span> cells<span style="color: #666666">)</span> <span style="color: #666666">{</span>
            memory<span style="color: #666666">[</span>to <span style="color: #666666">+</span> i<span style="color: #666666">]</span> <span style="color: #666666">=</span> cell<span style="color: #666666">;</span>
            notifyMemoryChanged<span style="color: #666666">(</span>to<span style="color: #666666">+</span>i<span style="color: #666666">);</span>
            i<span style="color: #666666">++;</span>
        <span style="color: #666666">}</span>
    <span style="color: #666666">}</span>

    <span style="color: #AA22FF">@Override</span>
    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">int</span> <span style="color: #0000FF">getSize</span><span style="color: #666666">()</span> <span style="color: #666666">{</span>
        <span style="color: #008000; font-weight: bold">return</span> memory<span style="color: #666666">.</span><span style="color: #7D9029">length</span><span style="color: #666666">;</span>
    <span style="color: #666666">}</span>
<span style="color: #666666">}</span></code></pre></div> </div> <div class="paragraph"> <p>As you can see, SSEM memory is indeed an array of bytes. This is the "core" idea of a memory. Ofcourse, it is possible to use a <code>java.util.List</code> or another collection, but we should keep eye on performance. Array is the simplest structure with access time O(1). Therefore, we chose array.</p> </div> <div class="paragraph"> <p>Also notice that the class <code>AbstractMemoryContext</code>, and also interface <code>MemoryContext</code> take a generic parameter <code>T extends Number</code>. This parameter is saying of what type cell is. In our case, <code>T</code> is a <code>Byte</code>. Due unhappy Java limitation, primitive types cannot be used in generics, so we can&#8217;t have something like <code>MemoryContext&lt;byte&gt;</code>.</p> </div> </div> <div class="sect2"> <h3 id="gui"> <a href="#gui" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> GUI </h3> <div class="paragraph"> <p>Since emuStudio is interactive application, GUIs are a natural thing. Each memory plug-in should have its own GUI. The supported features can be any, but keep in mind, that GUI control in Swing is done in separate thread, often called "UI Thread". On the other hand, emulation itself is running in different, dedicated, thread, created in emuLib.</p> </div> <div class="paragraph"> <p>This means that the access to memory context should be synchronized. However, synchronization is very slow. Much better approach is to use a non-blocking algorithm for locking, if we really require absolutely reliable manipulation of memory cells in between threads. However, non-blocking algorithms are harder to implement good. In our tutorial we will do a trade-off, which we can afford - since we have final array of bytes, we have the following guarantees:</p> </div> <div class="olist arabic"> <ol class="arabic"> <li> <p>the array itself will be always valid and visible to all accessing threads. Meaning - reading is always safe.</p> </li> <li> <p>we expect our host CPU can write a byte at once; therefore it is atomic. This does not have to hold for all CPUs - don&#8217;t worry, all x86 CPUs have it.</p> </li> <li> <p>According to <a href="https://docs.oracle.com/javase/specs/jls/se7/html/jls-17.html#jls-17.6">Java Language Specification, Chapter 17.6</a>:</p> <div class="literalblock"> <div class="content"><pre>two threads that update adjacent elements of a byte array separately must not interfere or interact and do not need
synchronization to ensure sequential consistency.</pre></div> </div> </li> </ol> </div> <div class="paragraph"> <p>I consider these guarantees as good enough to leave the synchronization be. I guess the probability of modifying the same memory cells from both running emulation and by the user in GUI, is very small. What&#8217;s more, you shouldn&#8217;t modify memory cells at all when the emulation is running.</p> </div> <div class="paragraph"> <p>Now back to our GUI. It would be good if the GUI is looking good, so it&#8217;s up to you how you&#8217;ll draw the main form. It can be a class extending from a <code>javax.swing.JFrame</code> or <code>javax.swing.JDialog</code>. The look might be as follows:</p> </div> <div class="imageblock"> <div class="content"> <img src="/documentation/developer/0.39/_doc/images//ssem-memory.png" alt="SSEM Memory GUI sample look"> </div> </div> <div class="paragraph"> <p>So, we will need a custom memory model, a custom memory table - which will have a row header (the very first, gray-colored column) and column header (the very first, gray-colored row).</p> </div> <div class="paragraph"> <p>As you can see in the picture, a row represents single SSEM memory cell - 32 scattered bits, and the last few columns show both the number the bits represent, and a raw ASCII value of the 4-byte sequence of data.</p> </div> <div class="paragraph"> <p>Also, we would like to let user edit the cells manually - just by pointing to a bit, and pressing either 1 or 0 - possibly a DELETE key, committing the change immediately. We want to allow editing also for the value itself, and for the data column as well.</p> </div> <div class="paragraph"> <p>In addition, movement around cells should be possible with arrow keys.</p> </div> <div class="paragraph"> <p>For those "specifications", we will need to customize standard <code>javax.swing.JTable</code>, create custom memory model, cell editor, cell renderer and introduce row header renderer.</p> </div> <div class="paragraph"> <p>The source code of the main GUI class is here:</p> </div> <div class="listingblock"> <div class="title"><code>src/main/java/net/sf/emustudio/ssem/memory/gui/MemoryGUI.java</code></div> <div class="content"><pre class="pygments highlight"><code data-lang="java"><span style="color: #008000; font-weight: bold">package</span> <span style="color: #0000FF; font-weight: bold">net.sf.emustudio.ssem.memory.gui</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">emulib.plugins.memory.Memory</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">emulib.plugins.memory.MemoryContext</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">javax.swing.JDialog</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">public</span> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">MemoryGUI</span> <span style="color: #008000; font-weight: bold">extends</span> JDialog <span style="color: #666666">{</span>
    <span style="color: #008000; font-weight: bold">private</span> <span style="color: #008000; font-weight: bold">final</span> MemoryTableModel tableModel<span style="color: #666666">;</span>

    <span style="color: #008000; font-weight: bold">private</span> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">MemoryListenerImpl</span> <span style="color: #008000; font-weight: bold">implements</span> Memory<span style="color: #666666">.</span><span style="color: #7D9029">MemoryListener</span> <span style="color: #666666">{</span>

        <span style="color: #AA22FF">@Override</span>
        <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">memoryChanged</span><span style="color: #666666">(</span><span style="color: #B00040">int</span> memoryPosition<span style="color: #666666">)</span> <span style="color: #666666">{</span>
            tableModel<span style="color: #666666">.</span><span style="color: #7D9029">dataChangedAt</span><span style="color: #666666">(</span>memoryPosition<span style="color: #666666">);</span>
        <span style="color: #666666">}</span>

        <span style="color: #AA22FF">@Override</span>
        <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">memorySizeChanged</span><span style="color: #666666">()</span> <span style="color: #666666">{</span>
            tableModel<span style="color: #666666">.</span><span style="color: #7D9029">fireTableDataChanged</span><span style="color: #666666">();</span>
        <span style="color: #666666">}</span>
    <span style="color: #666666">}</span>

    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #0000FF">MemoryGUI</span><span style="color: #666666">(</span>MemoryContext<span style="color: #666666">&lt;</span>Byte<span style="color: #666666">&gt;</span> memory<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        initComponents<span style="color: #666666">();</span>
        <span style="color: #008000; font-weight: bold">super</span><span style="color: #666666">.</span><span style="color: #7D9029">setLocationRelativeTo</span><span style="color: #666666">(</span><span style="color: #008000; font-weight: bold">null</span><span style="color: #666666">);</span>

        <span style="color: #008000; font-weight: bold">this</span><span style="color: #666666">.</span><span style="color: #7D9029">tableModel</span> <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> MemoryTableModel<span style="color: #666666">(</span>memory<span style="color: #666666">);</span>
        MemoryTable memoryTable <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> MemoryTable<span style="color: #666666">(</span>tableModel<span style="color: #666666">,</span> scrollPane<span style="color: #666666">);</span>
        memoryTable<span style="color: #666666">.</span><span style="color: #7D9029">setup</span><span style="color: #666666">();</span>
        scrollPane<span style="color: #666666">.</span><span style="color: #7D9029">setViewportView</span><span style="color: #666666">(</span>memoryTable<span style="color: #666666">);</span>

        memory<span style="color: #666666">.</span><span style="color: #7D9029">addMemoryListener</span><span style="color: #666666">(</span><span style="color: #008000; font-weight: bold">new</span> MemoryListenerImpl<span style="color: #666666">());</span>
    <span style="color: #666666">}</span>

    <span style="color: #408080; font-style: italic">/**</span>
<span style="color: #408080; font-style: italic">     * This method is called from within the constructor to initialize the form. WARNING: Do NOT modify this code. The</span>
<span style="color: #408080; font-style: italic">     * content of this method is always regenerated by the Form Editor.</span>
<span style="color: #408080; font-style: italic">     */</span>
    <span style="color: #AA22FF">@SuppressWarnings</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;unchecked&quot;</span><span style="color: #666666">)</span>
    <span style="color: #408080; font-style: italic">// &lt;editor-fold defaultstate=&quot;collapsed&quot; desc=&quot;Generated Code&quot;&gt;//GEN-BEGIN:initComponents</span>
    <span style="color: #008000; font-weight: bold">private</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">initComponents</span><span style="color: #666666">()</span> <span style="color: #666666">{</span>

        scrollPane <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> javax<span style="color: #666666">.</span><span style="color: #7D9029">swing</span><span style="color: #666666">.</span><span style="color: #7D9029">JScrollPane</span><span style="color: #666666">();</span>
        javax<span style="color: #666666">.</span><span style="color: #7D9029">swing</span><span style="color: #666666">.</span><span style="color: #7D9029">JToolBar</span> jToolBar1 <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> javax<span style="color: #666666">.</span><span style="color: #7D9029">swing</span><span style="color: #666666">.</span><span style="color: #7D9029">JToolBar</span><span style="color: #666666">();</span>
        javax<span style="color: #666666">.</span><span style="color: #7D9029">swing</span><span style="color: #666666">.</span><span style="color: #7D9029">JButton</span> btnClear <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> javax<span style="color: #666666">.</span><span style="color: #7D9029">swing</span><span style="color: #666666">.</span><span style="color: #7D9029">JButton</span><span style="color: #666666">();</span>

        setDefaultCloseOperation<span style="color: #666666">(</span>javax<span style="color: #666666">.</span><span style="color: #7D9029">swing</span><span style="color: #666666">.</span><span style="color: #7D9029">WindowConstants</span><span style="color: #666666">.</span><span style="color: #7D9029">DISPOSE_ON_CLOSE</span><span style="color: #666666">);</span>
        setTitle<span style="color: #666666">(</span><span style="color: #BA2121">&quot;SSEM Memory (Williams-Killburn Tube)&quot;</span><span style="color: #666666">);</span>

        jToolBar1<span style="color: #666666">.</span><span style="color: #7D9029">setFloatable</span><span style="color: #666666">(</span><span style="color: #008000; font-weight: bold">false</span><span style="color: #666666">);</span>
        jToolBar1<span style="color: #666666">.</span><span style="color: #7D9029">setRollover</span><span style="color: #666666">(</span><span style="color: #008000; font-weight: bold">true</span><span style="color: #666666">);</span>

        btnClear<span style="color: #666666">.</span><span style="color: #7D9029">setIcon</span><span style="color: #666666">(</span><span style="color: #008000; font-weight: bold">new</span> javax<span style="color: #666666">.</span><span style="color: #7D9029">swing</span><span style="color: #666666">.</span><span style="color: #7D9029">ImageIcon</span><span style="color: #666666">(</span>getClass<span style="color: #666666">().</span><span style="color: #7D9029">getResource</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;/net/sf/emustudio/ssem/memory/gui/clear.png&quot;</span><span style="color: #666666">)));</span> <span style="color: #408080; font-style: italic">// NOI18N</span>
        btnClear<span style="color: #666666">.</span><span style="color: #7D9029">setFocusable</span><span style="color: #666666">(</span><span style="color: #008000; font-weight: bold">false</span><span style="color: #666666">);</span>
        btnClear<span style="color: #666666">.</span><span style="color: #7D9029">setHorizontalTextPosition</span><span style="color: #666666">(</span>javax<span style="color: #666666">.</span><span style="color: #7D9029">swing</span><span style="color: #666666">.</span><span style="color: #7D9029">SwingConstants</span><span style="color: #666666">.</span><span style="color: #7D9029">CENTER</span><span style="color: #666666">);</span>
        btnClear<span style="color: #666666">.</span><span style="color: #7D9029">setVerticalTextPosition</span><span style="color: #666666">(</span>javax<span style="color: #666666">.</span><span style="color: #7D9029">swing</span><span style="color: #666666">.</span><span style="color: #7D9029">SwingConstants</span><span style="color: #666666">.</span><span style="color: #7D9029">BOTTOM</span><span style="color: #666666">);</span>
        btnClear<span style="color: #666666">.</span><span style="color: #7D9029">addActionListener</span><span style="color: #666666">(</span><span style="color: #008000; font-weight: bold">new</span> java<span style="color: #666666">.</span><span style="color: #7D9029">awt</span><span style="color: #666666">.</span><span style="color: #7D9029">event</span><span style="color: #666666">.</span><span style="color: #7D9029">ActionListener</span><span style="color: #666666">()</span> <span style="color: #666666">{</span>
            <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">actionPerformed</span><span style="color: #666666">(</span>java<span style="color: #666666">.</span><span style="color: #7D9029">awt</span><span style="color: #666666">.</span><span style="color: #7D9029">event</span><span style="color: #666666">.</span><span style="color: #7D9029">ActionEvent</span> evt<span style="color: #666666">)</span> <span style="color: #666666">{</span>
                btnClearActionPerformed<span style="color: #666666">(</span>evt<span style="color: #666666">);</span>
            <span style="color: #666666">}</span>
        <span style="color: #666666">});</span>
        jToolBar1<span style="color: #666666">.</span><span style="color: #7D9029">add</span><span style="color: #666666">(</span>btnClear<span style="color: #666666">);</span>

        javax<span style="color: #666666">.</span><span style="color: #7D9029">swing</span><span style="color: #666666">.</span><span style="color: #7D9029">GroupLayout</span> layout <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> javax<span style="color: #666666">.</span><span style="color: #7D9029">swing</span><span style="color: #666666">.</span><span style="color: #7D9029">GroupLayout</span><span style="color: #666666">(</span>getContentPane<span style="color: #666666">());</span>
        getContentPane<span style="color: #666666">().</span><span style="color: #7D9029">setLayout</span><span style="color: #666666">(</span>layout<span style="color: #666666">);</span>
        layout<span style="color: #666666">.</span><span style="color: #7D9029">setHorizontalGroup</span><span style="color: #666666">(</span>
            layout<span style="color: #666666">.</span><span style="color: #7D9029">createParallelGroup</span><span style="color: #666666">(</span>javax<span style="color: #666666">.</span><span style="color: #7D9029">swing</span><span style="color: #666666">.</span><span style="color: #7D9029">GroupLayout</span><span style="color: #666666">.</span><span style="color: #7D9029">Alignment</span><span style="color: #666666">.</span><span style="color: #7D9029">LEADING</span><span style="color: #666666">)</span>
            <span style="color: #666666">.</span><span style="color: #7D9029">addComponent</span><span style="color: #666666">(</span>scrollPane<span style="color: #666666">,</span> javax<span style="color: #666666">.</span><span style="color: #7D9029">swing</span><span style="color: #666666">.</span><span style="color: #7D9029">GroupLayout</span><span style="color: #666666">.</span><span style="color: #7D9029">DEFAULT_SIZE</span><span style="color: #666666">,</span> <span style="color: #666666">965,</span> Short<span style="color: #666666">.</span><span style="color: #7D9029">MAX_VALUE</span><span style="color: #666666">)</span>
            <span style="color: #666666">.</span><span style="color: #7D9029">addComponent</span><span style="color: #666666">(</span>jToolBar1<span style="color: #666666">,</span> javax<span style="color: #666666">.</span><span style="color: #7D9029">swing</span><span style="color: #666666">.</span><span style="color: #7D9029">GroupLayout</span><span style="color: #666666">.</span><span style="color: #7D9029">DEFAULT_SIZE</span><span style="color: #666666">,</span> javax<span style="color: #666666">.</span><span style="color: #7D9029">swing</span><span style="color: #666666">.</span><span style="color: #7D9029">GroupLayout</span><span style="color: #666666">.</span><span style="color: #7D9029">DEFAULT_SIZE</span><span style="color: #666666">,</span> Short<span style="color: #666666">.</span><span style="color: #7D9029">MAX_VALUE</span><span style="color: #666666">)</span>
        <span style="color: #666666">);</span>
        layout<span style="color: #666666">.</span><span style="color: #7D9029">setVerticalGroup</span><span style="color: #666666">(</span>
            layout<span style="color: #666666">.</span><span style="color: #7D9029">createParallelGroup</span><span style="color: #666666">(</span>javax<span style="color: #666666">.</span><span style="color: #7D9029">swing</span><span style="color: #666666">.</span><span style="color: #7D9029">GroupLayout</span><span style="color: #666666">.</span><span style="color: #7D9029">Alignment</span><span style="color: #666666">.</span><span style="color: #7D9029">LEADING</span><span style="color: #666666">)</span>
            <span style="color: #666666">.</span><span style="color: #7D9029">addGroup</span><span style="color: #666666">(</span>javax<span style="color: #666666">.</span><span style="color: #7D9029">swing</span><span style="color: #666666">.</span><span style="color: #7D9029">GroupLayout</span><span style="color: #666666">.</span><span style="color: #7D9029">Alignment</span><span style="color: #666666">.</span><span style="color: #7D9029">TRAILING</span><span style="color: #666666">,</span> layout<span style="color: #666666">.</span><span style="color: #7D9029">createSequentialGroup</span><span style="color: #666666">()</span>
                <span style="color: #666666">.</span><span style="color: #7D9029">addComponent</span><span style="color: #666666">(</span>jToolBar1<span style="color: #666666">,</span> javax<span style="color: #666666">.</span><span style="color: #7D9029">swing</span><span style="color: #666666">.</span><span style="color: #7D9029">GroupLayout</span><span style="color: #666666">.</span><span style="color: #7D9029">PREFERRED_SIZE</span><span style="color: #666666">,</span> <span style="color: #666666">32,</span> javax<span style="color: #666666">.</span><span style="color: #7D9029">swing</span><span style="color: #666666">.</span><span style="color: #7D9029">GroupLayout</span><span style="color: #666666">.</span><span style="color: #7D9029">PREFERRED_SIZE</span><span style="color: #666666">)</span>
                <span style="color: #666666">.</span><span style="color: #7D9029">addPreferredGap</span><span style="color: #666666">(</span>javax<span style="color: #666666">.</span><span style="color: #7D9029">swing</span><span style="color: #666666">.</span><span style="color: #7D9029">LayoutStyle</span><span style="color: #666666">.</span><span style="color: #7D9029">ComponentPlacement</span><span style="color: #666666">.</span><span style="color: #7D9029">RELATED</span><span style="color: #666666">)</span>
                <span style="color: #666666">.</span><span style="color: #7D9029">addComponent</span><span style="color: #666666">(</span>scrollPane<span style="color: #666666">,</span> javax<span style="color: #666666">.</span><span style="color: #7D9029">swing</span><span style="color: #666666">.</span><span style="color: #7D9029">GroupLayout</span><span style="color: #666666">.</span><span style="color: #7D9029">DEFAULT_SIZE</span><span style="color: #666666">,</span> <span style="color: #666666">455,</span> Short<span style="color: #666666">.</span><span style="color: #7D9029">MAX_VALUE</span><span style="color: #666666">))</span>
        <span style="color: #666666">);</span>

        pack<span style="color: #666666">();</span>
    <span style="color: #666666">}</span><span style="color: #408080; font-style: italic">// &lt;/editor-fold&gt;//GEN-END:initComponents</span>

    <span style="color: #008000; font-weight: bold">private</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">btnClearActionPerformed</span><span style="color: #666666">(</span>java<span style="color: #666666">.</span><span style="color: #7D9029">awt</span><span style="color: #666666">.</span><span style="color: #7D9029">event</span><span style="color: #666666">.</span><span style="color: #7D9029">ActionEvent</span> evt<span style="color: #666666">)</span> <span style="color: #666666">{</span><span style="color: #408080; font-style: italic">//GEN-FIRST:event_btnClearActionPerformed</span>
        tableModel<span style="color: #666666">.</span><span style="color: #7D9029">clear</span><span style="color: #666666">();</span>
    <span style="color: #666666">}</span><span style="color: #408080; font-style: italic">//GEN-LAST:event_btnClearActionPerformed</span>

    <span style="color: #408080; font-style: italic">// Variables declaration - do not modify//GEN-BEGIN:variables</span>
    <span style="color: #008000; font-weight: bold">private</span> javax<span style="color: #666666">.</span><span style="color: #7D9029">swing</span><span style="color: #666666">.</span><span style="color: #7D9029">JScrollPane</span> scrollPane<span style="color: #666666">;</span>
    <span style="color: #408080; font-style: italic">// End of variables declaration//GEN-END:variables</span>
<span style="color: #666666">}</span></code></pre></div> </div> <div class="paragraph"> <p>Note that in the constructor we create a memory listener, which implements <code>Memory.MemoryListener</code> interface. The listener will receive events about external memory changes - in our case, from CPU emulator. Our reaction is - as supposed to be - reflect the change in the memory GUI.</p> </div> <div class="admonitionblock note"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> The caller thread of listener methods is the one who calls <code>Memory.write()</code> on the other end. In our case, it can be either the emulator dedicated thread, as described above, or the user itself, doing changes in the UI thread. </td> </tr> </table></div> </div> <div class="paragraph"> <p>Also, we use custom memory table, which extends from <code>javax.swing.table.JTable</code>. We will describe it now.</p> </div> <div class="sect3"> <h4 id="memory-table"> <a href="#memory-table" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Memory table </h4> <div class="paragraph"> <p>Since we want "special" behavior, like custom cell renderer, custom row header, custom cell editor and custom widths of some columns, it will be good to wrap it up in a custom <code>JTable</code>. The code looks as follows:</p> </div> <div class="listingblock"> <div class="title"><code>src/main/java/net/sf/emustudio/ssem/memory/gui/MemoryTable.java</code></div> <div class="content"><pre class="pygments highlight"><code data-lang="java"><span style="color: #008000; font-weight: bold">package</span> <span style="color: #0000FF; font-weight: bold">net.sf.emustudio.ssem.memory.gui</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">java.awt.event.ActionEvent</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">java.awt.event.KeyEvent</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">java.util.Objects</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">javax.swing.AbstractAction</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">javax.swing.ActionMap</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">javax.swing.InputMap</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">javax.swing.JScrollPane</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">javax.swing.JTable</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">javax.swing.KeyStroke</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">javax.swing.ListSelectionModel</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">javax.swing.table.TableColumn</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import static</span> <span style="color: #0000FF; font-weight: bold">net.sf.emustudio.ssem.memory.gui.Constants.CHAR_HEIGHT</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import static</span> <span style="color: #0000FF; font-weight: bold">net.sf.emustudio.ssem.memory.gui.Constants.COLUMN_WIDTH</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import static</span> <span style="color: #0000FF; font-weight: bold">net.sf.emustudio.ssem.memory.gui.Constants.DEFAULT_FONT</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">MemoryTable</span> <span style="color: #008000; font-weight: bold">extends</span> JTable <span style="color: #666666">{</span>
    <span style="color: #008000; font-weight: bold">private</span> <span style="color: #008000; font-weight: bold">final</span> MemoryTableModel model<span style="color: #666666">;</span>
    <span style="color: #008000; font-weight: bold">private</span> <span style="color: #008000; font-weight: bold">final</span> CellRenderer cellRenderer<span style="color: #666666">;</span>
    <span style="color: #008000; font-weight: bold">private</span> <span style="color: #008000; font-weight: bold">final</span> JScrollPane scrollPane<span style="color: #666666">;</span>

    MemoryTable<span style="color: #666666">(</span>MemoryTableModel model<span style="color: #666666">,</span> JScrollPane scrollPane<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        <span style="color: #008000; font-weight: bold">this</span><span style="color: #666666">.</span><span style="color: #7D9029">scrollPane</span> <span style="color: #666666">=</span> Objects<span style="color: #666666">.</span><span style="color: #7D9029">requireNonNull</span><span style="color: #666666">(</span>scrollPane<span style="color: #666666">);</span>
        <span style="color: #008000; font-weight: bold">this</span><span style="color: #666666">.</span><span style="color: #7D9029">model</span> <span style="color: #666666">=</span> Objects<span style="color: #666666">.</span><span style="color: #7D9029">requireNonNull</span><span style="color: #666666">(</span>model<span style="color: #666666">);</span>
        <span style="color: #008000; font-weight: bold">this</span><span style="color: #666666">.</span><span style="color: #7D9029">cellRenderer</span> <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> CellRenderer<span style="color: #666666">(</span>model<span style="color: #666666">);</span>

        <span style="color: #008000; font-weight: bold">super</span><span style="color: #666666">.</span><span style="color: #7D9029">setModel</span><span style="color: #666666">(</span><span style="color: #008000; font-weight: bold">this</span><span style="color: #666666">.</span><span style="color: #7D9029">model</span><span style="color: #666666">);</span>
        <span style="color: #008000; font-weight: bold">super</span><span style="color: #666666">.</span><span style="color: #7D9029">setFont</span><span style="color: #666666">(</span>DEFAULT_FONT<span style="color: #666666">);</span>
        <span style="color: #008000; font-weight: bold">super</span><span style="color: #666666">.</span><span style="color: #7D9029">setCellSelectionEnabled</span><span style="color: #666666">(</span><span style="color: #008000; font-weight: bold">true</span><span style="color: #666666">);</span>
        <span style="color: #008000; font-weight: bold">super</span><span style="color: #666666">.</span><span style="color: #7D9029">setFocusCycleRoot</span><span style="color: #666666">(</span><span style="color: #008000; font-weight: bold">true</span><span style="color: #666666">);</span>
        <span style="color: #008000; font-weight: bold">super</span><span style="color: #666666">.</span><span style="color: #7D9029">setSelectionMode</span><span style="color: #666666">(</span>ListSelectionModel<span style="color: #666666">.</span><span style="color: #7D9029">SINGLE_SELECTION</span><span style="color: #666666">);</span>
        <span style="color: #008000; font-weight: bold">super</span><span style="color: #666666">.</span><span style="color: #7D9029">getTableHeader</span><span style="color: #666666">().</span><span style="color: #7D9029">setFont</span><span style="color: #666666">(</span>DEFAULT_FONT<span style="color: #666666">);</span>
    <span style="color: #666666">}</span>

    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">setup</span><span style="color: #666666">()</span> <span style="color: #666666">{</span>
        cellRenderer<span style="color: #666666">.</span><span style="color: #7D9029">setup</span><span style="color: #666666">(</span><span style="color: #008000; font-weight: bold">this</span><span style="color: #666666">);</span>
        setDefaultRenderer<span style="color: #666666">(</span>Object<span style="color: #666666">.</span><span style="color: #7D9029">class</span><span style="color: #666666">,</span> cellRenderer<span style="color: #666666">);</span>
        scrollPane<span style="color: #666666">.</span><span style="color: #7D9029">setRowHeaderView</span><span style="color: #666666">(</span>cellRenderer<span style="color: #666666">.</span><span style="color: #7D9029">getRowHeader</span><span style="color: #666666">());</span>

        CellEditor editor <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> CellEditor<span style="color: #666666">();</span>
        editor<span style="color: #666666">.</span><span style="color: #7D9029">setup</span><span style="color: #666666">(</span><span style="color: #008000; font-weight: bold">this</span><span style="color: #666666">);</span>

        <span style="color: #008000; font-weight: bold">for</span> <span style="color: #666666">(</span><span style="color: #B00040">int</span> i <span style="color: #666666">=</span> <span style="color: #666666">0;</span> i <span style="color: #666666">&lt;</span> columnModel<span style="color: #666666">.</span><span style="color: #7D9029">getColumnCount</span><span style="color: #666666">();</span> i<span style="color: #666666">++)</span> <span style="color: #666666">{</span>
            TableColumn col <span style="color: #666666">=</span> columnModel<span style="color: #666666">.</span><span style="color: #7D9029">getColumn</span><span style="color: #666666">(</span>i<span style="color: #666666">);</span>
            col<span style="color: #666666">.</span><span style="color: #7D9029">setPreferredWidth</span><span style="color: #666666">(</span>COLUMN_WIDTH<span style="color: #666666">[</span>i<span style="color: #666666">]);</span>
            col<span style="color: #666666">.</span><span style="color: #7D9029">setCellEditor</span><span style="color: #666666">(</span>editor<span style="color: #666666">);</span>
        <span style="color: #666666">}</span>
        setRowHeight<span style="color: #666666">(</span>getRowHeight<span style="color: #666666">()</span> <span style="color: #666666">+</span> CHAR_HEIGHT<span style="color: #666666">);</span>

        InputMap im <span style="color: #666666">=</span> getInputMap<span style="color: #666666">(</span>JTable<span style="color: #666666">.</span><span style="color: #7D9029">WHEN_FOCUSED</span><span style="color: #666666">);</span>
        ActionMap am <span style="color: #666666">=</span> getActionMap<span style="color: #666666">();</span>
        im<span style="color: #666666">.</span><span style="color: #7D9029">put</span><span style="color: #666666">(</span>KeyStroke<span style="color: #666666">.</span><span style="color: #7D9029">getKeyStroke</span><span style="color: #666666">(</span>KeyEvent<span style="color: #666666">.</span><span style="color: #7D9029">VK_DELETE</span><span style="color: #666666">,</span> <span style="color: #666666">0),</span> <span style="color: #BA2121">&quot;delete&quot;</span><span style="color: #666666">);</span>
        am<span style="color: #666666">.</span><span style="color: #7D9029">put</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;delete&quot;</span><span style="color: #666666">,</span> <span style="color: #008000; font-weight: bold">new</span> AbstractAction<span style="color: #666666">()</span> <span style="color: #666666">{</span>
            <span style="color: #AA22FF">@Override</span>
            <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">actionPerformed</span><span style="color: #666666">(</span>ActionEvent listener<span style="color: #666666">)</span> <span style="color: #666666">{</span>
                <span style="color: #B00040">int</span> row <span style="color: #666666">=</span> getSelectedRow<span style="color: #666666">();</span>
                <span style="color: #B00040">int</span> col <span style="color: #666666">=</span> getSelectedColumn<span style="color: #666666">();</span>

                <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">(</span>row <span style="color: #666666">!=</span> <span style="color: #666666">-1</span> <span style="color: #666666">&amp;&amp;</span> col <span style="color: #666666">!=</span> <span style="color: #666666">-1)</span> <span style="color: #666666">{</span>
                    model<span style="color: #666666">.</span><span style="color: #7D9029">setValueAt</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;0&quot;</span><span style="color: #666666">,</span> row<span style="color: #666666">,</span> col<span style="color: #666666">);</span>
                <span style="color: #666666">}</span>
            <span style="color: #666666">}</span>
        <span style="color: #666666">});</span>

    <span style="color: #666666">}</span>

<span style="color: #666666">}</span></code></pre></div> </div> <div class="paragraph"> <p>Now, particular sub-components of the table will be implemented and described in more detail.</p> </div> </div> <div class="sect3"> <h4 id="memory-table-model"> <a href="#memory-table-model" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Memory table model </h4> <div class="paragraph"> <p>Memory model is the "back-end" of the memory GUI. It means, the model provide data which should be shown in the GUI. You can think of any Swing component as a combination of a "view" and "model" subcomponents. The "view" subcomponent "asks" the model about which data should be shown. By default, almost all Swing components use some default models, accessible directly from the Swing component. Consequently, the components allow to set custom models as well, which is our case.</p> </div> <div class="paragraph"> <p>For a table, the model must implement <code>javax.swing.table.TableModel</code> interface. As it is often a custom, Java implements some general methods in an abstract class called <code>javax.swing.table.AbstractTableModel</code> we can extend from.</p> </div> <div class="admonitionblock note"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> The description of the table model can be found <a href="http://docs.oracle.com/javase/tutorial/uiswing/components/table.html#data">at this link</a>. </td> </tr> </table></div> </div> <div class="paragraph"> <p>The model must provide data for every row and column. So here, we must do some math to compute bits and also transform the data to hex value, and raw ASCII value. The class is called <code>MemoryTableModel</code> and it&#8217;s source code is here:</p> </div> <div class="listingblock"> <div class="title"><code>src/main/java/net/sf/emustudio/ssem/memory/gui/MemoryTableModel.java</code></div> <div class="content"><pre class="pygments highlight"><code data-lang="java"><span style="color: #008000; font-weight: bold">package</span> <span style="color: #0000FF; font-weight: bold">net.sf.emustudio.ssem.memory.gui</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">emulib.plugins.memory.MemoryContext</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">emulib.runtime.NumberUtils</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">emulib.runtime.NumberUtils.Strategy</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">emulib.runtime.RadixUtils</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">org.slf4j.Logger</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">org.slf4j.LoggerFactory</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">javax.swing.table.AbstractTableModel</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">java.util.Objects</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">public</span> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">MemoryTableModel</span> <span style="color: #008000; font-weight: bold">extends</span> AbstractTableModel <span style="color: #666666">{</span>
    <span style="color: #008000; font-weight: bold">private</span> <span style="color: #008000; font-weight: bold">final</span> <span style="color: #008000; font-weight: bold">static</span> Logger LOGGER <span style="color: #666666">=</span> LoggerFactory<span style="color: #666666">.</span><span style="color: #7D9029">getLogger</span><span style="color: #666666">(</span>MemoryTableModel<span style="color: #666666">.</span><span style="color: #7D9029">class</span><span style="color: #666666">);</span>

    <span style="color: #008000; font-weight: bold">final</span> <span style="color: #008000; font-weight: bold">static</span> <span style="color: #B00040">int</span> COLUMN_HEX_VALUE <span style="color: #666666">=</span> <span style="color: #666666">32;</span>
    <span style="color: #008000; font-weight: bold">final</span> <span style="color: #008000; font-weight: bold">static</span> <span style="color: #B00040">int</span> COLUMN_RAW_VALUE <span style="color: #666666">=</span> <span style="color: #666666">33;</span>

    <span style="color: #008000; font-weight: bold">private</span> <span style="color: #008000; font-weight: bold">final</span> <span style="color: #008000; font-weight: bold">static</span> <span style="color: #B00040">int</span> ROW_COUNT <span style="color: #666666">=</span> <span style="color: #666666">32;</span>
    <span style="color: #008000; font-weight: bold">private</span> <span style="color: #008000; font-weight: bold">final</span> <span style="color: #008000; font-weight: bold">static</span> <span style="color: #B00040">int</span> COLUMN_COUNT <span style="color: #666666">=</span> <span style="color: #666666">2</span> <span style="color: #666666">+</span> <span style="color: #666666">32;</span>

    <span style="color: #008000; font-weight: bold">private</span> <span style="color: #008000; font-weight: bold">final</span> MemoryContext<span style="color: #666666">&lt;</span>Byte<span style="color: #666666">&gt;</span> memory<span style="color: #666666">;</span>

    MemoryTableModel<span style="color: #666666">(</span>MemoryContext<span style="color: #666666">&lt;</span>Byte<span style="color: #666666">&gt;</span> memory<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        <span style="color: #008000; font-weight: bold">this</span><span style="color: #666666">.</span><span style="color: #7D9029">memory</span> <span style="color: #666666">=</span> Objects<span style="color: #666666">.</span><span style="color: #7D9029">requireNonNull</span><span style="color: #666666">(</span>memory<span style="color: #666666">);</span>
    <span style="color: #666666">}</span>

    <span style="color: #AA22FF">@Override</span>
    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">int</span> <span style="color: #0000FF">getRowCount</span><span style="color: #666666">()</span> <span style="color: #666666">{</span>
        <span style="color: #008000; font-weight: bold">return</span> ROW_COUNT<span style="color: #666666">;</span>
    <span style="color: #666666">}</span>

    <span style="color: #AA22FF">@Override</span>
    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">int</span> <span style="color: #0000FF">getColumnCount</span><span style="color: #666666">()</span> <span style="color: #666666">{</span>
        <span style="color: #008000; font-weight: bold">return</span> COLUMN_COUNT<span style="color: #666666">;</span>
    <span style="color: #666666">}</span>

    <span style="color: #408080; font-style: italic">/**</span>
<span style="color: #408080; font-style: italic">     * Determine if a column index points at a bit which is part of the 3 bits in a memory cell representing a SSEM</span>
<span style="color: #408080; font-style: italic">     * instruction.</span>
<span style="color: #408080; font-style: italic">     *</span>
<span style="color: #408080; font-style: italic">     * @param column column in the memory table</span>
<span style="color: #408080; font-style: italic">     * @return true if the column represents a SSEM instruction bit</span>
<span style="color: #408080; font-style: italic">     */</span>
    <span style="color: #008000; font-weight: bold">static</span> <span style="color: #B00040">boolean</span> <span style="color: #0000FF">isBitInstruction</span><span style="color: #666666">(</span><span style="color: #B00040">int</span> column<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        <span style="color: #008000; font-weight: bold">return</span> column <span style="color: #666666">&gt;=</span> <span style="color: #666666">13</span> <span style="color: #666666">&amp;&amp;</span> column <span style="color: #666666">&lt;=</span> <span style="color: #666666">15;</span>
    <span style="color: #666666">}</span>

    <span style="color: #408080; font-style: italic">/**</span>
<span style="color: #408080; font-style: italic">     * Determine if a column index points at a bit which is part of the 5 bits in a memory cell representing a &quot;line&quot;,</span>
<span style="color: #408080; font-style: italic">     * or address part of the memory cell.</span>
<span style="color: #408080; font-style: italic">     *</span>
<span style="color: #408080; font-style: italic">     * @param column column in the memory table</span>
<span style="color: #408080; font-style: italic">     * @return true if the column represents a line bit</span>
<span style="color: #408080; font-style: italic">     */</span>
    <span style="color: #008000; font-weight: bold">static</span> <span style="color: #B00040">boolean</span> <span style="color: #0000FF">isBitLine</span><span style="color: #666666">(</span><span style="color: #B00040">int</span> column<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        <span style="color: #008000; font-weight: bold">return</span> column <span style="color: #666666">&gt;=</span> <span style="color: #666666">0</span> <span style="color: #666666">&amp;&amp;</span> column <span style="color: #666666">&lt;</span> <span style="color: #666666">5;</span>
    <span style="color: #666666">}</span>

    <span style="color: #AA22FF">@Override</span>
    <span style="color: #008000; font-weight: bold">public</span> String <span style="color: #0000FF">getColumnName</span><span style="color: #666666">(</span><span style="color: #B00040">int</span> columnIndex<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        <span style="color: #008000; font-weight: bold">switch</span> <span style="color: #666666">(</span>columnIndex<span style="color: #666666">)</span> <span style="color: #666666">{</span>
            <span style="color: #008000; font-weight: bold">case</span> COLUMN_HEX_VALUE<span style="color: #666666">:</span>
                <span style="color: #008000; font-weight: bold">return</span> <span style="color: #BA2121">&quot;Value (hex)&quot;</span><span style="color: #666666">;</span>
            <span style="color: #008000; font-weight: bold">case</span> COLUMN_RAW_VALUE<span style="color: #666666">:</span>
                <span style="color: #008000; font-weight: bold">return</span> <span style="color: #BA2121">&quot;Raw&quot;</span><span style="color: #666666">;</span>
        <span style="color: #666666">}</span>
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">(</span>isBitLine<span style="color: #666666">(</span>columnIndex<span style="color: #666666">))</span> <span style="color: #666666">{</span>
            <span style="color: #008000; font-weight: bold">return</span> <span style="color: #BA2121">&quot;L&quot;</span><span style="color: #666666">;</span>
        <span style="color: #666666">}</span>
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">(</span>isBitInstruction<span style="color: #666666">(</span>columnIndex<span style="color: #666666">))</span> <span style="color: #666666">{</span>
            <span style="color: #008000; font-weight: bold">return</span> <span style="color: #BA2121">&quot;I&quot;</span><span style="color: #666666">;</span>
        <span style="color: #666666">}</span>
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #BA2121">&quot;&quot;</span><span style="color: #666666">;</span>
    <span style="color: #666666">}</span>

    <span style="color: #008000; font-weight: bold">private</span> <span style="color: #B00040">byte</span><span style="color: #666666">[]</span> <span style="color: #0000FF">readLineBits</span><span style="color: #666666">(</span>Byte<span style="color: #666666">[]</span> line<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        <span style="color: #B00040">byte</span><span style="color: #666666">[]</span> lineBits <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> <span style="color: #B00040">byte</span><span style="color: #666666">[32];</span>

        <span style="color: #B00040">int</span> j <span style="color: #666666">=</span> <span style="color: #666666">0;</span>
        <span style="color: #008000; font-weight: bold">for</span> <span style="color: #666666">(</span><span style="color: #B00040">byte</span> b <span style="color: #666666">:</span> line<span style="color: #666666">)</span> <span style="color: #666666">{</span>
            <span style="color: #008000; font-weight: bold">for</span> <span style="color: #666666">(</span><span style="color: #B00040">int</span> i <span style="color: #666666">=</span> <span style="color: #666666">7;</span> i <span style="color: #666666">&gt;=</span> <span style="color: #666666">0;</span> i<span style="color: #666666">--)</span> <span style="color: #666666">{</span>
                lineBits<span style="color: #666666">[</span>j<span style="color: #666666">++]</span> <span style="color: #666666">=</span> <span style="color: #666666">(</span><span style="color: #B00040">byte</span><span style="color: #666666">)((</span>b <span style="color: #666666">&gt;&gt;&gt;</span> i<span style="color: #666666">)</span> <span style="color: #666666">&amp;</span> <span style="color: #666666">1);</span>
            <span style="color: #666666">}</span>
        <span style="color: #666666">}</span>
        <span style="color: #008000; font-weight: bold">return</span> lineBits<span style="color: #666666">;</span>
    <span style="color: #666666">}</span>

    <span style="color: #AA22FF">@Override</span>
    <span style="color: #008000; font-weight: bold">public</span> Object <span style="color: #0000FF">getValueAt</span><span style="color: #666666">(</span><span style="color: #B00040">int</span> rowIndex<span style="color: #666666">,</span> <span style="color: #B00040">int</span> columnIndex<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        <span style="color: #008000; font-weight: bold">try</span> <span style="color: #666666">{</span>
            Byte<span style="color: #666666">[]</span> row <span style="color: #666666">=</span> memory<span style="color: #666666">.</span><span style="color: #7D9029">readWord</span><span style="color: #666666">(</span>rowIndex <span style="color: #666666">*</span> <span style="color: #666666">4);</span>
            <span style="color: #B00040">int</span> value <span style="color: #666666">=</span> NumberUtils<span style="color: #666666">.</span><span style="color: #7D9029">readInt</span><span style="color: #666666">(</span>row<span style="color: #666666">,</span> Strategy<span style="color: #666666">.</span><span style="color: #7D9029">REVERSE_BITS</span><span style="color: #666666">);</span>

            <span style="color: #008000; font-weight: bold">switch</span> <span style="color: #666666">(</span>columnIndex<span style="color: #666666">)</span> <span style="color: #666666">{</span>
                <span style="color: #008000; font-weight: bold">case</span> COLUMN_HEX_VALUE<span style="color: #666666">:</span>
                    <span style="color: #008000; font-weight: bold">return</span> RadixUtils<span style="color: #666666">.</span><span style="color: #7D9029">formatDwordHexString</span><span style="color: #666666">(</span>value<span style="color: #666666">).</span><span style="color: #7D9029">toUpperCase</span><span style="color: #666666">();</span>
                <span style="color: #008000; font-weight: bold">case</span> COLUMN_RAW_VALUE<span style="color: #666666">:</span>
                    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #BA2121">&quot;&quot;</span> <span style="color: #666666">+</span> <span style="color: #666666">(</span><span style="color: #B00040">char</span><span style="color: #666666">)((</span>value <span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #666666">24)</span> <span style="color: #666666">&amp;</span> <span style="color: #666666">0xFF)</span> <span style="color: #666666">+</span> <span style="color: #666666">(</span><span style="color: #B00040">char</span><span style="color: #666666">)((</span>value <span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #666666">16)</span> <span style="color: #666666">&amp;</span> <span style="color: #666666">0xFF)</span>
                            <span style="color: #666666">+</span> <span style="color: #666666">(</span><span style="color: #B00040">char</span><span style="color: #666666">)((</span>value <span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #666666">8)</span> <span style="color: #666666">&amp;</span> <span style="color: #666666">0xFF)</span> <span style="color: #666666">+</span> <span style="color: #666666">(</span><span style="color: #B00040">char</span><span style="color: #666666">)(</span>value <span style="color: #666666">&amp;</span> <span style="color: #666666">0xFF);</span>
                <span style="color: #008000; font-weight: bold">default</span><span style="color: #666666">:</span>
                    <span style="color: #B00040">byte</span><span style="color: #666666">[]</span> lineBits <span style="color: #666666">=</span> readLineBits<span style="color: #666666">(</span>row<span style="color: #666666">);</span>
                    <span style="color: #008000; font-weight: bold">return</span> lineBits<span style="color: #666666">[</span>columnIndex<span style="color: #666666">];</span>
            <span style="color: #666666">}</span>
        <span style="color: #666666">}</span> <span style="color: #008000; font-weight: bold">catch</span> <span style="color: #666666">(</span>Exception e<span style="color: #666666">)</span> <span style="color: #666666">{</span>
            LOGGER<span style="color: #666666">.</span><span style="color: #7D9029">debug</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;[line={}] Could not read value from memory&quot;</span><span style="color: #666666">,</span> rowIndex<span style="color: #666666">,</span> e<span style="color: #666666">);</span>
        <span style="color: #666666">}</span>
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #BA2121">&quot;&quot;</span><span style="color: #666666">;</span>
    <span style="color: #666666">}</span>

    <span style="color: #AA22FF">@Override</span>
    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">setValueAt</span><span style="color: #666666">(</span>Object aValue<span style="color: #666666">,</span> <span style="color: #B00040">int</span> rowIndex<span style="color: #666666">,</span> <span style="color: #B00040">int</span> columnIndex<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">(</span>isCellEditable<span style="color: #666666">(</span>rowIndex<span style="color: #666666">,</span> columnIndex<span style="color: #666666">))</span> <span style="color: #666666">{</span>
            <span style="color: #008000; font-weight: bold">try</span> <span style="color: #666666">{</span>
                Byte<span style="color: #666666">[]</span> row <span style="color: #666666">=</span> memory<span style="color: #666666">.</span><span style="color: #7D9029">readWord</span><span style="color: #666666">(</span>rowIndex <span style="color: #666666">*</span> <span style="color: #666666">4);</span>
                String str <span style="color: #666666">=</span> String<span style="color: #666666">.</span><span style="color: #7D9029">valueOf</span><span style="color: #666666">(</span>aValue<span style="color: #666666">);</span>

                <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">(</span>columnIndex <span style="color: #666666">==</span> COLUMN_HEX_VALUE<span style="color: #666666">)</span> <span style="color: #666666">{</span>
                    writeHex<span style="color: #666666">(</span>str<span style="color: #666666">,</span> row<span style="color: #666666">);</span>
                <span style="color: #666666">}</span> <span style="color: #008000; font-weight: bold">else</span> <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">(</span>columnIndex <span style="color: #666666">==</span> COLUMN_RAW_VALUE<span style="color: #666666">)</span> <span style="color: #666666">{</span>
                    writeChar<span style="color: #666666">((</span>String<span style="color: #666666">)</span>aValue<span style="color: #666666">,</span> row<span style="color: #666666">);</span>
                <span style="color: #666666">}</span> <span style="color: #008000; font-weight: bold">else</span> <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">(</span>columnIndex <span style="color: #666666">&gt;=</span> <span style="color: #666666">0</span> <span style="color: #666666">&amp;&amp;</span> columnIndex <span style="color: #666666">&lt;</span> <span style="color: #666666">33)</span> <span style="color: #666666">{</span>
                    writeBit<span style="color: #666666">(</span>str<span style="color: #666666">,</span> columnIndex<span style="color: #666666">,</span> row<span style="color: #666666">);</span>
                <span style="color: #666666">}</span>
                memory<span style="color: #666666">.</span><span style="color: #7D9029">writeWord</span><span style="color: #666666">(</span>rowIndex <span style="color: #666666">*</span> <span style="color: #666666">4,</span> row<span style="color: #666666">);</span>

                fireTableCellUpdated<span style="color: #666666">(</span>rowIndex<span style="color: #666666">,</span> columnIndex<span style="color: #666666">);</span>
            <span style="color: #666666">}</span> <span style="color: #008000; font-weight: bold">catch</span> <span style="color: #666666">(</span>Exception e<span style="color: #666666">)</span> <span style="color: #666666">{</span>
                LOGGER<span style="color: #666666">.</span><span style="color: #7D9029">debug</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;[line={}, value={}] Could not set value to memory&quot;</span><span style="color: #666666">,</span> rowIndex<span style="color: #666666">,</span> aValue<span style="color: #666666">,</span> e<span style="color: #666666">);</span>
            <span style="color: #666666">}</span>
        <span style="color: #666666">}</span>
    <span style="color: #666666">}</span>

    <span style="color: #008000; font-weight: bold">private</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">writeHex</span><span style="color: #666666">(</span>String aValue<span style="color: #666666">,</span> Byte<span style="color: #666666">[]</span> row<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        <span style="color: #B00040">int</span> value <span style="color: #666666">=</span> Integer<span style="color: #666666">.</span><span style="color: #7D9029">decode</span><span style="color: #666666">(</span>aValue<span style="color: #666666">);</span>
        NumberUtils<span style="color: #666666">.</span><span style="color: #7D9029">writeInt</span><span style="color: #666666">(</span>value<span style="color: #666666">,</span> row<span style="color: #666666">,</span> Strategy<span style="color: #666666">.</span><span style="color: #7D9029">REVERSE_BITS</span><span style="color: #666666">);</span>
    <span style="color: #666666">}</span>

    <span style="color: #008000; font-weight: bold">private</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">writeChar</span><span style="color: #666666">(</span>String aValue<span style="color: #666666">,</span> Byte<span style="color: #666666">[]</span> row<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        <span style="color: #B00040">int</span> i <span style="color: #666666">=</span> <span style="color: #666666">3;</span>
        <span style="color: #B00040">int</span> value <span style="color: #666666">=</span> <span style="color: #666666">0;</span>

        <span style="color: #008000; font-weight: bold">for</span> <span style="color: #666666">(</span><span style="color: #B00040">char</span> c <span style="color: #666666">:</span> aValue<span style="color: #666666">.</span><span style="color: #7D9029">toCharArray</span><span style="color: #666666">())</span> <span style="color: #666666">{</span>
            value <span style="color: #666666">|=</span> <span style="color: #666666">((</span>c <span style="color: #666666">&amp;</span> <span style="color: #666666">0xFF)</span> <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">(</span>i<span style="color: #666666">*8));</span>
            i <span style="color: #666666">-=</span> <span style="color: #666666">1;</span>
            <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">(</span>i <span style="color: #666666">&lt;</span> <span style="color: #666666">0)</span> <span style="color: #666666">{</span>
                <span style="color: #008000; font-weight: bold">break</span><span style="color: #666666">;</span>
            <span style="color: #666666">}</span>
        <span style="color: #666666">}</span>
        NumberUtils<span style="color: #666666">.</span><span style="color: #7D9029">writeInt</span><span style="color: #666666">(</span>value<span style="color: #666666">,</span> row<span style="color: #666666">,</span> Strategy<span style="color: #666666">.</span><span style="color: #7D9029">REVERSE_BITS</span><span style="color: #666666">);</span>
    <span style="color: #666666">}</span>

    <span style="color: #008000; font-weight: bold">private</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">writeBit</span><span style="color: #666666">(</span>String aValue<span style="color: #666666">,</span> <span style="color: #B00040">int</span> columnIndex<span style="color: #666666">,</span> Byte<span style="color: #666666">[]</span> row<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        <span style="color: #B00040">int</span> value<span style="color: #666666">;</span>
        value <span style="color: #666666">=</span> Integer<span style="color: #666666">.</span><span style="color: #7D9029">parseInt</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;0&quot;</span> <span style="color: #666666">+</span> aValue<span style="color: #666666">,</span> <span style="color: #666666">2);</span>

        <span style="color: #B00040">int</span> byteIndex <span style="color: #666666">=</span> columnIndex <span style="color: #666666">/</span> <span style="color: #666666">8;</span>
        <span style="color: #B00040">int</span> bitIndex <span style="color: #666666">=</span> <span style="color: #666666">7</span> <span style="color: #666666">-</span> columnIndex <span style="color: #666666">%</span> <span style="color: #666666">8;</span>

        <span style="color: #B00040">int</span> bitMask <span style="color: #666666">=</span> <span style="color: #666666">~(1</span> <span style="color: #666666">&lt;&lt;</span> bitIndex<span style="color: #666666">);</span>
        <span style="color: #B00040">int</span> bitValue <span style="color: #666666">=</span> <span style="color: #666666">(</span>value <span style="color: #666666">&lt;&lt;</span> bitIndex<span style="color: #666666">);</span>

        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">((</span>value <span style="color: #666666">&amp;</span> <span style="color: #666666">1)</span> <span style="color: #666666">!=</span> value<span style="color: #666666">)</span> <span style="color: #666666">{</span>
            LOGGER<span style="color: #666666">.</span><span style="color: #7D9029">error</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;[line={}, bit={}, value={}] Could not set bit value. Expected 0 or 1&quot;</span><span style="color: #666666">,</span> byteIndex<span style="color: #666666">,</span> bitIndex<span style="color: #666666">,</span> value<span style="color: #666666">);</span>
        <span style="color: #666666">}</span> <span style="color: #008000; font-weight: bold">else</span> <span style="color: #666666">{</span>
            row<span style="color: #666666">[</span>byteIndex<span style="color: #666666">]</span> <span style="color: #666666">=</span> <span style="color: #666666">(</span><span style="color: #B00040">byte</span><span style="color: #666666">)(</span>row<span style="color: #666666">[</span>byteIndex<span style="color: #666666">]</span> <span style="color: #666666">&amp;</span> bitMask <span style="color: #666666">|</span> bitValue<span style="color: #666666">);</span>
        <span style="color: #666666">}</span>
    <span style="color: #666666">}</span>


    <span style="color: #AA22FF">@Override</span>
    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">boolean</span> <span style="color: #0000FF">isCellEditable</span><span style="color: #666666">(</span><span style="color: #B00040">int</span> rowIndex<span style="color: #666666">,</span> <span style="color: #B00040">int</span> columnIndex<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        <span style="color: #008000; font-weight: bold">return</span> columnIndex <span style="color: #666666">&gt;=</span> <span style="color: #666666">0</span> <span style="color: #666666">&amp;&amp;</span> columnIndex <span style="color: #666666">&lt;=</span> <span style="color: #666666">33;</span>
    <span style="color: #666666">}</span>

    <span style="color: #B00040">void</span> <span style="color: #0000FF">dataChangedAt</span><span style="color: #666666">(</span><span style="color: #B00040">int</span> address<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        <span style="color: #008000; font-weight: bold">for</span> <span style="color: #666666">(</span><span style="color: #B00040">int</span> i <span style="color: #666666">=</span> <span style="color: #666666">0;</span> i <span style="color: #666666">&lt;</span> COLUMN_COUNT<span style="color: #666666">;</span> i<span style="color: #666666">++)</span> <span style="color: #666666">{</span>
            fireTableCellUpdated<span style="color: #666666">(</span>address<span style="color: #666666">,</span> i<span style="color: #666666">);</span>
        <span style="color: #666666">}</span>
    <span style="color: #666666">}</span>

    <span style="color: #B00040">void</span> <span style="color: #0000FF">clear</span><span style="color: #666666">()</span> <span style="color: #666666">{</span>
        memory<span style="color: #666666">.</span><span style="color: #7D9029">clear</span><span style="color: #666666">();</span>
        fireTableDataChanged<span style="color: #666666">();</span>
    <span style="color: #666666">}</span>

<span style="color: #666666">}</span></code></pre></div> </div> </div> <div class="sect3"> <h4 id="row-header-renderer"> <a href="#row-header-renderer" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Row header renderer </h4> <div class="paragraph"> <p>Programming a GUI in Java Swing can be tricky. If we want something non-standard, the way of customization can be very non-obvious = painful. This is the case when we want to do a "header"-like column in a <code>JTable</code>. Long story short - this trick lies in a use of <code>JScrollPane</code>. This component implements a viewport, something as a virtual screen, allowing to put there some other components, and make visible only a part of this screen. Besides, it has a feature which is called a "row header". It has a <a href="https://docs.oracle.com/javase/8/docs/api/javax/swing/JScrollPane.html#setRowHeaderView-java.awt.Component-">dedicated method</a> for setting up a custom row header:</p> </div> <div class="literalblock"> <div class="content"><pre>JScrollPane.setRowHeaderView(Component view)</pre></div> </div> <div class="paragraph"> <p>The trick is to set a <code>javax.swing.JList</code> as a component for the row header. So we end up with the following class:</p> </div> <div class="listingblock"> <div class="title"><code>src/main/java/net/sf/emustudio/ssem/memory/gui/RowHeaderRenderer.java</code></div> <div class="content"><pre class="pygments highlight"><code data-lang="java"><span style="color: #008000; font-weight: bold">package</span> <span style="color: #0000FF; font-weight: bold">net.sf.emustudio.ssem.memory.gui</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">javax.swing.JLabel</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">javax.swing.JList</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">javax.swing.JTable</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">javax.swing.ListCellRenderer</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">javax.swing.UIManager</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">javax.swing.table.JTableHeader</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">java.awt.Component</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">java.awt.Dimension</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">import static</span> <span style="color: #0000FF; font-weight: bold">net.sf.emustudio.ssem.memory.gui.Constants.CHAR_HEIGHT</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import static</span> <span style="color: #0000FF; font-weight: bold">net.sf.emustudio.ssem.memory.gui.Constants.CHAR_WIDTH</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import static</span> <span style="color: #0000FF; font-weight: bold">net.sf.emustudio.ssem.memory.gui.Constants.DEFAULT_FONT</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">RowHeaderRenderer</span> <span style="color: #008000; font-weight: bold">extends</span> JLabel <span style="color: #008000; font-weight: bold">implements</span> ListCellRenderer <span style="color: #666666">{</span>
    <span style="color: #008000; font-weight: bold">private</span> <span style="color: #008000; font-weight: bold">final</span> <span style="color: #008000; font-weight: bold">static</span> <span style="color: #B00040">int</span> NO_COLUMN_WIDTH <span style="color: #666666">=</span> CHAR_WIDTH <span style="color: #666666">*</span> <span style="color: #666666">4;</span>

    <span style="color: #008000; font-weight: bold">private</span> <span style="color: #B00040">int</span> height<span style="color: #666666">;</span>

    RowHeaderRenderer<span style="color: #666666">()</span> <span style="color: #666666">{</span>
        <span style="color: #008000; font-weight: bold">super</span><span style="color: #666666">.</span><span style="color: #7D9029">setOpaque</span><span style="color: #666666">(</span><span style="color: #008000; font-weight: bold">true</span><span style="color: #666666">);</span>
        <span style="color: #008000; font-weight: bold">super</span><span style="color: #666666">.</span><span style="color: #7D9029">setBorder</span><span style="color: #666666">(</span>UIManager<span style="color: #666666">.</span><span style="color: #7D9029">getBorder</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;TableHeader.cellBorder&quot;</span><span style="color: #666666">));</span>
        <span style="color: #008000; font-weight: bold">super</span><span style="color: #666666">.</span><span style="color: #7D9029">setHorizontalAlignment</span><span style="color: #666666">(</span>CENTER<span style="color: #666666">);</span>
        <span style="color: #008000; font-weight: bold">super</span><span style="color: #666666">.</span><span style="color: #7D9029">setFont</span><span style="color: #666666">(</span>DEFAULT_FONT<span style="color: #666666">);</span>
    <span style="color: #666666">}</span>

    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">setup</span><span style="color: #666666">(</span>JTable table<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        JTableHeader header <span style="color: #666666">=</span> table<span style="color: #666666">.</span><span style="color: #7D9029">getTableHeader</span><span style="color: #666666">();</span>
        <span style="color: #008000; font-weight: bold">this</span><span style="color: #666666">.</span><span style="color: #7D9029">height</span> <span style="color: #666666">=</span> header<span style="color: #666666">.</span><span style="color: #7D9029">getPreferredSize</span><span style="color: #666666">().</span><span style="color: #7D9029">height</span> <span style="color: #666666">+</span> CHAR_HEIGHT<span style="color: #666666">;</span>
        setForeground<span style="color: #666666">(</span>header<span style="color: #666666">.</span><span style="color: #7D9029">getForeground</span><span style="color: #666666">());</span>
        setBackground<span style="color: #666666">(</span>header<span style="color: #666666">.</span><span style="color: #7D9029">getBackground</span><span style="color: #666666">());</span>
    <span style="color: #666666">}</span>

    <span style="color: #AA22FF">@Override</span>
    <span style="color: #008000; font-weight: bold">public</span> Component <span style="color: #0000FF">getListCellRendererComponent</span><span style="color: #666666">(</span>JList list<span style="color: #666666">,</span> Object value<span style="color: #666666">,</span> <span style="color: #B00040">int</span> index<span style="color: #666666">,</span> <span style="color: #B00040">boolean</span> isSelected<span style="color: #666666">,</span> <span style="color: #B00040">boolean</span> cellHasFocus<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        setPreferredSize<span style="color: #666666">(</span><span style="color: #008000; font-weight: bold">new</span> Dimension<span style="color: #666666">(</span>NO_COLUMN_WIDTH<span style="color: #666666">,</span> height<span style="color: #666666">));</span>
        setText<span style="color: #666666">((</span>value <span style="color: #666666">==</span> <span style="color: #008000; font-weight: bold">null</span><span style="color: #666666">)</span> <span style="color: #666666">?</span> <span style="color: #BA2121">&quot;&quot;</span> <span style="color: #666666">:</span> value<span style="color: #666666">.</span><span style="color: #7D9029">toString</span><span style="color: #666666">());</span>
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000; font-weight: bold">this</span><span style="color: #666666">;</span>
    <span style="color: #666666">}</span>

<span style="color: #666666">}</span></code></pre></div> </div> </div> <div class="sect3"> <h4 id="cell-renderer-editor"> <a href="#cell-renderer-editor" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Cell renderer + editor </h4> <div class="paragraph"> <p>The last two things we need is to display text using different fonts on certain cells. For example, we want that line and instruction bits have bold font, and others plain one. But - it is generally more readable if the data are shown in some monospaced font variant. These customizations are "big enough" to require custom class - a cell renderer.</p> </div> <div class="admonitionblock note"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> Official tutorial and description of custom renderers can be found <a href="http://docs.oracle.com/javase/tutorial/uiswing/components/table.html#renderer">at this link</a>. </td> </tr> </table></div> </div> <div class="paragraph"> <p>The cell renderer code looks as follows:</p> </div> <div class="listingblock"> <div class="title"><code>src/main/java/net/sf/emustudio/ssem/memory/gui/CellRenderer.java</code></div> <div class="content"><pre class="pygments highlight"><code data-lang="java"><span style="color: #008000; font-weight: bold">package</span> <span style="color: #0000FF; font-weight: bold">net.sf.emustudio.ssem.memory.gui</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">java.awt.Color</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">java.awt.Component</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">javax.swing.JLabel</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">javax.swing.JList</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">javax.swing.JTable</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">javax.swing.table.TableCellRenderer</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import static</span> <span style="color: #0000FF; font-weight: bold">net.sf.emustudio.ssem.memory.gui.Constants.BOLD_FONT</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import static</span> <span style="color: #0000FF; font-weight: bold">net.sf.emustudio.ssem.memory.gui.Constants.CHAR_HEIGHT</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import static</span> <span style="color: #0000FF; font-weight: bold">net.sf.emustudio.ssem.memory.gui.Constants.COLOR_CELL_BACK</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import static</span> <span style="color: #0000FF; font-weight: bold">net.sf.emustudio.ssem.memory.gui.Constants.COLOR_CELL_BACK_MOD2</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import static</span> <span style="color: #0000FF; font-weight: bold">net.sf.emustudio.ssem.memory.gui.Constants.COLOR_FORE</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import static</span> <span style="color: #0000FF; font-weight: bold">net.sf.emustudio.ssem.memory.gui.Constants.COLOR_FORE_UNIMPORTANT</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import static</span> <span style="color: #0000FF; font-weight: bold">net.sf.emustudio.ssem.memory.gui.Constants.DEFAULT_FONT</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">CellRenderer</span> <span style="color: #008000; font-weight: bold">extends</span> JLabel <span style="color: #008000; font-weight: bold">implements</span> TableCellRenderer <span style="color: #666666">{</span>
    <span style="color: #008000; font-weight: bold">private</span> <span style="color: #008000; font-weight: bold">final</span> JList rowHeader<span style="color: #666666">;</span>
    <span style="color: #008000; font-weight: bold">private</span> <span style="color: #008000; font-weight: bold">final</span> String<span style="color: #666666">[]</span> rowNames<span style="color: #666666">;</span>
    <span style="color: #008000; font-weight: bold">private</span> <span style="color: #008000; font-weight: bold">final</span> RowHeaderRenderer rowHeaderRenderer<span style="color: #666666">;</span>

    <span style="color: #008000; font-weight: bold">private</span> Color selectionForeground<span style="color: #666666">;</span>
    <span style="color: #008000; font-weight: bold">private</span> Color selectionBackground<span style="color: #666666">;</span>

    CellRenderer<span style="color: #666666">(</span><span style="color: #008000; font-weight: bold">final</span> MemoryTableModel model<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        <span style="color: #008000; font-weight: bold">this</span><span style="color: #666666">.</span><span style="color: #7D9029">rowHeaderRenderer</span> <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> RowHeaderRenderer<span style="color: #666666">();</span>

        rowNames <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> String<span style="color: #666666">[</span>model<span style="color: #666666">.</span><span style="color: #7D9029">getColumnCount</span><span style="color: #666666">()];</span>
        <span style="color: #008000; font-weight: bold">for</span> <span style="color: #666666">(</span><span style="color: #B00040">int</span> i <span style="color: #666666">=</span> <span style="color: #666666">0;</span> i <span style="color: #666666">&lt;</span> rowNames<span style="color: #666666">.</span><span style="color: #7D9029">length</span><span style="color: #666666">;</span> i<span style="color: #666666">++)</span> <span style="color: #666666">{</span>
            rowNames<span style="color: #666666">[</span>i<span style="color: #666666">]</span> <span style="color: #666666">=</span> String<span style="color: #666666">.</span><span style="color: #7D9029">format</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;%02X&quot;</span><span style="color: #666666">,</span> i<span style="color: #666666">);</span>
        <span style="color: #666666">}</span>
        rowHeader <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> JList<span style="color: #666666">(</span>rowNames<span style="color: #666666">);</span>
        rowHeader<span style="color: #666666">.</span><span style="color: #7D9029">setCellRenderer</span><span style="color: #666666">(</span>rowHeaderRenderer<span style="color: #666666">);</span>

        <span style="color: #008000; font-weight: bold">super</span><span style="color: #666666">.</span><span style="color: #7D9029">setOpaque</span><span style="color: #666666">(</span><span style="color: #008000; font-weight: bold">true</span><span style="color: #666666">);</span>
        <span style="color: #008000; font-weight: bold">super</span><span style="color: #666666">.</span><span style="color: #7D9029">setFont</span><span style="color: #666666">(</span>DEFAULT_FONT<span style="color: #666666">);</span>
        <span style="color: #008000; font-weight: bold">super</span><span style="color: #666666">.</span><span style="color: #7D9029">setHorizontalAlignment</span><span style="color: #666666">(</span>CENTER<span style="color: #666666">);</span>
    <span style="color: #666666">}</span>

    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">setup</span><span style="color: #666666">(</span>JTable table<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        rowHeader<span style="color: #666666">.</span><span style="color: #7D9029">setFixedCellHeight</span><span style="color: #666666">(</span>table<span style="color: #666666">.</span><span style="color: #7D9029">getRowHeight</span><span style="color: #666666">()</span> <span style="color: #666666">+</span> CHAR_HEIGHT<span style="color: #666666">);</span>
        rowHeaderRenderer<span style="color: #666666">.</span><span style="color: #7D9029">setup</span><span style="color: #666666">(</span>table<span style="color: #666666">);</span>

        selectionBackground <span style="color: #666666">=</span> table<span style="color: #666666">.</span><span style="color: #7D9029">getSelectionBackground</span><span style="color: #666666">();</span>
        selectionForeground <span style="color: #666666">=</span> table<span style="color: #666666">.</span><span style="color: #7D9029">getSelectionForeground</span><span style="color: #666666">();</span>
    <span style="color: #666666">}</span>

    <span style="color: #008000; font-weight: bold">public</span> JList <span style="color: #0000FF">getRowHeader</span><span style="color: #666666">()</span> <span style="color: #666666">{</span>
        <span style="color: #008000; font-weight: bold">return</span> rowHeader<span style="color: #666666">;</span>
    <span style="color: #666666">}</span>

    <span style="color: #AA22FF">@Override</span>
    <span style="color: #008000; font-weight: bold">public</span> Component <span style="color: #0000FF">getTableCellRendererComponent</span><span style="color: #666666">(</span>JTable table<span style="color: #666666">,</span> Object value<span style="color: #666666">,</span> <span style="color: #B00040">boolean</span> isSelected<span style="color: #666666">,</span> <span style="color: #B00040">boolean</span> hasFocus<span style="color: #666666">,</span> <span style="color: #B00040">int</span> row<span style="color: #666666">,</span> <span style="color: #B00040">int</span> column<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">(</span>isSelected<span style="color: #666666">)</span> <span style="color: #666666">{</span>
            setBackground<span style="color: #666666">(</span>selectionBackground<span style="color: #666666">);</span>
            setForeground<span style="color: #666666">(</span>selectionForeground<span style="color: #666666">);</span>
        <span style="color: #666666">}</span> <span style="color: #008000; font-weight: bold">else</span> <span style="color: #666666">{</span>
            Color back <span style="color: #666666">=</span> <span style="color: #666666">((</span>row <span style="color: #666666">%</span> <span style="color: #666666">2)</span> <span style="color: #666666">==</span> <span style="color: #666666">0)</span> <span style="color: #666666">?</span> COLOR_CELL_BACK <span style="color: #666666">:</span> COLOR_CELL_BACK_MOD2<span style="color: #666666">;</span>
            Color front <span style="color: #666666">=</span> COLOR_FORE_UNIMPORTANT<span style="color: #666666">;</span>

            <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">(</span>MemoryTableModel<span style="color: #666666">.</span><span style="color: #7D9029">isBitInstruction</span><span style="color: #666666">(</span>column<span style="color: #666666">)</span> <span style="color: #666666">||</span> MemoryTableModel<span style="color: #666666">.</span><span style="color: #7D9029">isBitLine</span><span style="color: #666666">(</span>column<span style="color: #666666">))</span> <span style="color: #666666">{</span>
                setFont<span style="color: #666666">(</span>BOLD_FONT<span style="color: #666666">);</span>
                front <span style="color: #666666">=</span> COLOR_FORE<span style="color: #666666">;</span>
            <span style="color: #666666">}</span> <span style="color: #008000; font-weight: bold">else</span> <span style="color: #666666">{</span>
                setFont<span style="color: #666666">(</span>DEFAULT_FONT<span style="color: #666666">);</span>
            <span style="color: #666666">}</span>

            setBackground<span style="color: #666666">(</span>back<span style="color: #666666">);</span>
            setForeground<span style="color: #666666">(</span>front<span style="color: #666666">);</span>
        <span style="color: #666666">}</span>
        setText<span style="color: #666666">(</span>value<span style="color: #666666">.</span><span style="color: #7D9029">toString</span><span style="color: #666666">());</span>
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000; font-weight: bold">this</span><span style="color: #666666">;</span>
    <span style="color: #666666">}</span>

<span style="color: #666666">}</span></code></pre></div> </div> <div class="paragraph"> <p>Similarly, if we want to let user edit a value in a table, we must provide the editor as a Swing component. The "cell editor" is in fact plain <code>javax.swing.JTextField</code> with some customizations. However if we want to use it, we must wrap it in a separate class, which needs to extend <code>AbstractCellEditor</code> and implement <code>TableCellEditor</code>.</p> </div> <div class="paragraph"> <p>Our customizations involve accommodating the width of the text field, and preparing the initial value when the editor shows up. User can activate the editor by double-clicking on a cell. The source code of the cell editor is as follows:</p> </div> <div class="listingblock"> <div class="title"><code>src/main/java/net/sf/emustudio/ssem/memory/gui/CellEditor.java</code></div> <div class="content"><pre class="pygments highlight"><code data-lang="java"><span style="color: #008000; font-weight: bold">package</span> <span style="color: #0000FF; font-weight: bold">net.sf.emustudio.ssem.memory.gui</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">java.awt.Component</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">java.awt.FontMetrics</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">javax.swing.AbstractCellEditor</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">javax.swing.JTable</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">javax.swing.JTextField</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">javax.swing.table.TableCellEditor</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import static</span> <span style="color: #0000FF; font-weight: bold">net.sf.emustudio.ssem.memory.gui.Constants.CHAR_HEIGHT</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import static</span> <span style="color: #0000FF; font-weight: bold">net.sf.emustudio.ssem.memory.gui.Constants.COLUMN_WIDTH</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import static</span> <span style="color: #0000FF; font-weight: bold">net.sf.emustudio.ssem.memory.gui.Constants.DEFAULT_FONT</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import static</span> <span style="color: #0000FF; font-weight: bold">net.sf.emustudio.ssem.memory.gui.MemoryTableModel.COLUMN_HEX_VALUE</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import static</span> <span style="color: #0000FF; font-weight: bold">net.sf.emustudio.ssem.memory.gui.MemoryTableModel.COLUMN_RAW_VALUE</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">CellEditor</span> <span style="color: #008000; font-weight: bold">extends</span> AbstractCellEditor <span style="color: #008000; font-weight: bold">implements</span> TableCellEditor <span style="color: #666666">{</span>
    <span style="color: #008000; font-weight: bold">private</span> <span style="color: #008000; font-weight: bold">final</span> JTextField editComponent <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> JTextField<span style="color: #666666">();</span>
    <span style="color: #008000; font-weight: bold">private</span> FontMetrics fontMetrics<span style="color: #666666">;</span>

    <span style="color: #008000; font-weight: bold">private</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">setComponentSize</span><span style="color: #666666">(</span><span style="color: #B00040">int</span> columnIndex<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">(</span>fontMetrics <span style="color: #666666">!=</span> <span style="color: #008000; font-weight: bold">null</span><span style="color: #666666">)</span> <span style="color: #666666">{</span>
            editComponent<span style="color: #666666">.</span><span style="color: #7D9029">setSize</span><span style="color: #666666">(</span>COLUMN_WIDTH<span style="color: #666666">[</span>columnIndex<span style="color: #666666">],</span> fontMetrics<span style="color: #666666">.</span><span style="color: #7D9029">getHeight</span><span style="color: #666666">()</span> <span style="color: #666666">+</span> CHAR_HEIGHT<span style="color: #666666">);</span>
            editComponent<span style="color: #666666">.</span><span style="color: #7D9029">setBorder</span><span style="color: #666666">(</span><span style="color: #008000; font-weight: bold">null</span><span style="color: #666666">);</span>
        <span style="color: #666666">}</span>
    <span style="color: #666666">}</span>

    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">setup</span><span style="color: #666666">(</span>JTable table<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        fontMetrics <span style="color: #666666">=</span> table<span style="color: #666666">.</span><span style="color: #7D9029">getFontMetrics</span><span style="color: #666666">(</span>DEFAULT_FONT<span style="color: #666666">);</span>
    <span style="color: #666666">}</span>

    <span style="color: #AA22FF">@Override</span>
    <span style="color: #008000; font-weight: bold">public</span> Component <span style="color: #0000FF">getTableCellEditorComponent</span><span style="color: #666666">(</span>JTable table<span style="color: #666666">,</span> Object value<span style="color: #666666">,</span> <span style="color: #B00040">boolean</span> isSelected<span style="color: #666666">,</span> <span style="color: #B00040">int</span> rowIndex<span style="color: #666666">,</span> <span style="color: #B00040">int</span> columnIndex<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">(!</span>isSelected<span style="color: #666666">)</span> <span style="color: #666666">{</span>
            <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000; font-weight: bold">null</span><span style="color: #666666">;</span>
        <span style="color: #666666">}</span>
        setComponentSize<span style="color: #666666">(</span>columnIndex<span style="color: #666666">);</span>
        <span style="color: #008000; font-weight: bold">switch</span> <span style="color: #666666">(</span>columnIndex<span style="color: #666666">)</span> <span style="color: #666666">{</span>
            <span style="color: #008000; font-weight: bold">case</span> COLUMN_RAW_VALUE<span style="color: #666666">:</span>
                editComponent<span style="color: #666666">.</span><span style="color: #7D9029">setText</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;&quot;</span><span style="color: #666666">);</span>
                <span style="color: #008000; font-weight: bold">break</span><span style="color: #666666">;</span>
            <span style="color: #008000; font-weight: bold">case</span> COLUMN_HEX_VALUE<span style="color: #666666">:</span>
                editComponent<span style="color: #666666">.</span><span style="color: #7D9029">setText</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;0x&quot;</span><span style="color: #666666">+</span> String<span style="color: #666666">.</span><span style="color: #7D9029">valueOf</span><span style="color: #666666">(</span>value<span style="color: #666666">));</span>
                <span style="color: #008000; font-weight: bold">break</span><span style="color: #666666">;</span>
            <span style="color: #008000; font-weight: bold">default</span><span style="color: #666666">:</span>
                editComponent<span style="color: #666666">.</span><span style="color: #7D9029">setText</span><span style="color: #666666">(</span>String<span style="color: #666666">.</span><span style="color: #7D9029">valueOf</span><span style="color: #666666">(</span>value<span style="color: #666666">));</span>
                <span style="color: #008000; font-weight: bold">break</span><span style="color: #666666">;</span>
        <span style="color: #666666">}</span>
        <span style="color: #008000; font-weight: bold">return</span> editComponent<span style="color: #666666">;</span>
    <span style="color: #666666">}</span>

    <span style="color: #AA22FF">@Override</span>
    <span style="color: #008000; font-weight: bold">public</span> Object <span style="color: #0000FF">getCellEditorValue</span><span style="color: #666666">()</span> <span style="color: #666666">{</span>
        <span style="color: #008000; font-weight: bold">return</span> editComponent<span style="color: #666666">.</span><span style="color: #7D9029">getText</span><span style="color: #666666">();</span>
    <span style="color: #666666">}</span>

<span style="color: #666666">}</span></code></pre></div> </div> </div> </div> <div class="sect2"> <h3 id="wrapping-it-up"> <a href="#wrapping-it-up" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Wrapping it up </h3> <div class="paragraph"> <p>The final step is to finish the class <code>MemoryImpl</code>. We need to enable the use our GUI in emuStudio. The <code>emulib.plugins.Memory</code> interface has a method named <code>showSettings</code> which is called when user clicks on the memory icon in the debug tool bar in emuStudio emulation panel. This method is responsible for showing the GUI of memory, and will be called repeatedly, always when a user clicks on the mentioned icon.</p> </div> <div class="listingblock"> <div class="title"><code>src/main/java/net/sf/emustudio/ssem/memory/MemoryImpl.java</code></div> <div class="content"><pre class="pygments highlight"><code data-lang="java"><span style="color: #666666">...</span>

<span style="color: #008000; font-weight: bold">public</span> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">MemoryImpl</span> <span style="color: #008000; font-weight: bold">extends</span> AbstractMemory <span style="color: #666666">{</span>
    <span style="color: #008000; font-weight: bold">private</span> <span style="color: #008000; font-weight: bold">final</span> <span style="color: #008000; font-weight: bold">static</span> Logger LOGGER <span style="color: #666666">=</span> LoggerFactory<span style="color: #666666">.</span><span style="color: #7D9029">getLogger</span><span style="color: #666666">(</span>MemoryImpl<span style="color: #666666">.</span><span style="color: #7D9029">class</span><span style="color: #666666">);</span>

    <span style="color: #008000; font-weight: bold">private</span> <span style="color: #008000; font-weight: bold">final</span> MemoryContextImpl memContext <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> MemoryContextImpl<span style="color: #666666">();</span>
    <span style="color: #008000; font-weight: bold">private</span> MemoryGUI memoryGUI<span style="color: #666666">;</span>

    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #0000FF">MemoryImpl</span><span style="color: #666666">(</span>Long pluginID<span style="color: #666666">,</span> ContextPool contextPoolImpl<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        <span style="color: #008000; font-weight: bold">super</span><span style="color: #666666">(</span>pluginID<span style="color: #666666">);</span>
        <span style="color: #008000; font-weight: bold">try</span> <span style="color: #666666">{</span>
            contextPoolImpl<span style="color: #666666">.</span><span style="color: #7D9029">register</span><span style="color: #666666">(</span>pluginID<span style="color: #666666">,</span> memContext<span style="color: #666666">,</span> MemoryContext<span style="color: #666666">.</span><span style="color: #7D9029">class</span><span style="color: #666666">);</span>
        <span style="color: #666666">}</span> <span style="color: #008000; font-weight: bold">catch</span> <span style="color: #666666">(</span>AlreadyRegisteredException <span style="color: #666666">|</span> InvalidContextException e<span style="color: #666666">)</span> <span style="color: #666666">{</span>
            StaticDialogs<span style="color: #666666">.</span><span style="color: #7D9029">showErrorMessage</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;Could not register SSEM memory&quot;</span><span style="color: #666666">,</span> getTitle<span style="color: #666666">());</span>
        <span style="color: #666666">}</span>
    <span style="color: #666666">}</span>

    <span style="color: #AA22FF">@Override</span>
    <span style="color: #008000; font-weight: bold">public</span> String <span style="color: #0000FF">getVersion</span><span style="color: #666666">()</span> <span style="color: #666666">{</span>
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #BA2121">&quot;1.0.0&quot;</span><span style="color: #666666">;</span>
    <span style="color: #666666">}</span>

    <span style="color: #AA22FF">@Override</span>
    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">initialize</span><span style="color: #666666">(</span>SettingsManager settings<span style="color: #666666">)</span> <span style="color: #008000; font-weight: bold">throws</span> PluginInitializationException <span style="color: #666666">{</span>
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">(!</span>Boolean<span style="color: #666666">.</span><span style="color: #7D9029">parseBoolean</span><span style="color: #666666">(</span>settings<span style="color: #666666">.</span><span style="color: #7D9029">readSetting</span><span style="color: #666666">(</span>pluginID<span style="color: #666666">,</span> SettingsManager<span style="color: #666666">.</span><span style="color: #7D9029">NO_GUI</span><span style="color: #666666">)))</span> <span style="color: #666666">{</span>
            memoryGUI <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> MemoryGUI<span style="color: #666666">(</span>memContext<span style="color: #666666">);</span>
        <span style="color: #666666">}</span>
    <span style="color: #666666">}</span>

    <span style="color: #AA22FF">@Override</span>
    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">destroy</span><span style="color: #666666">()</span> <span style="color: #666666">{</span>
    <span style="color: #666666">}</span>

    <span style="color: #AA22FF">@Override</span>
    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">int</span> <span style="color: #0000FF">getSize</span><span style="color: #666666">()</span> <span style="color: #666666">{</span>
        <span style="color: #008000; font-weight: bold">return</span> MemoryContextImpl<span style="color: #666666">.</span><span style="color: #7D9029">NUMBER_OF_CELLS</span><span style="color: #666666">;</span>
    <span style="color: #666666">}</span>

    <span style="color: #AA22FF">@Override</span>
    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">boolean</span> <span style="color: #0000FF">isShowSettingsSupported</span><span style="color: #666666">()</span> <span style="color: #666666">{</span>
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000; font-weight: bold">true</span><span style="color: #666666">;</span>
    <span style="color: #666666">}</span>

    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">showSettings</span><span style="color: #666666">()</span> <span style="color: #666666">{</span>
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">(</span>memoryGUI <span style="color: #666666">!=</span> <span style="color: #008000; font-weight: bold">null</span><span style="color: #666666">)</span> <span style="color: #666666">{</span>
            memoryGUI<span style="color: #666666">.</span><span style="color: #7D9029">setVisible</span><span style="color: #666666">(</span><span style="color: #008000; font-weight: bold">true</span><span style="color: #666666">);</span>
        <span style="color: #666666">}</span>
    <span style="color: #666666">}</span>
<span style="color: #666666">}</span></code></pre></div> </div> <div class="paragraph"> <p>As you can see from the code, there are several things to notice:</p> </div> <div class="ulist"> <ul> <li> <p>In constructor, we will register new instance of our memory context. Since we do not have custom context, the interface, passed as the second argument to call <code>contextPoolImpl.register()</code> will be plain <code>MemoryContext.class</code>. If we had custom context, it would require to be defined in separate interface which will extend the standard <code>MemoryContext</code>, and annotated with <code>@emulib.annotations.ContextType</code> annotation.</p> </li> <li> <p>In the <code>initialize()</code> method, we determine if we run in a "non-GUI" mode. We use a <code>SettingsManager</code> object for this purpose, which is an API for reading/writing plugin settings - key/value pairs from the computer configuration file. The "non-GUI", also called "headless" mode, means that the user who run emuStudio did not want GUI to be available. This is often useful when performing automatic emulation. See the user manual for more details. For us, developers, it means that we need to <strong>ignore</strong> all requests for showing GUI. Therefore, we create the GUI only if we are NOT in the "non-GUI" mode.</p> </li> </ul> </div> </div> <div class="sect2"> <h3 id="testing"> <a href="#testing" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Testing </h3> <div class="paragraph"> <p>It is not only a good practice, but often a safety net to perform automatic tests. They can save a lot of debugging time when something just does not work. Usually, tests should test the most important things - we usually don&#8217;t test setters or getters. In case of GUI, it also does not matter much for our case.</p> </div> <div class="paragraph"> <p>What should be tested is the context itself - since it&#8217;s the core part of the memory, and also some interaction with the main plugin class. For example, the automated unit test of the memory context can look as follows:</p> </div> <div class="listingblock"> <div class="title"><code>src/test/java/net/sf/emustudio/ssem/memory/impl/MemoryContextImplTest.java</code></div> <div class="content"><pre class="pygments highlight"><code data-lang="java"><span style="color: #008000; font-weight: bold">package</span> <span style="color: #0000FF; font-weight: bold">net.sf.emustudio.ssem.memory.impl</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">emulib.plugins.memory.Memory</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">org.junit.Test</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">import static</span> <span style="color: #0000FF; font-weight: bold">org.easymock.EasyMock.createMock</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import static</span> <span style="color: #0000FF; font-weight: bold">org.easymock.EasyMock.eq</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import static</span> <span style="color: #0000FF; font-weight: bold">org.easymock.EasyMock.expectLastCall</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import static</span> <span style="color: #0000FF; font-weight: bold">org.easymock.EasyMock.replay</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import static</span> <span style="color: #0000FF; font-weight: bold">org.easymock.EasyMock.verify</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import static</span> <span style="color: #0000FF; font-weight: bold">org.junit.Assert.assertArrayEquals</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import static</span> <span style="color: #0000FF; font-weight: bold">org.junit.Assert.assertEquals</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">public</span> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">MemoryContextImplTest</span> <span style="color: #666666">{</span>

    <span style="color: #AA22FF">@Test</span>
    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">testAfterClearObserversAreNotified</span><span style="color: #666666">()</span> <span style="color: #008000; font-weight: bold">throws</span> Exception <span style="color: #666666">{</span>
        MemoryContextImpl context <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> MemoryContextImpl<span style="color: #666666">();</span>

        Memory<span style="color: #666666">.</span><span style="color: #7D9029">MemoryListener</span> listener <span style="color: #666666">=</span> createMock<span style="color: #666666">(</span>Memory<span style="color: #666666">.</span><span style="color: #7D9029">MemoryListener</span><span style="color: #666666">.</span><span style="color: #7D9029">class</span><span style="color: #666666">);</span>
        listener<span style="color: #666666">.</span><span style="color: #7D9029">memoryChanged</span><span style="color: #666666">(</span>eq<span style="color: #666666">(-1));</span>
        expectLastCall<span style="color: #666666">().</span><span style="color: #7D9029">once</span><span style="color: #666666">();</span>
        replay<span style="color: #666666">(</span>listener<span style="color: #666666">);</span>

        context<span style="color: #666666">.</span><span style="color: #7D9029">addMemoryListener</span><span style="color: #666666">(</span>listener<span style="color: #666666">);</span>
        context<span style="color: #666666">.</span><span style="color: #7D9029">clear</span><span style="color: #666666">();</span>

        verify<span style="color: #666666">(</span>listener<span style="color: #666666">);</span>
    <span style="color: #666666">}</span>

    <span style="color: #AA22FF">@Test</span>
    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">testReadWithoutWritReturnsZero</span><span style="color: #666666">()</span> <span style="color: #008000; font-weight: bold">throws</span> Exception <span style="color: #666666">{</span>
        MemoryContextImpl context <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> MemoryContextImpl<span style="color: #666666">();</span>

        assertEquals<span style="color: #666666">(0</span>L<span style="color: #666666">,</span> <span style="color: #666666">(</span><span style="color: #B00040">long</span><span style="color: #666666">)</span>context<span style="color: #666666">.</span><span style="color: #7D9029">read</span><span style="color: #666666">(10));</span>
    <span style="color: #666666">}</span>

    <span style="color: #AA22FF">@Test</span><span style="color: #666666">(</span>expected <span style="color: #666666">=</span> IndexOutOfBoundsException<span style="color: #666666">.</span><span style="color: #7D9029">class</span><span style="color: #666666">)</span>
    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">testReadAtInvalidLocationThrows</span><span style="color: #666666">()</span> <span style="color: #008000; font-weight: bold">throws</span> Exception <span style="color: #666666">{</span>
        MemoryContextImpl context <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> MemoryContextImpl<span style="color: #666666">();</span>

        context<span style="color: #666666">.</span><span style="color: #7D9029">read</span><span style="color: #666666">(-1);</span>
    <span style="color: #666666">}</span>

    <span style="color: #AA22FF">@Test</span>
    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">testAfterReadNoObserversAreNotified</span><span style="color: #666666">()</span> <span style="color: #008000; font-weight: bold">throws</span> Exception <span style="color: #666666">{</span>
        MemoryContextImpl context <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> MemoryContextImpl<span style="color: #666666">();</span>

        Memory<span style="color: #666666">.</span><span style="color: #7D9029">MemoryListener</span> listener <span style="color: #666666">=</span> createMock<span style="color: #666666">(</span>Memory<span style="color: #666666">.</span><span style="color: #7D9029">MemoryListener</span><span style="color: #666666">.</span><span style="color: #7D9029">class</span><span style="color: #666666">);</span>
        replay<span style="color: #666666">(</span>listener<span style="color: #666666">);</span>

        context<span style="color: #666666">.</span><span style="color: #7D9029">addMemoryListener</span><span style="color: #666666">(</span>listener<span style="color: #666666">);</span>
        context<span style="color: #666666">.</span><span style="color: #7D9029">read</span><span style="color: #666666">(10);</span>

        verify<span style="color: #666666">(</span>listener<span style="color: #666666">);</span>
    <span style="color: #666666">}</span>

    <span style="color: #AA22FF">@Test</span>
    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">testAfterWriteObserversAreNotified</span><span style="color: #666666">()</span> <span style="color: #008000; font-weight: bold">throws</span> Exception <span style="color: #666666">{</span>
        MemoryContextImpl context <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> MemoryContextImpl<span style="color: #666666">();</span>

        Memory<span style="color: #666666">.</span><span style="color: #7D9029">MemoryListener</span> listener <span style="color: #666666">=</span> createMock<span style="color: #666666">(</span>Memory<span style="color: #666666">.</span><span style="color: #7D9029">MemoryListener</span><span style="color: #666666">.</span><span style="color: #7D9029">class</span><span style="color: #666666">);</span>
        listener<span style="color: #666666">.</span><span style="color: #7D9029">memoryChanged</span><span style="color: #666666">(</span>eq<span style="color: #666666">(10));</span>
        expectLastCall<span style="color: #666666">().</span><span style="color: #7D9029">once</span><span style="color: #666666">();</span>
        replay<span style="color: #666666">(</span>listener<span style="color: #666666">);</span>

        context<span style="color: #666666">.</span><span style="color: #7D9029">addMemoryListener</span><span style="color: #666666">(</span>listener<span style="color: #666666">);</span>
        context<span style="color: #666666">.</span><span style="color: #7D9029">write</span><span style="color: #666666">(10,</span> <span style="color: #666666">(</span><span style="color: #B00040">byte</span><span style="color: #666666">)134);</span>

        verify<span style="color: #666666">(</span>listener<span style="color: #666666">);</span>
    <span style="color: #666666">}</span>

    <span style="color: #AA22FF">@Test</span>
    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">testWriteReallyWritesCorrectValueAtCorrectLocation</span><span style="color: #666666">()</span> <span style="color: #008000; font-weight: bold">throws</span> Exception <span style="color: #666666">{</span>
        MemoryContextImpl context <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> MemoryContextImpl<span style="color: #666666">();</span>

        context<span style="color: #666666">.</span><span style="color: #7D9029">write</span><span style="color: #666666">(10,</span> <span style="color: #666666">(</span><span style="color: #B00040">byte</span><span style="color: #666666">)134);</span>
        assertEquals<span style="color: #666666">((</span><span style="color: #B00040">byte</span><span style="color: #666666">)134,</span> <span style="color: #666666">(</span><span style="color: #B00040">byte</span><span style="color: #666666">)</span>context<span style="color: #666666">.</span><span style="color: #7D9029">read</span><span style="color: #666666">(10));</span>
    <span style="color: #666666">}</span>

    <span style="color: #AA22FF">@Test</span><span style="color: #666666">(</span>expected <span style="color: #666666">=</span> IndexOutOfBoundsException<span style="color: #666666">.</span><span style="color: #7D9029">class</span><span style="color: #666666">)</span>
    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">testWriteAtInvalidLocationThrows</span><span style="color: #666666">()</span> <span style="color: #008000; font-weight: bold">throws</span> Exception <span style="color: #666666">{</span>
        MemoryContextImpl context <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> MemoryContextImpl<span style="color: #666666">();</span>

        context<span style="color: #666666">.</span><span style="color: #7D9029">write</span><span style="color: #666666">(-1,</span> <span style="color: #666666">(</span><span style="color: #B00040">byte</span><span style="color: #666666">)134);</span>
    <span style="color: #666666">}</span>

    <span style="color: #AA22FF">@Test</span>
    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">testGetSizeReturnsNumberOfCells</span><span style="color: #666666">()</span> <span style="color: #008000; font-weight: bold">throws</span> Exception <span style="color: #666666">{</span>
        MemoryContextImpl context <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> MemoryContextImpl<span style="color: #666666">();</span>

        assertEquals<span style="color: #666666">(</span>MemoryContextImpl<span style="color: #666666">.</span><span style="color: #7D9029">NUMBER_OF_CELLS</span><span style="color: #666666">,</span> context<span style="color: #666666">.</span><span style="color: #7D9029">getSize</span><span style="color: #666666">());</span>
    <span style="color: #666666">}</span>

    <span style="color: #AA22FF">@Test</span>
    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">testClassTypeIsByte</span><span style="color: #666666">()</span> <span style="color: #008000; font-weight: bold">throws</span> Exception <span style="color: #666666">{</span>
        assertEquals<span style="color: #666666">(</span>Byte<span style="color: #666666">.</span><span style="color: #7D9029">class</span><span style="color: #666666">,</span> <span style="color: #008000; font-weight: bold">new</span> MemoryContextImpl<span style="color: #666666">().</span><span style="color: #7D9029">getDataType</span><span style="color: #666666">());</span>
    <span style="color: #666666">}</span>

    <span style="color: #AA22FF">@Test</span>
    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">testReadWordIsSupported</span><span style="color: #666666">()</span> <span style="color: #008000; font-weight: bold">throws</span> Exception <span style="color: #666666">{</span>
        assertArrayEquals<span style="color: #666666">(</span><span style="color: #008000; font-weight: bold">new</span> Byte<span style="color: #666666">[]</span> <span style="color: #666666">{0,0,0,0},</span> <span style="color: #008000; font-weight: bold">new</span> MemoryContextImpl<span style="color: #666666">().</span><span style="color: #7D9029">readWord</span><span style="color: #666666">(0));</span>
    <span style="color: #666666">}</span>

    <span style="color: #AA22FF">@Test</span>
    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">testWriteWordIsSupported</span><span style="color: #666666">()</span> <span style="color: #008000; font-weight: bold">throws</span> Exception <span style="color: #666666">{</span>
        MemoryContextImpl mem <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> MemoryContextImpl<span style="color: #666666">();</span>

        Byte<span style="color: #666666">[]</span> row <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> Byte<span style="color: #666666">[]</span> <span style="color: #666666">{1,2,3,4};</span>
        mem<span style="color: #666666">.</span><span style="color: #7D9029">writeWord</span><span style="color: #666666">(0,</span> row<span style="color: #666666">);</span>

        assertArrayEquals<span style="color: #666666">(</span>row<span style="color: #666666">,</span> mem<span style="color: #666666">.</span><span style="color: #7D9029">readWord</span><span style="color: #666666">(0));</span>
    <span style="color: #666666">}</span>
<span style="color: #666666">}</span></code></pre></div> </div> </div> </div> </div> <div id="footnotes"> <hr> <div class="footnote" id="_footnote_1"> <a href="#_footnoteref_1">1</a>. See <a href="https://en.wikipedia.org/wiki/Manchester_Small-Scale_Experimental_Machine#Williams-Kilburn_tube" class="bare">https://en.wikipedia.org/wiki/Manchester_Small-Scale_Experimental_Machine#Williams-Kilburn_tube</a> </div> <div class="footnote" id="_footnote_2"> <a href="#_footnoteref_2">2</a>. The code might seem generally complicated and bloated with a boiler-plate. I personally blame Java Swing or Java itself for it, since it is a "corporate" language, usually used for different purposes than writing an emulator :) </div> <div class="footnote" id="_footnote_3"> <a href="#_footnoteref_3">3</a>. See <a href="#CPU_HOWTO">[CPU_HOWTO]</a> tutorial for more information about Edigen </div> </div> </div> </div> </div> </div> </body> </html>
